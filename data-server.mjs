/* Build at: 1. 4. 2025 14:18:06; Version: 0.1.1 */
import{createRequire as pR}from"node:module";var hR=Object.create;var{getPrototypeOf:mR,defineProperty:KU,getOwnPropertyNames:dR}=Object;var cR=Object.prototype.hasOwnProperty;var m1=(X,J,Y)=>{Y=X!=null?hR(mR(X)):{};let G=J||!X||!X.__esModule?KU(Y,"default",{value:X,enumerable:!0}):Y;for(let Z of dR(X))if(!cR.call(G,Z))KU(G,Z,{get:()=>X[Z],enumerable:!0});return G};var H6=(X,J)=>()=>(J||X((J={exports:{}}).exports,J),J.exports);var e0=pR(import.meta.url);var EM=H6((Yv0,TM)=>{var{Duplex:Uc}=e0("stream");function RM(X){X.emit("close")}function Dc(){if(!this.destroyed&&this._writableState.finished)this.destroy()}function CM(X){if(this.removeListener("error",CM),this.destroy(),this.listenerCount("error")===0)this.emit("error",X)}function zc(X,J){let Y=!0,G=new Uc({...J,autoDestroy:!1,emitClose:!1,objectMode:!1,writableObjectMode:!1});return X.on("message",function Z($,Q){let K=!Q&&G._readableState.objectMode?$.toString():$;if(!G.push(K))X.pause()}),X.once("error",function Z($){if(G.destroyed)return;Y=!1,G.destroy($)}),X.once("close",function Z(){if(G.destroyed)return;G.push(null)}),G._destroy=function(Z,$){if(X.readyState===X.CLOSED){$(Z),process.nextTick(RM,G);return}let Q=!1;if(X.once("error",function K(H){Q=!0,$(H)}),X.once("close",function K(){if(!Q)$(Z);process.nextTick(RM,G)}),Y)X.terminate()},G._final=function(Z){if(X.readyState===X.CONNECTING){X.once("open",function $(){G._final(Z)});return}if(X._socket===null)return;if(X._socket._writableState.finished){if(Z(),G._readableState.endEmitted)G.destroy()}else X._socket.once("finish",function $(){Z()}),X.close()},G._read=function(){if(X.isPaused)X.resume()},G._write=function(Z,$,Q){if(X.readyState===X.CONNECTING){X.once("open",function K(){G._write(Z,$,Q)});return}X.send(Z,Q)},G.on("end",Dc),G.on("error",CM),G}TM.exports=zc});var a9=H6((Gv0,SM)=>{var IM=["nodebuffer","arraybuffer","fragments"],jM=typeof Blob!=="undefined";if(jM)IM.push("blob");SM.exports={BINARY_TYPES:IM,EMPTY_BUFFER:Buffer.alloc(0),GUID:"258EAFA5-E914-47DA-95CA-C5AB0DC85B11",hasBlob:jM,kForOnEventAttribute:Symbol("kIsForOnEventAttribute"),kListener:Symbol("kListener"),kStatusCode:Symbol("status-code"),kWebSocket:Symbol("websocket"),NOOP:()=>{}}});var JG=H6((Zv0,V2)=>{var{EMPTY_BUFFER:Ac}=a9(),mW=Buffer[Symbol.species];function Oc(X,J){if(X.length===0)return Ac;if(X.length===1)return X[0];let Y=Buffer.allocUnsafe(J),G=0;for(let Z=0;Z<X.length;Z++){let $=X[Z];Y.set($,G),G+=$.length}if(G<J)return new mW(Y.buffer,Y.byteOffset,G);return Y}function vM(X,J,Y,G,Z){for(let $=0;$<Z;$++)Y[G+$]=X[$]^J[$&3]}function xM(X,J){for(let Y=0;Y<X.length;Y++)X[Y]^=J[Y&3]}function qc(X){if(X.length===X.buffer.byteLength)return X.buffer;return X.buffer.slice(X.byteOffset,X.byteOffset+X.length)}function dW(X){if(dW.readOnly=!0,Buffer.isBuffer(X))return X;let J;if(X instanceof ArrayBuffer)J=new mW(X);else if(ArrayBuffer.isView(X))J=new mW(X.buffer,X.byteOffset,X.byteLength);else J=Buffer.from(X),dW.readOnly=!1;return J}V2.exports={concat:Oc,mask:vM,toArrayBuffer:qc,toBuffer:dW,unmask:xM};if(!process.env.WS_NO_BUFFER_UTIL)try{let X=(()=>{throw new Error("Cannot require module "+"bufferutil");})();V2.exports.mask=function(J,Y,G,Z,$){if($<48)vM(J,Y,G,Z,$);else X.mask(J,Y,G,Z,$)},V2.exports.unmask=function(J,Y){if(J.length<32)xM(J,Y);else X.unmask(J,Y)}}catch(X){}});var bM=H6(($v0,gM)=>{var kM=Symbol("kDone"),cW=Symbol("kRun");class yM{constructor(X){this[kM]=()=>{this.pending--,this[cW]()},this.concurrency=X||1/0,this.jobs=[],this.pending=0}add(X){this.jobs.push(X),this[cW]()}[cW](){if(this.pending===this.concurrency)return;if(this.jobs.length){let X=this.jobs.shift();this.pending++,X(this[kM])}}}gM.exports=yM});var ZG=H6((Qv0,pM)=>{var YG=e0("zlib"),hM=JG(),Lc=bM(),{kStatusCode:mM}=a9(),wc=Buffer[Symbol.species],Fc=Buffer.from([0,0,255,255]),U2=Symbol("permessage-deflate"),s9=Symbol("total-length"),GG=Symbol("callback"),m4=Symbol("buffers"),W2=Symbol("error"),N2;class dM{constructor(X,J,Y){if(this._maxPayload=Y|0,this._options=X||{},this._threshold=this._options.threshold!==void 0?this._options.threshold:1024,this._isServer=!!J,this._deflate=null,this._inflate=null,this.params=null,!N2){let G=this._options.concurrencyLimit!==void 0?this._options.concurrencyLimit:10;N2=new Lc(G)}}static get extensionName(){return"permessage-deflate"}offer(){let X={};if(this._options.serverNoContextTakeover)X.server_no_context_takeover=!0;if(this._options.clientNoContextTakeover)X.client_no_context_takeover=!0;if(this._options.serverMaxWindowBits)X.server_max_window_bits=this._options.serverMaxWindowBits;if(this._options.clientMaxWindowBits)X.client_max_window_bits=this._options.clientMaxWindowBits;else if(this._options.clientMaxWindowBits==null)X.client_max_window_bits=!0;return X}accept(X){return X=this.normalizeParams(X),this.params=this._isServer?this.acceptAsServer(X):this.acceptAsClient(X),this.params}cleanup(){if(this._inflate)this._inflate.close(),this._inflate=null;if(this._deflate){let X=this._deflate[GG];if(this._deflate.close(),this._deflate=null,X)X(new Error("The deflate stream was closed while data was being processed"))}}acceptAsServer(X){let J=this._options,Y=X.find((G)=>{if(J.serverNoContextTakeover===!1&&G.server_no_context_takeover||G.server_max_window_bits&&(J.serverMaxWindowBits===!1||typeof J.serverMaxWindowBits==="number"&&J.serverMaxWindowBits>G.server_max_window_bits)||typeof J.clientMaxWindowBits==="number"&&!G.client_max_window_bits)return!1;return!0});if(!Y)throw new Error("None of the extension offers can be accepted");if(J.serverNoContextTakeover)Y.server_no_context_takeover=!0;if(J.clientNoContextTakeover)Y.client_no_context_takeover=!0;if(typeof J.serverMaxWindowBits==="number")Y.server_max_window_bits=J.serverMaxWindowBits;if(typeof J.clientMaxWindowBits==="number")Y.client_max_window_bits=J.clientMaxWindowBits;else if(Y.client_max_window_bits===!0||J.clientMaxWindowBits===!1)delete Y.client_max_window_bits;return Y}acceptAsClient(X){let J=X[0];if(this._options.clientNoContextTakeover===!1&&J.client_no_context_takeover)throw new Error('Unexpected parameter "client_no_context_takeover"');if(!J.client_max_window_bits){if(typeof this._options.clientMaxWindowBits==="number")J.client_max_window_bits=this._options.clientMaxWindowBits}else if(this._options.clientMaxWindowBits===!1||typeof this._options.clientMaxWindowBits==="number"&&J.client_max_window_bits>this._options.clientMaxWindowBits)throw new Error('Unexpected or invalid parameter "client_max_window_bits"');return J}normalizeParams(X){return X.forEach((J)=>{Object.keys(J).forEach((Y)=>{let G=J[Y];if(G.length>1)throw new Error(`Parameter "${Y}" must have only a single value`);if(G=G[0],Y==="client_max_window_bits"){if(G!==!0){let Z=+G;if(!Number.isInteger(Z)||Z<8||Z>15)throw new TypeError(`Invalid value for parameter "${Y}": ${G}`);G=Z}else if(!this._isServer)throw new TypeError(`Invalid value for parameter "${Y}": ${G}`)}else if(Y==="server_max_window_bits"){let Z=+G;if(!Number.isInteger(Z)||Z<8||Z>15)throw new TypeError(`Invalid value for parameter "${Y}": ${G}`);G=Z}else if(Y==="client_no_context_takeover"||Y==="server_no_context_takeover"){if(G!==!0)throw new TypeError(`Invalid value for parameter "${Y}": ${G}`)}else throw new Error(`Unknown parameter "${Y}"`);J[Y]=G})}),X}decompress(X,J,Y){N2.add((G)=>{this._decompress(X,J,(Z,$)=>{G(),Y(Z,$)})})}compress(X,J,Y){N2.add((G)=>{this._compress(X,J,(Z,$)=>{G(),Y(Z,$)})})}_decompress(X,J,Y){let G=this._isServer?"client":"server";if(!this._inflate){let Z=`${G}_max_window_bits`,$=typeof this.params[Z]!=="number"?YG.Z_DEFAULT_WINDOWBITS:this.params[Z];this._inflate=YG.createInflateRaw({...this._options.zlibInflateOptions,windowBits:$}),this._inflate[U2]=this,this._inflate[s9]=0,this._inflate[m4]=[],this._inflate.on("error",Pc),this._inflate.on("data",cM)}if(this._inflate[GG]=Y,this._inflate.write(X),J)this._inflate.write(Fc);this._inflate.flush(()=>{let Z=this._inflate[W2];if(Z){this._inflate.close(),this._inflate=null,Y(Z);return}let $=hM.concat(this._inflate[m4],this._inflate[s9]);if(this._inflate._readableState.endEmitted)this._inflate.close(),this._inflate=null;else if(this._inflate[s9]=0,this._inflate[m4]=[],J&&this.params[`${G}_no_context_takeover`])this._inflate.reset();Y(null,$)})}_compress(X,J,Y){let G=this._isServer?"server":"client";if(!this._deflate){let Z=`${G}_max_window_bits`,$=typeof this.params[Z]!=="number"?YG.Z_DEFAULT_WINDOWBITS:this.params[Z];this._deflate=YG.createDeflateRaw({...this._options.zlibDeflateOptions,windowBits:$}),this._deflate[s9]=0,this._deflate[m4]=[],this._deflate.on("data",_c)}this._deflate[GG]=Y,this._deflate.write(X),this._deflate.flush(YG.Z_SYNC_FLUSH,()=>{if(!this._deflate)return;let Z=hM.concat(this._deflate[m4],this._deflate[s9]);if(J)Z=new wc(Z.buffer,Z.byteOffset,Z.length-4);if(this._deflate[GG]=null,this._deflate[s9]=0,this._deflate[m4]=[],J&&this.params[`${G}_no_context_takeover`])this._deflate.reset();Y(null,Z)})}}pM.exports=dM;function _c(X){this[m4].push(X),this[s9]+=X.length}function cM(X){if(this[s9]+=X.length,this[U2]._maxPayload<1||this[s9]<=this[U2]._maxPayload){this[m4].push(X);return}this[W2]=new RangeError("Max payload size exceeded"),this[W2].code="WS_ERR_UNSUPPORTED_MESSAGE_LENGTH",this[W2][mM]=1009,this.removeListener("data",cM),this.reset()}function Pc(X){this[U2]._inflate=null,X[mM]=1007,this[GG](X)}});var k1=H6((Hv0,D2)=>{var{isUtf8:fM}=e0("buffer"),{hasBlob:Mc}=a9(),Rc=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,1,1,1,0,0,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1,0];function Cc(X){return X>=1000&&X<=1014&&X!==1004&&X!==1005&&X!==1006||X>=3000&&X<=4999}function pW(X){let J=X.length,Y=0;while(Y<J)if((X[Y]&128)===0)Y++;else if((X[Y]&224)===192){if(Y+1===J||(X[Y+1]&192)!==128||(X[Y]&254)===192)return!1;Y+=2}else if((X[Y]&240)===224){if(Y+2>=J||(X[Y+1]&192)!==128||(X[Y+2]&192)!==128||X[Y]===224&&(X[Y+1]&224)===128||X[Y]===237&&(X[Y+1]&224)===160)return!1;Y+=3}else if((X[Y]&248)===240){if(Y+3>=J||(X[Y+1]&192)!==128||(X[Y+2]&192)!==128||(X[Y+3]&192)!==128||X[Y]===240&&(X[Y+1]&240)===128||X[Y]===244&&X[Y+1]>143||X[Y]>244)return!1;Y+=4}else return!1;return!0}function Tc(X){return Mc&&typeof X==="object"&&typeof X.arrayBuffer==="function"&&typeof X.type==="string"&&typeof X.stream==="function"&&(X[Symbol.toStringTag]==="Blob"||X[Symbol.toStringTag]==="File")}D2.exports={isBlob:Tc,isValidStatusCode:Cc,isValidUTF8:pW,tokenChars:Rc};if(fM)D2.exports.isValidUTF8=function(X){return X.length<24?pW(X):fM(X)};else if(!process.env.WS_NO_UTF_8_VALIDATE)try{let X=(()=>{throw new Error("Cannot require module "+"utf-8-validate");})();D2.exports.isValidUTF8=function(J){return J.length<32?pW(J):X(J)}}catch(X){}});var uW=H6((Kv0,rM)=>{var{Writable:Ec}=e0("stream"),uM=ZG(),{BINARY_TYPES:Ic,EMPTY_BUFFER:oM,kStatusCode:jc,kWebSocket:Sc}=a9(),{concat:fW,toArrayBuffer:vc,unmask:xc}=JG(),{isValidStatusCode:kc,isValidUTF8:nM}=k1(),z2=Buffer[Symbol.species];class lM extends Ec{constructor(X={}){super();this._allowSynchronousEvents=X.allowSynchronousEvents!==void 0?X.allowSynchronousEvents:!0,this._binaryType=X.binaryType||Ic[0],this._extensions=X.extensions||{},this._isServer=!!X.isServer,this._maxPayload=X.maxPayload|0,this._skipUTF8Validation=!!X.skipUTF8Validation,this[Sc]=void 0,this._bufferedBytes=0,this._buffers=[],this._compressed=!1,this._payloadLength=0,this._mask=void 0,this._fragmented=0,this._masked=!1,this._fin=!1,this._opcode=0,this._totalPayloadLength=0,this._messageLength=0,this._fragments=[],this._errored=!1,this._loop=!1,this._state=0}_write(X,J,Y){if(this._opcode===8&&this._state==0)return Y();this._bufferedBytes+=X.length,this._buffers.push(X),this.startLoop(Y)}consume(X){if(this._bufferedBytes-=X,X===this._buffers[0].length)return this._buffers.shift();if(X<this._buffers[0].length){let Y=this._buffers[0];return this._buffers[0]=new z2(Y.buffer,Y.byteOffset+X,Y.length-X),new z2(Y.buffer,Y.byteOffset,X)}let J=Buffer.allocUnsafe(X);do{let Y=this._buffers[0],G=J.length-X;if(X>=Y.length)J.set(this._buffers.shift(),G);else J.set(new Uint8Array(Y.buffer,Y.byteOffset,X),G),this._buffers[0]=new z2(Y.buffer,Y.byteOffset+X,Y.length-X);X-=Y.length}while(X>0);return J}startLoop(X){this._loop=!0;do switch(this._state){case 0:this.getInfo(X);break;case 1:this.getPayloadLength16(X);break;case 2:this.getPayloadLength64(X);break;case 3:this.getMask();break;case 4:this.getData(X);break;case 5:case 6:this._loop=!1;return}while(this._loop);if(!this._errored)X()}getInfo(X){if(this._bufferedBytes<2){this._loop=!1;return}let J=this.consume(2);if((J[0]&48)!==0){let G=this.createError(RangeError,"RSV2 and RSV3 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_2_3");X(G);return}let Y=(J[0]&64)===64;if(Y&&!this._extensions[uM.extensionName]){let G=this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");X(G);return}if(this._fin=(J[0]&128)===128,this._opcode=J[0]&15,this._payloadLength=J[1]&127,this._opcode===0){if(Y){let G=this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");X(G);return}if(!this._fragmented){let G=this.createError(RangeError,"invalid opcode 0",!0,1002,"WS_ERR_INVALID_OPCODE");X(G);return}this._opcode=this._fragmented}else if(this._opcode===1||this._opcode===2){if(this._fragmented){let G=this.createError(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE");X(G);return}this._compressed=Y}else if(this._opcode>7&&this._opcode<11){if(!this._fin){let G=this.createError(RangeError,"FIN must be set",!0,1002,"WS_ERR_EXPECTED_FIN");X(G);return}if(Y){let G=this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");X(G);return}if(this._payloadLength>125||this._opcode===8&&this._payloadLength===1){let G=this.createError(RangeError,`invalid payload length ${this._payloadLength}`,!0,1002,"WS_ERR_INVALID_CONTROL_PAYLOAD_LENGTH");X(G);return}}else{let G=this.createError(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE");X(G);return}if(!this._fin&&!this._fragmented)this._fragmented=this._opcode;if(this._masked=(J[1]&128)===128,this._isServer){if(!this._masked){let G=this.createError(RangeError,"MASK must be set",!0,1002,"WS_ERR_EXPECTED_MASK");X(G);return}}else if(this._masked){let G=this.createError(RangeError,"MASK must be clear",!0,1002,"WS_ERR_UNEXPECTED_MASK");X(G);return}if(this._payloadLength===126)this._state=1;else if(this._payloadLength===127)this._state=2;else this.haveLength(X)}getPayloadLength16(X){if(this._bufferedBytes<2){this._loop=!1;return}this._payloadLength=this.consume(2).readUInt16BE(0),this.haveLength(X)}getPayloadLength64(X){if(this._bufferedBytes<8){this._loop=!1;return}let J=this.consume(8),Y=J.readUInt32BE(0);if(Y>Math.pow(2,21)-1){let G=this.createError(RangeError,"Unsupported WebSocket frame: payload length > 2^53 - 1",!1,1009,"WS_ERR_UNSUPPORTED_DATA_PAYLOAD_LENGTH");X(G);return}this._payloadLength=Y*Math.pow(2,32)+J.readUInt32BE(4),this.haveLength(X)}haveLength(X){if(this._payloadLength&&this._opcode<8){if(this._totalPayloadLength+=this._payloadLength,this._totalPayloadLength>this._maxPayload&&this._maxPayload>0){let J=this.createError(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH");X(J);return}}if(this._masked)this._state=3;else this._state=4}getMask(){if(this._bufferedBytes<4){this._loop=!1;return}this._mask=this.consume(4),this._state=4}getData(X){let J=oM;if(this._payloadLength){if(this._bufferedBytes<this._payloadLength){this._loop=!1;return}if(J=this.consume(this._payloadLength),this._masked&&(this._mask[0]|this._mask[1]|this._mask[2]|this._mask[3])!==0)xc(J,this._mask)}if(this._opcode>7){this.controlMessage(J,X);return}if(this._compressed){this._state=5,this.decompress(J,X);return}if(J.length)this._messageLength=this._totalPayloadLength,this._fragments.push(J);this.dataMessage(X)}decompress(X,J){this._extensions[uM.extensionName].decompress(X,this._fin,(G,Z)=>{if(G)return J(G);if(Z.length){if(this._messageLength+=Z.length,this._messageLength>this._maxPayload&&this._maxPayload>0){let $=this.createError(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH");J($);return}this._fragments.push(Z)}if(this.dataMessage(J),this._state===0)this.startLoop(J)})}dataMessage(X){if(!this._fin){this._state=0;return}let J=this._messageLength,Y=this._fragments;if(this._totalPayloadLength=0,this._messageLength=0,this._fragmented=0,this._fragments=[],this._opcode===2){let G;if(this._binaryType==="nodebuffer")G=fW(Y,J);else if(this._binaryType==="arraybuffer")G=vc(fW(Y,J));else if(this._binaryType==="blob")G=new Blob(Y);else G=Y;if(this._allowSynchronousEvents)this.emit("message",G,!0),this._state=0;else this._state=6,setImmediate(()=>{this.emit("message",G,!0),this._state=0,this.startLoop(X)})}else{let G=fW(Y,J);if(!this._skipUTF8Validation&&!nM(G)){let Z=this.createError(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8");X(Z);return}if(this._state===5||this._allowSynchronousEvents)this.emit("message",G,!1),this._state=0;else this._state=6,setImmediate(()=>{this.emit("message",G,!1),this._state=0,this.startLoop(X)})}}controlMessage(X,J){if(this._opcode===8){if(X.length===0)this._loop=!1,this.emit("conclude",1005,oM),this.end();else{let Y=X.readUInt16BE(0);if(!kc(Y)){let Z=this.createError(RangeError,`invalid status code ${Y}`,!0,1002,"WS_ERR_INVALID_CLOSE_CODE");J(Z);return}let G=new z2(X.buffer,X.byteOffset+2,X.length-2);if(!this._skipUTF8Validation&&!nM(G)){let Z=this.createError(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8");J(Z);return}this._loop=!1,this.emit("conclude",Y,G),this.end()}this._state=0;return}if(this._allowSynchronousEvents)this.emit(this._opcode===9?"ping":"pong",X),this._state=0;else this._state=6,setImmediate(()=>{this.emit(this._opcode===9?"ping":"pong",X),this._state=0,this.startLoop(J)})}createError(X,J,Y,G,Z){this._loop=!1,this._errored=!0;let $=new X(Y?`Invalid WebSocket frame: ${J}`:J);return Error.captureStackTrace($,this.createError),$.code=Z,$[jc]=G,$}}rM.exports=lM});var nW=H6((Vv0,sM)=>{var{Duplex:Bv0}=e0("stream"),{randomFillSync:yc}=e0("crypto"),iM=ZG(),{EMPTY_BUFFER:gc,kWebSocket:bc,NOOP:hc}=a9(),{isBlob:y1,isValidStatusCode:mc}=k1(),{mask:aM,toBuffer:e7}=JG(),f6=Symbol("kByteLength"),dc=Buffer.alloc(4),XX,g1=8192,P5=0,cc=1,pc=2;class d4{constructor(X,J,Y){if(this._extensions=J||{},Y)this._generateMask=Y,this._maskBuffer=Buffer.alloc(4);this._socket=X,this._firstFragment=!0,this._compress=!1,this._bufferedBytes=0,this._queue=[],this._state=P5,this.onerror=hc,this[bc]=void 0}static frame(X,J){let Y,G=!1,Z=2,$=!1;if(J.mask){if(Y=J.maskBuffer||dc,J.generateMask)J.generateMask(Y);else{if(g1===8192){if(XX===void 0)XX=Buffer.alloc(8192);yc(XX,0,8192),g1=0}Y[0]=XX[g1++],Y[1]=XX[g1++],Y[2]=XX[g1++],Y[3]=XX[g1++]}$=(Y[0]|Y[1]|Y[2]|Y[3])===0,Z=6}let Q;if(typeof X==="string")if((!J.mask||$)&&J[f6]!==void 0)Q=J[f6];else X=Buffer.from(X),Q=X.length;else Q=X.length,G=J.mask&&J.readOnly&&!$;let K=Q;if(Q>=65536)Z+=8,K=127;else if(Q>125)Z+=2,K=126;let H=Buffer.allocUnsafe(G?Q+Z:Z);if(H[0]=J.fin?J.opcode|128:J.opcode,J.rsv1)H[0]|=64;if(H[1]=K,K===126)H.writeUInt16BE(Q,2);else if(K===127)H[2]=H[3]=0,H.writeUIntBE(Q,4,6);if(!J.mask)return[H,X];if(H[1]|=128,H[Z-4]=Y[0],H[Z-3]=Y[1],H[Z-2]=Y[2],H[Z-1]=Y[3],$)return[H,X];if(G)return aM(X,Y,H,Z,Q),[H];return aM(X,Y,X,0,Q),[H,X]}close(X,J,Y,G){let Z;if(X===void 0)Z=gc;else if(typeof X!=="number"||!mc(X))throw new TypeError("First argument must be a valid error code number");else if(J===void 0||!J.length)Z=Buffer.allocUnsafe(2),Z.writeUInt16BE(X,0);else{let Q=Buffer.byteLength(J);if(Q>123)throw new RangeError("The message must not be greater than 123 bytes");if(Z=Buffer.allocUnsafe(2+Q),Z.writeUInt16BE(X,0),typeof J==="string")Z.write(J,2);else Z.set(J,2)}let $={[f6]:Z.length,fin:!0,generateMask:this._generateMask,mask:Y,maskBuffer:this._maskBuffer,opcode:8,readOnly:!1,rsv1:!1};if(this._state!==P5)this.enqueue([this.dispatch,Z,!1,$,G]);else this.sendFrame(d4.frame(Z,$),G)}ping(X,J,Y){let G,Z;if(typeof X==="string")G=Buffer.byteLength(X),Z=!1;else if(y1(X))G=X.size,Z=!1;else X=e7(X),G=X.length,Z=e7.readOnly;if(G>125)throw new RangeError("The data size must not be greater than 125 bytes");let $={[f6]:G,fin:!0,generateMask:this._generateMask,mask:J,maskBuffer:this._maskBuffer,opcode:9,readOnly:Z,rsv1:!1};if(y1(X))if(this._state!==P5)this.enqueue([this.getBlobData,X,!1,$,Y]);else this.getBlobData(X,!1,$,Y);else if(this._state!==P5)this.enqueue([this.dispatch,X,!1,$,Y]);else this.sendFrame(d4.frame(X,$),Y)}pong(X,J,Y){let G,Z;if(typeof X==="string")G=Buffer.byteLength(X),Z=!1;else if(y1(X))G=X.size,Z=!1;else X=e7(X),G=X.length,Z=e7.readOnly;if(G>125)throw new RangeError("The data size must not be greater than 125 bytes");let $={[f6]:G,fin:!0,generateMask:this._generateMask,mask:J,maskBuffer:this._maskBuffer,opcode:10,readOnly:Z,rsv1:!1};if(y1(X))if(this._state!==P5)this.enqueue([this.getBlobData,X,!1,$,Y]);else this.getBlobData(X,!1,$,Y);else if(this._state!==P5)this.enqueue([this.dispatch,X,!1,$,Y]);else this.sendFrame(d4.frame(X,$),Y)}send(X,J,Y){let G=this._extensions[iM.extensionName],Z=J.binary?2:1,$=J.compress,Q,K;if(typeof X==="string")Q=Buffer.byteLength(X),K=!1;else if(y1(X))Q=X.size,K=!1;else X=e7(X),Q=X.length,K=e7.readOnly;if(this._firstFragment){if(this._firstFragment=!1,$&&G&&G.params[G._isServer?"server_no_context_takeover":"client_no_context_takeover"])$=Q>=G._threshold;this._compress=$}else $=!1,Z=0;if(J.fin)this._firstFragment=!0;let H={[f6]:Q,fin:J.fin,generateMask:this._generateMask,mask:J.mask,maskBuffer:this._maskBuffer,opcode:Z,readOnly:K,rsv1:$};if(y1(X))if(this._state!==P5)this.enqueue([this.getBlobData,X,this._compress,H,Y]);else this.getBlobData(X,this._compress,H,Y);else if(this._state!==P5)this.enqueue([this.dispatch,X,this._compress,H,Y]);else this.dispatch(X,this._compress,H,Y)}getBlobData(X,J,Y,G){this._bufferedBytes+=Y[f6],this._state=pc,X.arrayBuffer().then((Z)=>{if(this._socket.destroyed){let Q=new Error("The socket was closed while the blob was being read");process.nextTick(oW,this,Q,G);return}this._bufferedBytes-=Y[f6];let $=e7(Z);if(!J)this._state=P5,this.sendFrame(d4.frame($,Y),G),this.dequeue();else this.dispatch($,J,Y,G)}).catch((Z)=>{process.nextTick(fc,this,Z,G)})}dispatch(X,J,Y,G){if(!J){this.sendFrame(d4.frame(X,Y),G);return}let Z=this._extensions[iM.extensionName];this._bufferedBytes+=Y[f6],this._state=cc,Z.compress(X,Y.fin,($,Q)=>{if(this._socket.destroyed){let K=new Error("The socket was closed while data was being compressed");oW(this,K,G);return}this._bufferedBytes-=Y[f6],this._state=P5,Y.readOnly=!1,this.sendFrame(d4.frame(Q,Y),G),this.dequeue()})}dequeue(){while(this._state===P5&&this._queue.length){let X=this._queue.shift();this._bufferedBytes-=X[3][f6],Reflect.apply(X[0],this,X.slice(1))}}enqueue(X){this._bufferedBytes+=X[3][f6],this._queue.push(X)}sendFrame(X,J){if(X.length===2)this._socket.cork(),this._socket.write(X[0]),this._socket.write(X[1],J),this._socket.uncork();else this._socket.write(X[0],J)}}sM.exports=d4;function oW(X,J,Y){if(typeof Y==="function")Y(J);for(let G=0;G<X._queue.length;G++){let Z=X._queue[G],$=Z[Z.length-1];if(typeof $==="function")$(J)}}function fc(X,J,Y){oW(X,J,Y),X.onerror(J)}});var QR=H6((Nv0,$R)=>{var{kForOnEventAttribute:$G,kListener:lW}=a9(),tM=Symbol("kCode"),eM=Symbol("kData"),XR=Symbol("kError"),JR=Symbol("kMessage"),YR=Symbol("kReason"),b1=Symbol("kTarget"),GR=Symbol("kType"),ZR=Symbol("kWasClean");class c4{constructor(X){this[b1]=null,this[GR]=X}get target(){return this[b1]}get type(){return this[GR]}}Object.defineProperty(c4.prototype,"target",{enumerable:!0});Object.defineProperty(c4.prototype,"type",{enumerable:!0});class h1 extends c4{constructor(X,J={}){super(X);this[tM]=J.code===void 0?0:J.code,this[YR]=J.reason===void 0?"":J.reason,this[ZR]=J.wasClean===void 0?!1:J.wasClean}get code(){return this[tM]}get reason(){return this[YR]}get wasClean(){return this[ZR]}}Object.defineProperty(h1.prototype,"code",{enumerable:!0});Object.defineProperty(h1.prototype,"reason",{enumerable:!0});Object.defineProperty(h1.prototype,"wasClean",{enumerable:!0});class QG extends c4{constructor(X,J={}){super(X);this[XR]=J.error===void 0?null:J.error,this[JR]=J.message===void 0?"":J.message}get error(){return this[XR]}get message(){return this[JR]}}Object.defineProperty(QG.prototype,"error",{enumerable:!0});Object.defineProperty(QG.prototype,"message",{enumerable:!0});class O2 extends c4{constructor(X,J={}){super(X);this[eM]=J.data===void 0?null:J.data}get data(){return this[eM]}}Object.defineProperty(O2.prototype,"data",{enumerable:!0});var uc={addEventListener(X,J,Y={}){for(let Z of this.listeners(X))if(!Y[$G]&&Z[lW]===J&&!Z[$G])return;let G;if(X==="message")G=function Z($,Q){let K=new O2("message",{data:Q?$:$.toString()});K[b1]=this,A2(J,this,K)};else if(X==="close")G=function Z($,Q){let K=new h1("close",{code:$,reason:Q.toString(),wasClean:this._closeFrameReceived&&this._closeFrameSent});K[b1]=this,A2(J,this,K)};else if(X==="error")G=function Z($){let Q=new QG("error",{error:$,message:$.message});Q[b1]=this,A2(J,this,Q)};else if(X==="open")G=function Z(){let $=new c4("open");$[b1]=this,A2(J,this,$)};else return;if(G[$G]=!!Y[$G],G[lW]=J,Y.once)this.once(X,G);else this.on(X,G)},removeEventListener(X,J){for(let Y of this.listeners(X))if(Y[lW]===J&&!Y[$G]){this.removeListener(X,Y);break}}};$R.exports={CloseEvent:h1,ErrorEvent:QG,Event:c4,EventTarget:uc,MessageEvent:O2};function A2(X,J,Y){if(typeof X==="object"&&X.handleEvent)X.handleEvent.call(X,Y);else X.call(J,Y)}});var rW=H6((Wv0,HR)=>{var{tokenChars:HG}=k1();function Y9(X,J,Y){if(X[J]===void 0)X[J]=[Y];else X[J].push(Y)}function oc(X){let J=Object.create(null),Y=Object.create(null),G=!1,Z=!1,$=!1,Q,K,H=-1,V=-1,W=-1,U=0;for(;U<X.length;U++)if(V=X.charCodeAt(U),Q===void 0)if(W===-1&&HG[V]===1){if(H===-1)H=U}else if(U!==0&&(V===32||V===9)){if(W===-1&&H!==-1)W=U}else if(V===59||V===44){if(H===-1)throw new SyntaxError(`Unexpected character at index ${U}`);if(W===-1)W=U;let _=X.slice(H,W);if(V===44)Y9(J,_,Y),Y=Object.create(null);else Q=_;H=W=-1}else throw new SyntaxError(`Unexpected character at index ${U}`);else if(K===void 0)if(W===-1&&HG[V]===1){if(H===-1)H=U}else if(V===32||V===9){if(W===-1&&H!==-1)W=U}else if(V===59||V===44){if(H===-1)throw new SyntaxError(`Unexpected character at index ${U}`);if(W===-1)W=U;if(Y9(Y,X.slice(H,W),!0),V===44)Y9(J,Q,Y),Y=Object.create(null),Q=void 0;H=W=-1}else if(V===61&&H!==-1&&W===-1)K=X.slice(H,U),H=W=-1;else throw new SyntaxError(`Unexpected character at index ${U}`);else if(Z){if(HG[V]!==1)throw new SyntaxError(`Unexpected character at index ${U}`);if(H===-1)H=U;else if(!G)G=!0;Z=!1}else if($)if(HG[V]===1){if(H===-1)H=U}else if(V===34&&H!==-1)$=!1,W=U;else if(V===92)Z=!0;else throw new SyntaxError(`Unexpected character at index ${U}`);else if(V===34&&X.charCodeAt(U-1)===61)$=!0;else if(W===-1&&HG[V]===1){if(H===-1)H=U}else if(H!==-1&&(V===32||V===9)){if(W===-1)W=U}else if(V===59||V===44){if(H===-1)throw new SyntaxError(`Unexpected character at index ${U}`);if(W===-1)W=U;let _=X.slice(H,W);if(G)_=_.replace(/\\/g,""),G=!1;if(Y9(Y,K,_),V===44)Y9(J,Q,Y),Y=Object.create(null),Q=void 0;K=void 0,H=W=-1}else throw new SyntaxError(`Unexpected character at index ${U}`);if(H===-1||$||V===32||V===9)throw new SyntaxError("Unexpected end of input");if(W===-1)W=U;let L=X.slice(H,W);if(Q===void 0)Y9(J,L,Y);else{if(K===void 0)Y9(Y,L,!0);else if(G)Y9(Y,K,L.replace(/\\/g,""));else Y9(Y,K,L);Y9(J,Q,Y)}return J}function nc(X){return Object.keys(X).map((J)=>{let Y=X[J];if(!Array.isArray(Y))Y=[Y];return Y.map((G)=>{return[J].concat(Object.keys(G).map((Z)=>{let $=G[Z];if(!Array.isArray($))$=[$];return $.map((Q)=>Q===!0?Z:`${Z}=${Q}`).join("; ")})).join("; ")}).join(", ")}).join(", ")}HR.exports={format:nc,parse:oc}});var eW=H6((zv0,LR)=>{var lc=e0("events"),rc=e0("https"),ic=e0("http"),VR=e0("net"),ac=e0("tls"),{randomBytes:sc,createHash:tc}=e0("crypto"),{Duplex:Uv0,Readable:Dv0}=e0("stream"),{URL:iW}=e0("url"),p4=ZG(),ec=uW(),Xp=nW(),{isBlob:Jp}=k1(),{BINARY_TYPES:KR,EMPTY_BUFFER:q2,GUID:Yp,kForOnEventAttribute:aW,kListener:Gp,kStatusCode:Zp,kWebSocket:C8,NOOP:NR}=a9(),{EventTarget:{addEventListener:$p,removeEventListener:Qp}}=QR(),{format:Hp,parse:Kp}=rW(),{toBuffer:Bp}=JG(),WR=Symbol("kAborted"),sW=[8,13],t9=["CONNECTING","OPEN","CLOSING","CLOSED"],Vp=/^[!#$%&'*+\-.0-9A-Z^_`|a-z~]+$/;class s extends lc{constructor(X,J,Y){super();if(this._binaryType=KR[0],this._closeCode=1006,this._closeFrameReceived=!1,this._closeFrameSent=!1,this._closeMessage=q2,this._closeTimer=null,this._errorEmitted=!1,this._extensions={},this._paused=!1,this._protocol="",this._readyState=s.CONNECTING,this._receiver=null,this._sender=null,this._socket=null,X!==null){if(this._bufferedAmount=0,this._isServer=!1,this._redirects=0,J===void 0)J=[];else if(!Array.isArray(J))if(typeof J==="object"&&J!==null)Y=J,J=[];else J=[J];UR(this,X,J,Y)}else this._autoPong=Y.autoPong,this._isServer=!0}get binaryType(){return this._binaryType}set binaryType(X){if(!KR.includes(X))return;if(this._binaryType=X,this._receiver)this._receiver._binaryType=X}get bufferedAmount(){if(!this._socket)return this._bufferedAmount;return this._socket._writableState.length+this._sender._bufferedBytes}get extensions(){return Object.keys(this._extensions).join()}get isPaused(){return this._paused}get onclose(){return null}get onerror(){return null}get onopen(){return null}get onmessage(){return null}get protocol(){return this._protocol}get readyState(){return this._readyState}get url(){return this._url}setSocket(X,J,Y){let G=new ec({allowSynchronousEvents:Y.allowSynchronousEvents,binaryType:this.binaryType,extensions:this._extensions,isServer:this._isServer,maxPayload:Y.maxPayload,skipUTF8Validation:Y.skipUTF8Validation}),Z=new Xp(X,this._extensions,Y.generateMask);if(this._receiver=G,this._sender=Z,this._socket=X,G[C8]=this,Z[C8]=this,X[C8]=this,G.on("conclude",Up),G.on("drain",Dp),G.on("error",zp),G.on("message",Ap),G.on("ping",Op),G.on("pong",qp),Z.onerror=Lp,X.setTimeout)X.setTimeout(0);if(X.setNoDelay)X.setNoDelay();if(J.length>0)X.unshift(J);X.on("close",AR),X.on("data",w2),X.on("end",OR),X.on("error",qR),this._readyState=s.OPEN,this.emit("open")}emitClose(){if(!this._socket){this._readyState=s.CLOSED,this.emit("close",this._closeCode,this._closeMessage);return}if(this._extensions[p4.extensionName])this._extensions[p4.extensionName].cleanup();this._receiver.removeAllListeners(),this._readyState=s.CLOSED,this.emit("close",this._closeCode,this._closeMessage)}close(X,J){if(this.readyState===s.CLOSED)return;if(this.readyState===s.CONNECTING){R6(this,this._req,"WebSocket was closed before the connection was established");return}if(this.readyState===s.CLOSING){if(this._closeFrameSent&&(this._closeFrameReceived||this._receiver._writableState.errorEmitted))this._socket.end();return}this._readyState=s.CLOSING,this._sender.close(X,J,!this._isServer,(Y)=>{if(Y)return;if(this._closeFrameSent=!0,this._closeFrameReceived||this._receiver._writableState.errorEmitted)this._socket.end()}),zR(this)}pause(){if(this.readyState===s.CONNECTING||this.readyState===s.CLOSED)return;this._paused=!0,this._socket.pause()}ping(X,J,Y){if(this.readyState===s.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if(typeof X==="function")Y=X,X=J=void 0;else if(typeof J==="function")Y=J,J=void 0;if(typeof X==="number")X=X.toString();if(this.readyState!==s.OPEN){tW(this,X,Y);return}if(J===void 0)J=!this._isServer;this._sender.ping(X||q2,J,Y)}pong(X,J,Y){if(this.readyState===s.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if(typeof X==="function")Y=X,X=J=void 0;else if(typeof J==="function")Y=J,J=void 0;if(typeof X==="number")X=X.toString();if(this.readyState!==s.OPEN){tW(this,X,Y);return}if(J===void 0)J=!this._isServer;this._sender.pong(X||q2,J,Y)}resume(){if(this.readyState===s.CONNECTING||this.readyState===s.CLOSED)return;if(this._paused=!1,!this._receiver._writableState.needDrain)this._socket.resume()}send(X,J,Y){if(this.readyState===s.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if(typeof J==="function")Y=J,J={};if(typeof X==="number")X=X.toString();if(this.readyState!==s.OPEN){tW(this,X,Y);return}let G={binary:typeof X!=="string",mask:!this._isServer,compress:!0,fin:!0,...J};if(!this._extensions[p4.extensionName])G.compress=!1;this._sender.send(X||q2,G,Y)}terminate(){if(this.readyState===s.CLOSED)return;if(this.readyState===s.CONNECTING){R6(this,this._req,"WebSocket was closed before the connection was established");return}if(this._socket)this._readyState=s.CLOSING,this._socket.destroy()}}Object.defineProperty(s,"CONNECTING",{enumerable:!0,value:t9.indexOf("CONNECTING")});Object.defineProperty(s.prototype,"CONNECTING",{enumerable:!0,value:t9.indexOf("CONNECTING")});Object.defineProperty(s,"OPEN",{enumerable:!0,value:t9.indexOf("OPEN")});Object.defineProperty(s.prototype,"OPEN",{enumerable:!0,value:t9.indexOf("OPEN")});Object.defineProperty(s,"CLOSING",{enumerable:!0,value:t9.indexOf("CLOSING")});Object.defineProperty(s.prototype,"CLOSING",{enumerable:!0,value:t9.indexOf("CLOSING")});Object.defineProperty(s,"CLOSED",{enumerable:!0,value:t9.indexOf("CLOSED")});Object.defineProperty(s.prototype,"CLOSED",{enumerable:!0,value:t9.indexOf("CLOSED")});["binaryType","bufferedAmount","extensions","isPaused","protocol","readyState","url"].forEach((X)=>{Object.defineProperty(s.prototype,X,{enumerable:!0})});["open","error","close","message"].forEach((X)=>{Object.defineProperty(s.prototype,`on${X}`,{enumerable:!0,get(){for(let J of this.listeners(X))if(J[aW])return J[Gp];return null},set(J){for(let Y of this.listeners(X))if(Y[aW]){this.removeListener(X,Y);break}if(typeof J!=="function")return;this.addEventListener(X,J,{[aW]:!0})}})});s.prototype.addEventListener=$p;s.prototype.removeEventListener=Qp;LR.exports=s;function UR(X,J,Y,G){let Z={allowSynchronousEvents:!0,autoPong:!0,protocolVersion:sW[1],maxPayload:104857600,skipUTF8Validation:!1,perMessageDeflate:!0,followRedirects:!1,maxRedirects:10,...G,socketPath:void 0,hostname:void 0,protocol:void 0,timeout:void 0,method:"GET",host:void 0,path:void 0,port:void 0};if(X._autoPong=Z.autoPong,!sW.includes(Z.protocolVersion))throw new RangeError(`Unsupported protocol version: ${Z.protocolVersion} (supported versions: ${sW.join(", ")})`);let $;if(J instanceof iW)$=J;else try{$=new iW(J)}catch(R){throw new SyntaxError(`Invalid URL: ${J}`)}if($.protocol==="http:")$.protocol="ws:";else if($.protocol==="https:")$.protocol="wss:";X._url=$.href;let Q=$.protocol==="wss:",K=$.protocol==="ws+unix:",H;if($.protocol!=="ws:"&&!Q&&!K)H=`The URL's protocol must be one of "ws:", "wss:", "http:", "https", or "ws+unix:"`;else if(K&&!$.pathname)H="The URL's pathname is empty";else if($.hash)H="The URL contains a fragment identifier";if(H){let R=new SyntaxError(H);if(X._redirects===0)throw R;else{L2(X,R);return}}let V=Q?443:80,W=sc(16).toString("base64"),U=Q?rc.request:ic.request,L=new Set,_;if(Z.createConnection=Z.createConnection||(Q?Wp:Np),Z.defaultPort=Z.defaultPort||V,Z.port=$.port||V,Z.host=$.hostname.startsWith("[")?$.hostname.slice(1,-1):$.hostname,Z.headers={...Z.headers,"Sec-WebSocket-Version":Z.protocolVersion,"Sec-WebSocket-Key":W,Connection:"Upgrade",Upgrade:"websocket"},Z.path=$.pathname+$.search,Z.timeout=Z.handshakeTimeout,Z.perMessageDeflate)_=new p4(Z.perMessageDeflate!==!0?Z.perMessageDeflate:{},!1,Z.maxPayload),Z.headers["Sec-WebSocket-Extensions"]=Hp({[p4.extensionName]:_.offer()});if(Y.length){for(let R of Y){if(typeof R!=="string"||!Vp.test(R)||L.has(R))throw new SyntaxError("An invalid or duplicated subprotocol was specified");L.add(R)}Z.headers["Sec-WebSocket-Protocol"]=Y.join(",")}if(Z.origin)if(Z.protocolVersion<13)Z.headers["Sec-WebSocket-Origin"]=Z.origin;else Z.headers.Origin=Z.origin;if($.username||$.password)Z.auth=`${$.username}:${$.password}`;if(K){let R=Z.path.split(":");Z.socketPath=R[0],Z.path=R[1]}let z;if(Z.followRedirects){if(X._redirects===0){X._originalIpc=K,X._originalSecure=Q,X._originalHostOrSocketPath=K?Z.socketPath:$.host;let R=G&&G.headers;if(G={...G,headers:{}},R)for(let[j,m]of Object.entries(R))G.headers[j.toLowerCase()]=m}else if(X.listenerCount("redirect")===0){let R=K?X._originalIpc?Z.socketPath===X._originalHostOrSocketPath:!1:X._originalIpc?!1:$.host===X._originalHostOrSocketPath;if(!R||X._originalSecure&&!Q){if(delete Z.headers.authorization,delete Z.headers.cookie,!R)delete Z.headers.host;Z.auth=void 0}}if(Z.auth&&!G.headers.authorization)G.headers.authorization="Basic "+Buffer.from(Z.auth).toString("base64");if(z=X._req=U(Z),X._redirects)X.emit("redirect",X.url,z)}else z=X._req=U(Z);if(Z.timeout)z.on("timeout",()=>{R6(X,z,"Opening handshake has timed out")});if(z.on("error",(R)=>{if(z===null||z[WR])return;z=X._req=null,L2(X,R)}),z.on("response",(R)=>{let j=R.headers.location,m=R.statusCode;if(j&&Z.followRedirects&&m>=300&&m<400){if(++X._redirects>Z.maxRedirects){R6(X,z,"Maximum redirects exceeded");return}z.abort();let B0;try{B0=new iW(j,J)}catch(f){let Y0=new SyntaxError(`Invalid URL: ${j}`);L2(X,Y0);return}UR(X,B0,Y,G)}else if(!X.emit("unexpected-response",z,R))R6(X,z,`Unexpected server response: ${R.statusCode}`)}),z.on("upgrade",(R,j,m)=>{if(X.emit("upgrade",R),X.readyState!==s.CONNECTING)return;z=X._req=null;let B0=R.headers.upgrade;if(B0===void 0||B0.toLowerCase()!=="websocket"){R6(X,j,"Invalid Upgrade header");return}let f=tc("sha1").update(W+Yp).digest("base64");if(R.headers["sec-websocket-accept"]!==f){R6(X,j,"Invalid Sec-WebSocket-Accept header");return}let Y0=R.headers["sec-websocket-protocol"],N0;if(Y0!==void 0){if(!L.size)N0="Server sent a subprotocol but none was requested";else if(!L.has(Y0))N0="Server sent an invalid subprotocol"}else if(L.size)N0="Server sent no subprotocol";if(N0){R6(X,j,N0);return}if(Y0)X._protocol=Y0;let G0=R.headers["sec-websocket-extensions"];if(G0!==void 0){if(!_){R6(X,j,"Server sent a Sec-WebSocket-Extensions header but no extension was requested");return}let t;try{t=Kp(G0)}catch(O0){R6(X,j,"Invalid Sec-WebSocket-Extensions header");return}let i=Object.keys(t);if(i.length!==1||i[0]!==p4.extensionName){R6(X,j,"Server indicated an extension that was not requested");return}try{_.accept(t[p4.extensionName])}catch(O0){R6(X,j,"Invalid Sec-WebSocket-Extensions header");return}X._extensions[p4.extensionName]=_}X.setSocket(j,m,{allowSynchronousEvents:Z.allowSynchronousEvents,generateMask:Z.generateMask,maxPayload:Z.maxPayload,skipUTF8Validation:Z.skipUTF8Validation})}),Z.finishRequest)Z.finishRequest(z,X);else z.end()}function L2(X,J){X._readyState=s.CLOSING,X._errorEmitted=!0,X.emit("error",J),X.emitClose()}function Np(X){return X.path=X.socketPath,VR.connect(X)}function Wp(X){if(X.path=void 0,!X.servername&&X.servername!=="")X.servername=VR.isIP(X.host)?"":X.host;return ac.connect(X)}function R6(X,J,Y){X._readyState=s.CLOSING;let G=new Error(Y);if(Error.captureStackTrace(G,R6),J.setHeader){if(J[WR]=!0,J.abort(),J.socket&&!J.socket.destroyed)J.socket.destroy();process.nextTick(L2,X,G)}else J.destroy(G),J.once("error",X.emit.bind(X,"error")),J.once("close",X.emitClose.bind(X))}function tW(X,J,Y){if(J){let G=Jp(J)?J.size:Bp(J).length;if(X._socket)X._sender._bufferedBytes+=G;else X._bufferedAmount+=G}if(Y){let G=new Error(`WebSocket is not open: readyState ${X.readyState} (${t9[X.readyState]})`);process.nextTick(Y,G)}}function Up(X,J){let Y=this[C8];if(Y._closeFrameReceived=!0,Y._closeMessage=J,Y._closeCode=X,Y._socket[C8]===void 0)return;if(Y._socket.removeListener("data",w2),process.nextTick(DR,Y._socket),X===1005)Y.close();else Y.close(X,J)}function Dp(){let X=this[C8];if(!X.isPaused)X._socket.resume()}function zp(X){let J=this[C8];if(J._socket[C8]!==void 0)J._socket.removeListener("data",w2),process.nextTick(DR,J._socket),J.close(X[Zp]);if(!J._errorEmitted)J._errorEmitted=!0,J.emit("error",X)}function BR(){this[C8].emitClose()}function Ap(X,J){this[C8].emit("message",X,J)}function Op(X){let J=this[C8];if(J._autoPong)J.pong(X,!this._isServer,NR);J.emit("ping",X)}function qp(X){this[C8].emit("pong",X)}function DR(X){X.resume()}function Lp(X){let J=this[C8];if(J.readyState===s.CLOSED)return;if(J.readyState===s.OPEN)J._readyState=s.CLOSING,zR(J);if(this._socket.end(),!J._errorEmitted)J._errorEmitted=!0,J.emit("error",X)}function zR(X){X._closeTimer=setTimeout(X._socket.destroy.bind(X._socket),30000)}function AR(){let X=this[C8];this.removeListener("close",AR),this.removeListener("data",w2),this.removeListener("end",OR),X._readyState=s.CLOSING;let J;if(!this._readableState.endEmitted&&!X._closeFrameReceived&&!X._receiver._writableState.errorEmitted&&(J=X._socket.read())!==null)X._receiver.write(J);if(X._receiver.end(),this[C8]=void 0,clearTimeout(X._closeTimer),X._receiver._writableState.finished||X._receiver._writableState.errorEmitted)X.emitClose();else X._receiver.on("error",BR),X._receiver.on("finish",BR)}function w2(X){if(!this[C8]._receiver.write(X))this.pause()}function OR(){let X=this[C8];X._readyState=s.CLOSING,X._receiver.end(),this.end()}function qR(){let X=this[C8];if(this.removeListener("error",qR),this.on("error",NR),X)X._readyState=s.CLOSING,this.destroy()}});var FR=H6((Av0,wR)=>{var{tokenChars:wp}=k1();function Fp(X){let J=new Set,Y=-1,G=-1,Z=0;for(Z;Z<X.length;Z++){let Q=X.charCodeAt(Z);if(G===-1&&wp[Q]===1){if(Y===-1)Y=Z}else if(Z!==0&&(Q===32||Q===9)){if(G===-1&&Y!==-1)G=Z}else if(Q===44){if(Y===-1)throw new SyntaxError(`Unexpected character at index ${Z}`);if(G===-1)G=Z;let K=X.slice(Y,G);if(J.has(K))throw new SyntaxError(`The "${K}" subprotocol is duplicated`);J.add(K),Y=G=-1}else throw new SyntaxError(`Unexpected character at index ${Z}`)}if(Y===-1||G!==-1)throw new SyntaxError("Unexpected end of input");let $=X.slice(Y,Z);if(J.has($))throw new SyntaxError(`The "${$}" subprotocol is duplicated`);return J.add($),J}wR.exports={parse:Fp}});var CR=H6((qv0,RR)=>{var _p=e0("events"),F2=e0("http"),{Duplex:Ov0}=e0("stream"),{createHash:Pp}=e0("crypto"),_R=rW(),JX=ZG(),Mp=FR(),Rp=eW(),{GUID:Cp,kWebSocket:Tp}=a9(),Ep=/^[+/0-9A-Za-z]{22}==$/;class MR extends _p{constructor(X,J){super();if(X={allowSynchronousEvents:!0,autoPong:!0,maxPayload:104857600,skipUTF8Validation:!1,perMessageDeflate:!1,handleProtocols:null,clientTracking:!0,verifyClient:null,noServer:!1,backlog:null,server:null,host:null,path:null,port:null,WebSocket:Rp,...X},X.port==null&&!X.server&&!X.noServer||X.port!=null&&(X.server||X.noServer)||X.server&&X.noServer)throw new TypeError('One and only one of the "port", "server", or "noServer" options must be specified');if(X.port!=null)this._server=F2.createServer((Y,G)=>{let Z=F2.STATUS_CODES[426];G.writeHead(426,{"Content-Length":Z.length,"Content-Type":"text/plain"}),G.end(Z)}),this._server.listen(X.port,X.host,X.backlog,J);else if(X.server)this._server=X.server;if(this._server){let Y=this.emit.bind(this,"connection");this._removeListeners=Ip(this._server,{listening:this.emit.bind(this,"listening"),error:this.emit.bind(this,"error"),upgrade:(G,Z,$)=>{this.handleUpgrade(G,Z,$,Y)}})}if(X.perMessageDeflate===!0)X.perMessageDeflate={};if(X.clientTracking)this.clients=new Set,this._shouldEmitClose=!1;this.options=X,this._state=0}address(){if(this.options.noServer)throw new Error('The server is operating in "noServer" mode');if(!this._server)return null;return this._server.address()}close(X){if(this._state===2){if(X)this.once("close",()=>{X(new Error("The server is not running"))});process.nextTick(KG,this);return}if(X)this.once("close",X);if(this._state===1)return;if(this._state=1,this.options.noServer||this.options.server){if(this._server)this._removeListeners(),this._removeListeners=this._server=null;if(this.clients)if(!this.clients.size)process.nextTick(KG,this);else this._shouldEmitClose=!0;else process.nextTick(KG,this)}else{let J=this._server;this._removeListeners(),this._removeListeners=this._server=null,J.close(()=>{KG(this)})}}shouldHandle(X){if(this.options.path){let J=X.url.indexOf("?");if((J!==-1?X.url.slice(0,J):X.url)!==this.options.path)return!1}return!0}handleUpgrade(X,J,Y,G){J.on("error",PR);let Z=X.headers["sec-websocket-key"],$=X.headers.upgrade,Q=+X.headers["sec-websocket-version"];if(X.method!=="GET"){YX(this,X,J,405,"Invalid HTTP method");return}if($===void 0||$.toLowerCase()!=="websocket"){YX(this,X,J,400,"Invalid Upgrade header");return}if(Z===void 0||!Ep.test(Z)){YX(this,X,J,400,"Missing or invalid Sec-WebSocket-Key header");return}if(Q!==8&&Q!==13){YX(this,X,J,400,"Missing or invalid Sec-WebSocket-Version header");return}if(!this.shouldHandle(X)){BG(J,400);return}let K=X.headers["sec-websocket-protocol"],H=new Set;if(K!==void 0)try{H=Mp.parse(K)}catch(U){YX(this,X,J,400,"Invalid Sec-WebSocket-Protocol header");return}let V=X.headers["sec-websocket-extensions"],W={};if(this.options.perMessageDeflate&&V!==void 0){let U=new JX(this.options.perMessageDeflate,!0,this.options.maxPayload);try{let L=_R.parse(V);if(L[JX.extensionName])U.accept(L[JX.extensionName]),W[JX.extensionName]=U}catch(L){YX(this,X,J,400,"Invalid or unacceptable Sec-WebSocket-Extensions header");return}}if(this.options.verifyClient){let U={origin:X.headers[`${Q===8?"sec-websocket-origin":"origin"}`],secure:!!(X.socket.authorized||X.socket.encrypted),req:X};if(this.options.verifyClient.length===2){this.options.verifyClient(U,(L,_,z,R)=>{if(!L)return BG(J,_||401,z,R);this.completeUpgrade(W,Z,H,X,J,Y,G)});return}if(!this.options.verifyClient(U))return BG(J,401)}this.completeUpgrade(W,Z,H,X,J,Y,G)}completeUpgrade(X,J,Y,G,Z,$,Q){if(!Z.readable||!Z.writable)return Z.destroy();if(Z[Tp])throw new Error("server.handleUpgrade() was called more than once with the same socket, possibly due to a misconfiguration");if(this._state>0)return BG(Z,503);let H=["HTTP/1.1 101 Switching Protocols","Upgrade: websocket","Connection: Upgrade",`Sec-WebSocket-Accept: ${Pp("sha1").update(J+Cp).digest("base64")}`],V=new this.options.WebSocket(null,void 0,this.options);if(Y.size){let W=this.options.handleProtocols?this.options.handleProtocols(Y,G):Y.values().next().value;if(W)H.push(`Sec-WebSocket-Protocol: ${W}`),V._protocol=W}if(X[JX.extensionName]){let W=X[JX.extensionName].params,U=_R.format({[JX.extensionName]:[W]});H.push(`Sec-WebSocket-Extensions: ${U}`),V._extensions=X}if(this.emit("headers",H,G),Z.write(H.concat(`\r
`).join(`\r
`)),Z.removeListener("error",PR),V.setSocket(Z,$,{allowSynchronousEvents:this.options.allowSynchronousEvents,maxPayload:this.options.maxPayload,skipUTF8Validation:this.options.skipUTF8Validation}),this.clients)this.clients.add(V),V.on("close",()=>{if(this.clients.delete(V),this._shouldEmitClose&&!this.clients.size)process.nextTick(KG,this)});Q(V,G)}}RR.exports=MR;function Ip(X,J){for(let Y of Object.keys(J))X.on(Y,J[Y]);return function Y(){for(let G of Object.keys(J))X.removeListener(G,J[G])}}function KG(X){X._state=2,X.emit("close")}function PR(){this.destroy()}function BG(X,J,Y,G){Y=Y||F2.STATUS_CODES[J],G={Connection:"close","Content-Type":"text/html","Content-Length":Buffer.byteLength(Y),...G},X.once("finish",X.destroy),X.end(`HTTP/1.1 ${J} ${F2.STATUS_CODES[J]}\r
`+Object.keys(G).map((Z)=>`${Z}: ${G[Z]}`).join(`\r
`)+`\r
\r
`+Y)}function YX(X,J,Y,G,Z){if(X.listenerCount("wsClientError")){let $=new Error(Z);Error.captureStackTrace($,YX),X.emit("wsClientError",$,Y,J)}else BG(Y,G,Z)}});import*as gR from"node:http";var _2=(X)=>typeof X==="function",B=function(X,J){if(typeof X==="function")return function(){if(X(arguments))return J.apply(this,arguments);return(Y)=>J(Y,...arguments)};switch(X){case 0:case 1:throw new RangeError(`Invalid arity ${X}`);case 2:return function(Y,G){if(arguments.length>=2)return J(Y,G);return function(Z){return J(Z,Y)}};case 3:return function(Y,G,Z){if(arguments.length>=3)return J(Y,G,Z);return function($){return J($,Y,G)}};case 4:return function(Y,G,Z,$){if(arguments.length>=4)return J(Y,G,Z,$);return function(Q){return J(Q,Y,G,Z)}};case 5:return function(Y,G,Z,$,Q){if(arguments.length>=5)return J(Y,G,Z,$,Q);return function(K){return J(K,Y,G,Z,$)}};default:return function(){if(arguments.length>=X)return J.apply(this,arguments);let Y=arguments;return function(G){return J(G,...Y)}}}};var x=(X)=>X;var d1=(X)=>()=>X,n6=d1(!0),K6=d1(!1);var c1=d1(void 0),u8=c1;function N(X,J,Y,G,Z,$,Q,K,H){switch(arguments.length){case 1:return X;case 2:return J(X);case 3:return Y(J(X));case 4:return G(Y(J(X)));case 5:return Z(G(Y(J(X))));case 6:return $(Z(G(Y(J(X)))));case 7:return Q($(Z(G(Y(J(X))))));case 8:return K(Q($(Z(G(Y(J(X)))))));case 9:return H(K(Q($(Z(G(Y(J(X))))))));default:{let V=arguments[0];for(let W=1;W<arguments.length;W++)V=arguments[W](V);return V}}}var B6=(X)=>(J,Y)=>J===Y||X(J,Y),fR=(X,J)=>X===J,uR=()=>fR;var VG=uR();var P2=B(2,(X,J)=>B6((Y,G)=>X(J(Y),J(G)))),BU=P2(VG,(X)=>X.getTime());var NG=(X)=>B6((J,Y)=>{if(J.length!==Y.length)return!1;for(let G=0;G<J.length;G++)if(!X(J[G],Y[G]))return!1;return!0});var oR="3.12.4",X4=()=>oR;var VU=`effect/GlobalValue/globalStoreId/${X4()}`,p1,h=(X,J)=>{if(!p1)globalThis[VU]??=new Map,p1=globalThis[VU];if(!p1.has(X))p1.set(X,J());return p1.get(X)};var X8=(X)=>typeof X==="string",k8=(X)=>typeof X==="number",V6=(X)=>typeof X==="boolean",l6=(X)=>typeof X==="bigint",G9=(X)=>typeof X==="symbol",M5=_2,M2=(X)=>X===void 0;var NU=(X)=>!1;var f1=(X)=>typeof X==="object"&&X!==null,R5=(X)=>f1(X)||M5(X),A=B(2,(X,J)=>R5(X)&&(J in X)),Z9=B(2,(X,J)=>A(X,"_tag")&&X._tag===J),o4=(X)=>X===null||X===void 0,R2=(X)=>X!==null&&X!==void 0;var ZX=(X)=>X instanceof Date,$X=(X)=>A(X,Symbol.iterator),C2=(X)=>f1(X)&&!Array.isArray(X);var WU=(X)=>A(X,"then")&&M5(X.then);var $9=(X)=>`BUG: ${X} - please report an issue at https://github.com/Effect-TS/effect/issues`;class QX{self;called=!1;constructor(X){this.self=X}next(X){return this.called?{value:X,done:!0}:(this.called=!0,{value:this.self,done:!1})}return(X){return{value:X,done:!0}}throw(X){throw X}[Symbol.iterator](){return new QX(this.self)}}var lR=335903614,rR=4150755663,iR=1481765933,aR=1284865837,sR=9007199254740992,tR=134217728;class UG{_state;constructor(X,J,Y,G){if(o4(J)&&o4(X))J=Math.random()*4294967295>>>0,X=0;else if(o4(J))J=X,X=0;if(o4(G)&&o4(Y))G=this._state?this._state[3]:rR,Y=this._state?this._state[2]:lR;else if(o4(G))G=Y,Y=0;return this._state=new Int32Array([0,0,Y>>>0,((G||0)|1)>>>0]),this._next(),UU(this._state,this._state[0],this._state[1],X>>>0,J>>>0),this._next(),this}getState(){return[this._state[0],this._state[1],this._state[2],this._state[3]]}setState(X){this._state[0]=X[0],this._state[1]=X[1],this._state[2]=X[2],this._state[3]=X[3]|1}integer(X){return Math.round(this.number()*Number.MAX_SAFE_INTEGER)%X}number(){let X=(this._next()&67108863)*1,J=(this._next()&134217727)*1;return(X*tR+J)/sR}_next(){let X=this._state[0]>>>0,J=this._state[1]>>>0;eR(this._state,X,J,iR,aR),UU(this._state,this._state[0],this._state[1],this._state[2],this._state[3]);let Y=X>>>18,G=(J>>>18|X<<14)>>>0;Y=(Y^X)>>>0,G=(G^J)>>>0;let Z=(G>>>27|Y<<5)>>>0,$=X>>>27,Q=(-$>>>0&31)>>>0;return(Z>>>$|Z<<Q)>>>0}}function eR(X,J,Y,G,Z){let $=(Y>>>16)*(Z&65535)>>>0,Q=(Y&65535)*(Z>>>16)>>>0,K=(Y&65535)*(Z&65535)>>>0,H=(Y>>>16)*(Z>>>16)+((Q>>>16)+($>>>16))>>>0;if(Q=Q<<16>>>0,K=K+Q>>>0,K>>>0<Q>>>0)H=H+1>>>0;if($=$<<16>>>0,K=K+$>>>0,K>>>0<$>>>0)H=H+1>>>0;H=H+Math.imul(Y,G)>>>0,H=H+Math.imul(J,Z)>>>0,X[0]=H,X[1]=K}function UU(X,J,Y,G,Z){let $=J+G>>>0,Q=Y+Z>>>0;if(Q>>>0<Y>>>0)$=$+1|0;X[0]=$,X[1]=Q}var T2=Symbol.for("effect/Utils/YieldWrap");class r6{#X;constructor(X){this.#X=X}[T2](){return this.#X}}function HX(X){if(typeof X==="object"&&X!==null&&T2 in X)return X[T2]();throw new Error($9("yieldWrapGet"))}var X6=h("effect/Utils/isStructuralRegion",()=>({enabled:!1,tester:void 0}));var XC=(X)=>{let J={[X](Y){return Y()}};return function(Y){return J[X](Y)}},M0=XC("effect_internal_function"),ep=function*(){}.constructor;var E2=h(Symbol.for("effect/Hash/randomHashCache"),()=>new WeakMap),M=Symbol.for("effect/Hash"),O=(X)=>{if(X6.enabled===!0)return 0;switch(typeof X){case"number":return Q9(X);case"bigint":return D0(X.toString(10));case"boolean":return D0(String(X));case"symbol":return D0(String(X));case"string":return D0(X);case"undefined":return D0("undefined");case"function":case"object":if(X===null)return D0("null");else if(X instanceof Date)return O(X.toISOString());else if(JC(X))return X[M]();else return n4(X);default:throw new Error(`BUG: unhandled typeof ${typeof X} - please report an issue at https://github.com/Effect-TS/effect/issues`)}},n4=(X)=>{if(!E2.has(X))E2.set(X,Q9(Math.floor(Math.random()*Number.MAX_SAFE_INTEGER)));return E2.get(X)},C=(X)=>(J)=>J*53^X,DG=(X)=>X&3221225471|X>>>1&1073741824,JC=(X)=>A(X,M),Q9=(X)=>{if(X!==X||X===1/0)return 0;let J=X|0;if(J!==X)J^=X*4294967295;while(X>4294967295)J^=X/=4294967295;return DG(J)},D0=(X)=>{let J=5381,Y=X.length;while(Y)J=J*33^X.charCodeAt(--Y);return DG(J)},YC=(X,J)=>{let Y=12289;for(let G=0;G<J.length;G++)Y^=N(D0(J[G]),C(O(X[J[G]])));return DG(Y)},zG=(X)=>YC(X,Object.keys(X)),J8=(X)=>{let J=6151;for(let Y=0;Y<X.length;Y++)J=N(J,C(O(X[Y])));return DG(J)},S=function(){if(arguments.length===1){let Y=arguments[0];return function(G){return Object.defineProperty(Y,M,{value(){return G},enumerable:!1}),G}}let X=arguments[0],J=arguments[1];return Object.defineProperty(X,M,{value(){return J},enumerable:!1}),J};var P=Symbol.for("effect/Equal");function w(){if(arguments.length===1)return(X)=>AG(X,arguments[0]);return AG(arguments[0],arguments[1])}function AG(X,J){if(X===J)return!0;let Y=typeof X;if(Y!==typeof J)return!1;if(Y==="object"||Y==="function"){if(X!==null&&J!==null){if(KX(X)&&KX(J))if(O(X)===O(J)&&X[P](J))return!0;else return X6.enabled&&X6.tester?X6.tester(X,J):!1;else if(X instanceof Date&&J instanceof Date)return X.toISOString()===J.toISOString()}if(X6.enabled){if(Array.isArray(X)&&Array.isArray(J))return X.length===J.length&&X.every((G,Z)=>AG(G,J[Z]));if(Object.getPrototypeOf(X)===Object.prototype&&Object.getPrototypeOf(X)===Object.prototype){let G=Object.keys(X),Z=Object.keys(J);if(G.length===Z.length){for(let $ of G)if(!(($ in J)&&AG(X[$],J[$])))return X6.tester?X6.tester(X,J):!1;return!0}}return X6.tester?X6.tester(X,J):!1}}return X6.enabled&&X6.tester?X6.tester(X,J):!1}var KX=(X)=>A(X,P),l4=()=>w;var v=Symbol.for("nodejs.util.inspect.custom"),r=(X)=>{try{if(A(X,"toJSON")&&M5(X.toJSON)&&X.toJSON.length===0)return X.toJSON();else if(Array.isArray(X))return X.map(r)}catch(J){return{}}return AU(X)},d=(X)=>JSON.stringify(X,null,2),Kf={toJSON(){return r(this)},[v](){return this.toJSON()},toString(){return d(this.toJSON())}};var H9=(X,J=2)=>{if(typeof X==="string")return X;try{return typeof X==="object"?OG(X,J):String(X)}catch(Y){return String(X)}},OG=(X,J)=>{let Y=[],G=JSON.stringify(X,(Z,$)=>typeof $==="object"&&$!==null?Y.includes($)?void 0:Y.push($)&&(r4.fiberRefs!==void 0&&DU($)?$[I2](r4.fiberRefs):$):$,J);return Y=void 0,G},I2=Symbol.for("effect/Inspectable/Redactable"),DU=(X)=>typeof X==="object"&&X!==null&&(I2 in X),r4=h("effect/Inspectable/redactableState",()=>({fiberRefs:void 0})),zU=(X,J)=>{let Y=r4.fiberRefs;r4.fiberRefs=X;try{return J()}finally{r4.fiberRefs=Y}},AU=(X)=>{if(DU(X)&&r4.fiberRefs!==void 0)return X[I2](r4.fiberRefs);return X};var D=(X,J)=>{switch(J.length){case 0:return X;case 1:return J[0](X);case 2:return J[1](J[0](X));case 3:return J[2](J[1](J[0](X)));case 4:return J[3](J[2](J[1](J[0](X))));case 5:return J[4](J[3](J[2](J[1](J[0](X)))));case 6:return J[5](J[4](J[3](J[2](J[1](J[0](X))))));case 7:return J[6](J[5](J[4](J[3](J[2](J[1](J[0](X)))))));case 8:return J[7](J[6](J[5](J[4](J[3](J[2](J[1](J[0](X))))))));case 9:return J[8](J[7](J[6](J[5](J[4](J[3](J[2](J[1](J[0](X)))))))));default:{let Y=X;for(let G=0,Z=J.length;G<Z;G++)Y=J[G](Y);return Y}}};var i4="Async",K9="Commit",y8="Failure",BX="OnFailure",VX="OnSuccess",NX="OnSuccessAndFailure",g8="Success",qG="Sync",OU="Tag",a4="UpdateRuntimeFlags",WX="While",UX="Iterator",LG="WithRuntime",DX="Yield",o1="RevertFlags";var qU=Symbol.for("effect/Effect"),l1=Symbol.for("effect/Stream"),LU=Symbol.for("effect/Sink"),wU=Symbol.for("effect/Channel"),T5={_R:(X)=>X,_E:(X)=>X,_A:(X)=>X,_V:X4()},ZC={_A:(X)=>X,_In:(X)=>X,_L:(X)=>X,_E:(X)=>X,_R:(X)=>X},$C={_Env:(X)=>X,_InErr:(X)=>X,_InElem:(X)=>X,_InDone:(X)=>X,_OutErr:(X)=>X,_OutElem:(X)=>X,_OutDone:(X)=>X},B9={[qU]:T5,[l1]:T5,[LU]:ZC,[wU]:$C,[P](X){return this===X},[M](){return S(this,n4(this))},[Symbol.iterator](){return new QX(new r6(this))},pipe(){return D(this,arguments)}},s4={[M](){return S(this,zG(this))},[P](X){let J=Object.keys(this),Y=Object.keys(X);if(J.length!==Y.length)return!1;for(let G of J)if(!((G in X)&&w(this[G],X[G])))return!1;return!0}},o8={...B9,_op:K9},j2={...o8,...s4},FU=function(){function X(){}return X.prototype=o8,X}();var _U=Symbol.for("effect/Option"),PU={...B9,[_U]:{_A:(X)=>X},[v](){return this.toJSON()},toString(){return d(this.toJSON())}},QC=Object.assign(Object.create(PU),{_tag:"Some",_op:"Some",[P](X){return S2(X)&&v2(X)&&w(this.value,X.value)},[M](){return S(this,C(O(this._tag))(O(this.value)))},toJSON(){return{_id:"Option",_tag:this._tag,value:r(this.value)}}}),HC=O("None"),KC=Object.assign(Object.create(PU),{_tag:"None",_op:"None",[P](X){return S2(X)&&wG(X)},[M](){return HC},toJSON(){return{_id:"Option",_tag:this._tag}}}),S2=(X)=>A(X,_U),wG=(X)=>X._tag==="None",v2=(X)=>X._tag==="Some",zX=Object.create(KC),t4=(X)=>{let J=Object.create(QC);return J.value=X,J};var x2=Symbol.for("effect/Either"),MU={...B9,[x2]:{_R:(X)=>X},[v](){return this.toJSON()},toString(){return d(this.toJSON())}},BC=Object.assign(Object.create(MU),{_tag:"Right",_op:"Right",[P](X){return k2(X)&&y2(X)&&w(this.right,X.right)},[M](){return C(O(this._tag))(O(this.right))},toJSON(){return{_id:"Either",_tag:this._tag,right:r(this.right)}}}),VC=Object.assign(Object.create(MU),{_tag:"Left",_op:"Left",[P](X){return k2(X)&&_G(X)&&w(this.left,X.left)},[M](){return C(O(this._tag))(O(this.left))},toJSON(){return{_id:"Either",_tag:this._tag,left:r(this.left)}}}),k2=(X)=>A(X,x2),_G=(X)=>X._tag==="Left",y2=(X)=>X._tag==="Right",g2=(X)=>{let J=Object.create(VC);return J.left=X,J},b2=(X)=>{let J=Object.create(BC);return J.right=X,J};var u=b2,k=g2;var v0=_G,J6=y2;var V9=B(2,(X,{onLeft:J,onRight:Y})=>v0(X)?J(X.left):Y(X.right));var s1=V9({onLeft:x,onRight:x});var h2=B(2,(X,J)=>{if(J6(X))return X.right;throw J(X.left)});var MG=(X)=>X.length>0;var AX=(X)=>(J,Y)=>J===Y?0:X(J,Y);var m2=AX((X,J)=>X<J?-1:1);var J4=B(2,(X,J)=>AX((Y,G)=>X(J(Y),J(G))));var e4=(X)=>B(2,(J,Y)=>X(J,Y)===1);var q=()=>zX,F=t4;var H0=wG,c=v2,$0=B(2,(X,{onNone:J,onSome:Y})=>H0(X)?J():Y(X.value));var K0=B(2,(X,J)=>H0(X)?J():X.value),Y6=B(2,(X,J)=>H0(X)?J():X),TU=B(2,(X,J)=>H0(X)?F(J()):X);var H8=(X)=>X==null?q():F(X);var T8=K0(c1),RG=(X)=>(...J)=>{try{return F(X(...J))}catch(Y){return q()}},EU=B(2,(X,J)=>{if(c(X))return X.value;throw J()}),CG=EU(()=>new Error("getOrThrow called on a None")),g0=B(2,(X,J)=>H0(X)?q():F(J(X.value)));var i6=B(2,(X,J)=>H0(X)?q():J(X.value));var IU=B(2,(X,J)=>H0(X)?q():J(X.value));var AC=(X)=>B(2,(J,Y)=>H0(J)?!1:X(J.value,Y)),OC=l4(),jU=AC(OC),SU=B(2,(X,J)=>H0(X)?!1:J(X.value));var TG=(...X)=>X;var IG=(X)=>{let Y=X[Symbol.iterator]().next();if(Y.done)throw new Error("unsafeHead: empty iterable");return Y.value};var LC={[Symbol.iterator](){return wC}},wC={next(){return{done:!0,value:void 0}}},jG=()=>LC;var X7=(X)=>new Array(X),d2=(X,J)=>{let Y=Math.max(1,Math.floor(X)),G=new Array(Y);for(let Z=0;Z<Y;Z++)G[Z]=J(Z);return G};var p=(X)=>Array.isArray(X)?X:Array.from(X),c2=(X)=>Array.isArray(X)?X:[X];var vU=B(2,(X,{onEmpty:J,onNonEmpty:Y})=>T0(X)?Y(F8(X),s6(X)):J());var J7=B(2,(X,J)=>[J,...X]);var xU=B(2,(X,J)=>[...X,J]),p2=B(2,(X,J)=>p(X).concat(p(J)));var qX=Array.isArray,FC=(X)=>X.length===0,kU=FC,a6=MG,T0=MG;var yU=(X,J)=>X<0||X>=J.length,_C=(X,J)=>Math.floor(Math.min(Math.max(0,X),J.length)),PC=B(2,(X,J)=>{let Y=Math.floor(J);return yU(Y,X)?q():F(X[Y])}),f2=B(2,(X,J)=>{let Y=Math.floor(J);if(yU(Y,X))throw new Error(`Index ${Y} out of bounds`);return X[Y]});var E5=PC(0),F8=f2(0),vG=(X)=>T0(X)?F(u2(X)):q(),u2=(X)=>X[X.length-1];var s6=(X)=>X.slice(1);var MC=(X,J)=>{let Y=0;for(let G of X){if(!J(G,Y))break;Y++}return Y},o2=B(2,(X,J)=>r2(X,MC(X,J))),gU=B(2,(X,J)=>{let Y=p(X);return Y.slice(_C(J,Y),Y.length)});var n2=(X)=>Array.from(X).reverse(),I5=B(2,(X,J)=>{let Y=Array.from(X);return Y.sort(J),Y});var l2=B(2,(X,J)=>bU(X,J,TG)),bU=B(3,(X,J,Y)=>{let G=p(X),Z=p(J);if(T0(G)&&T0(Z)){let $=[Y(F8(G),F8(Z))],Q=Math.min(G.length,Z.length);for(let K=1;K<Q;K++)$[K]=Y(G[K],Z[K]);return $}return[]});var RC=l4();var r2=B(2,(X,J)=>{let Y=Array.from(X),G=Math.floor(J);if(T0(Y)){if(G>=1)return CC(Y,G);return[[],Y]}return[Y,[]]}),CC=B(2,(X,J)=>{let Y=Math.max(1,Math.floor(J));return Y>=X.length?[LX(X),[]]:[J7(X.slice(1,Y),F8(X)),X.slice(Y)]});var LX=(X)=>X.slice();var TC=B(3,(X,J,Y)=>{let G=p(X),Z=p(J);if(T0(G)){if(T0(Z))return mU(Y)(p2(G,Z));return G}return Z}),N9=B(2,(X,J)=>TC(X,J,RC));var t6=()=>[],E8=(X)=>[X],C6=B(2,(X,J)=>X.map(J)),XJ=B(2,(X,J)=>{if(kU(X))return[];let Y=[];for(let G=0;G<X.length;G++){let Z=J(X[G],G);for(let $=0;$<Z.length;$++)Y.push(Z[$])}return Y}),JJ=XJ(x),YJ=B(2,(X,J)=>{let Y=p(X),G=[];for(let Z=0;Z<Y.length;Z++){let $=J(Y[Z],Z);if(c($))G.push($.value)}return G});var j5=B(3,(X,J,Y)=>p(X).reduce((G,Z,$)=>Y(G,Z,$),J));var hU=B(2,(X,J)=>X.every(J));var i2=(X,J)=>{let Y=[],G=X,Z;while(c(Z=J(G))){let[$,Q]=Z.value;Y.push($),G=Q}return Y};var Y4=NG;var mU=B(2,(X,J)=>{let Y=p(X);if(T0(Y)){let G=[F8(Y)],Z=s6(Y);for(let $ of Z)if(G.every((Q)=>!J($,Q)))G.push($);return G}return[]}),a2=(X)=>mU(X,l4());var S5=B(2,(X,J)=>p(X).join(J));var xG=(X,J)=>{switch(J._tag){case"StringKeyword":case"TemplateLiteral":return Object.keys(X);case"SymbolKeyword":return Object.getOwnPropertySymbols(X);case"Refinement":return xG(X,J.from)}},Y7=(X)=>Object.keys(X).concat(Object.getOwnPropertySymbols(X)),G7=(X)=>{let J=!1,Y;return()=>{if(J)return Y;return Y=X(),J=!0,Y}},cU=(X)=>{try{return X.toISOString()}catch(J){return String(X)}},T6=(X)=>{if(X8(X))return JSON.stringify(X);else if(k8(X)||X==null||V6(X)||G9(X))return String(X);else if(ZX(X))return cU(X);else if(l6(X))return String(X)+"n";else if(!qX(X)&&A(X,"toString")&&M5(X.toString)&&X.toString!==Object.prototype.toString)return X.toString();try{if(JSON.stringify(X),qX(X))return`[${X.map(T6).join(",")}]`;else return`{${Y7(X).map((J)=>`${X8(J)?JSON.stringify(J):String(J)}:${T6(X[J])}`).join(",")}}`}catch(J){return String(X)}},kG=(X)=>typeof X==="string"?JSON.stringify(X):String(X),t2=(X)=>Array.isArray(X),pU=(X)=>!Array.isArray(X),dU=(X)=>`[${kG(X)}]`,yG=(X)=>t2(X)?X.map(dU).join(""):dU(X);var gG=(X,J,Y,G)=>{let Z=X;if(Y&&T0(Y))Z+=`
at path: ${yG(Y)}`;if(J!==void 0)Z+=`
details: ${J}`;if(G)Z+=`
schema (${G._tag}): ${G}`;return Z};var e2=(X)=>gG("Duplicate index signature",`${X} index signature`),fU=gG("Unsupported index signature parameter","An index signature parameter type must be `string`, `symbol`, a template literal type or a refinement of the previous types"),uU=gG("Invalid element","A required element cannot follow an optional element. ts(1257)");var X3=(X)=>gG("Duplicate property signature",`Duplicate key ${T6(X)}`);var J3=Symbol.for("effect/SchemaId/DateFromSelf");var N6=m2;var FX=(X)=>X.replace(/[/\\^$*+?.()|[\]{}]/g,"\\$&");var lU=Symbol.for("effect/annotation/Brand"),pG=Symbol.for("effect/annotation/SchemaId"),Z3=Symbol.for("effect/annotation/Message"),$3=Symbol.for("effect/annotation/MissingMessage"),$J=Symbol.for("effect/annotation/Identifier"),b8=Symbol.for("effect/annotation/Title"),rU=Symbol.for("effect/annotation/AutoTitle"),e6=Symbol.for("effect/annotation/Description"),iU=Symbol.for("effect/annotation/Examples"),aU=Symbol.for("effect/annotation/Default"),sU=Symbol.for("effect/annotation/JSONSchema"),Q3=Symbol.for("effect/annotation/Arbitrary"),H3=Symbol.for("effect/annotation/Pretty"),tU=Symbol.for("effect/annotation/Equivalence"),eU=Symbol.for("effect/annotation/Documentation"),K3=Symbol.for("effect/annotation/Concurrency"),B3=Symbol.for("effect/annotation/Batching"),V3=Symbol.for("effect/annotation/ParseIssueTitle"),N3=Symbol.for("effect/annotation/ParseOptions"),W3=Symbol.for("effect/annotation/DecodingFallback"),U3=Symbol.for("effect/annotation/Surrogate"),XD=Symbol.for("effect/annotation/StableFilter"),_8=B(2,(X,J)=>Object.prototype.hasOwnProperty.call(X.annotations,J)?F(X.annotations[J]):q()),JD=_8(lU),YD=_8(Z3),GD=_8($3),fG=_8(b8),D3=_8(rU),Z7=_8($J),uG=_8(e6);var ZD=_8(K3),$D=_8(B3),QD=_8(V3),HD=_8(N3),KD=_8(W3),oG=_8(U3),SC=_8(XD),z3=(X)=>SU(SC(X),(J)=>J===!0),A3=Symbol.for("effect/annotation/JSONIdentifier"),vC=_8(A3),BD=(X)=>Y6(vC(X),()=>Z7(X));class PX{typeParameters;decodeUnknown;encodeUnknown;annotations;_tag="Declaration";constructor(X,J,Y,G={}){this.typeParameters=X,this.decodeUnknown=J,this.encodeUnknown=Y,this.annotations=G}toString(){return K0(W9(this),()=>"<declaration schema>")}toJSON(){return{_tag:this._tag,typeParameters:this.typeParameters.map((X)=>X.toJSON()),annotations:f0(this.annotations)}}}var QJ=(X)=>(J)=>J._tag===X;class nG{literal;annotations;_tag="Literal";constructor(X,J={}){this.literal=X,this.annotations=J}toString(){return K0(W9(this),()=>T6(this.literal))}toJSON(){return{_tag:this._tag,literal:l6(this.literal)?String(this.literal):this.literal,annotations:f0(this.annotations)}}}var lG=QJ("Literal");class rG{symbol;annotations;_tag="UniqueSymbol";constructor(X,J={}){this.symbol=X,this.annotations=J}toString(){return K0(W9(this),()=>T6(this.symbol))}toJSON(){return{_tag:this._tag,symbol:String(this.symbol),annotations:f0(this.annotations)}}}class VD{annotations;_tag="UndefinedKeyword";constructor(X={}){this.annotations=X}toString(){return X5(this)}toJSON(){return{_tag:this._tag,annotations:f0(this.annotations)}}}var xC=new VD({[b8]:"undefined"});class ND{annotations;_tag="VoidKeyword";constructor(X={}){this.annotations=X}toString(){return X5(this)}toJSON(){return{_tag:this._tag,annotations:f0(this.annotations)}}}var kC=new ND({[b8]:"void"});class WD{annotations;_tag="NeverKeyword";constructor(X={}){this.annotations=X}toString(){return X5(this)}toJSON(){return{_tag:this._tag,annotations:f0(this.annotations)}}}var UD=new WD({[b8]:"never"});class DD{annotations;_tag="UnknownKeyword";constructor(X={}){this.annotations=X}toString(){return X5(this)}toJSON(){return{_tag:this._tag,annotations:f0(this.annotations)}}}var zD=new DD({[b8]:"unknown"});class AD{annotations;_tag="AnyKeyword";constructor(X={}){this.annotations=X}toString(){return X5(this)}toJSON(){return{_tag:this._tag,annotations:f0(this.annotations)}}}var OD=new AD({[b8]:"any"});class qD{annotations;_tag="StringKeyword";constructor(X={}){this.annotations=X}toString(){return X5(this)}toJSON(){return{_tag:this._tag,annotations:f0(this.annotations)}}}var O3=new qD({[b8]:"string",[e6]:"a string"}),LD=QJ("StringKeyword");class wD{annotations;_tag="NumberKeyword";constructor(X={}){this.annotations=X}toString(){return X5(this)}toJSON(){return{_tag:this._tag,annotations:f0(this.annotations)}}}var FD=new wD({[b8]:"number",[e6]:"a number"});class _D{annotations;_tag="BooleanKeyword";constructor(X={}){this.annotations=X}toString(){return X5(this)}toJSON(){return{_tag:this._tag,annotations:f0(this.annotations)}}}var PD=new _D({[b8]:"boolean",[e6]:"a boolean"});class MD{annotations;_tag="BigIntKeyword";constructor(X={}){this.annotations=X}toString(){return X5(this)}toJSON(){return{_tag:this._tag,annotations:f0(this.annotations)}}}var yC=new MD({[b8]:"bigint",[e6]:"a bigint"});class RD{annotations;_tag="SymbolKeyword";constructor(X={}){this.annotations=X}toString(){return X5(this)}toJSON(){return{_tag:this._tag,annotations:f0(this.annotations)}}}var gC=new RD({[b8]:"symbol",[e6]:"a symbol"}),CD=QJ("SymbolKeyword");class TD{annotations;_tag="ObjectKeyword";constructor(X={}){this.annotations=X}toString(){return X5(this)}toJSON(){return{_tag:this._tag,annotations:f0(this.annotations)}}}var bC=new TD({[b8]:"object",[e6]:"an object in the TypeScript meaning, i.e. the `object` type"});class HJ{type;annotations;constructor(X,J={}){this.type=X,this.annotations=J}toJSON(){return{type:this.type.toJSON(),annotations:f0(this.annotations)}}toString(){return String(this.type)}}class KJ extends HJ{isOptional;constructor(X,J,Y={}){super(X,Y);this.isOptional=J}toJSON(){return{type:this.type.toJSON(),isOptional:this.isOptional,annotations:f0(this.annotations)}}toString(){return String(this.type)+(this.isOptional?"?":"")}}var ED=(X)=>X.map((J)=>J.type);class iG{elements;rest;isReadonly;annotations;_tag="TupleType";constructor(X,J,Y,G={}){this.elements=X,this.rest=J,this.isReadonly=Y,this.annotations=G;let Z=!1,$=!1;for(let Q of X)if(Q.isOptional)Z=!0;else if(Z){$=!0;break}if($||Z&&J.length>1)throw new Error(uU)}toString(){return K0(W9(this),()=>hC(this))}toJSON(){return{_tag:this._tag,elements:this.elements.map((X)=>X.toJSON()),rest:this.rest.map((X)=>X.toJSON()),isReadonly:this.isReadonly,annotations:f0(this.annotations)}}}var hC=(X)=>{let J=X.elements.map(String).join(", ");return vU(X.rest,{onEmpty:()=>`readonly [${J}]`,onNonEmpty:(Y,G)=>{let Z=String(Y),$=Z.includes(" | ")?`(${Z})`:Z;if(G.length>0){let Q=G.map(String).join(", ");if(X.elements.length>0)return`readonly [${J}, ...${$}[], ${Q}]`;else return`readonly [...${$}[], ${Q}]`}else if(X.elements.length>0)return`readonly [${J}, ...${$}[]]`;else return`ReadonlyArray<${Z}>`}})};class $7 extends KJ{name;isReadonly;constructor(X,J,Y,G,Z){super(J,Y,Z);this.name=X,this.isReadonly=G}toString(){return(this.isReadonly?"readonly ":"")+String(this.name)+(this.isOptional?"?":"")+": "+this.type}toJSON(){return{name:String(this.name),type:this.type.toJSON(),isOptional:this.isOptional,isReadonly:this.isReadonly,annotations:f0(this.annotations)}}}var ID=(X)=>{switch(X._tag){case"StringKeyword":case"SymbolKeyword":case"TemplateLiteral":return!0;case"Refinement":return ID(X.from)}return!1};class aG{type;isReadonly;parameter;constructor(X,J,Y){if(this.type=J,this.isReadonly=Y,ID(X))this.parameter=X;else throw new Error(fU)}toString(){return(this.isReadonly?"readonly ":"")+`[x: ${this.parameter}]: ${this.type}`}toJSON(){return{parameter:this.parameter.toJSON(),type:this.type.toJSON(),isReadonly:this.isReadonly}}}class Q7{annotations;_tag="TypeLiteral";propertySignatures;indexSignatures;constructor(X,J,Y={}){this.annotations=Y;let G={};for(let $=0;$<X.length;$++){let Q=X[$].name;if(Object.prototype.hasOwnProperty.call(G,Q))throw new Error(X3(Q));G[Q]=null}let Z={string:!1,symbol:!1};for(let $=0;$<J.length;$++){let Q=w3(J[$].parameter);if(LD(Q)){if(Z.string)throw new Error(e2("string"));Z.string=!0}else if(CD(Q)){if(Z.symbol)throw new Error(e2("symbol"));Z.symbol=!0}}this.propertySignatures=X,this.indexSignatures=J}toString(){return K0(W9(this),()=>mC(this))}toJSON(){return{_tag:this._tag,propertySignatures:this.propertySignatures.map((X)=>X.toJSON()),indexSignatures:this.indexSignatures.map((X)=>X.toJSON()),annotations:f0(this.annotations)}}}var nU=(X)=>X.map(String).join("; "),mC=(X)=>{if(X.propertySignatures.length>0){let J=X.propertySignatures.map(String).join("; ");if(X.indexSignatures.length>0)return`{ ${J}; ${nU(X.indexSignatures)} }`;else return`{ ${J} }`}else if(X.indexSignatures.length>0)return`{ ${nU(X.indexSignatures)} }`;else return"{}"};var dC=I5(J4(N6,(X)=>{switch(X._tag){case"AnyKeyword":return 0;case"UnknownKeyword":return 1;case"ObjectKeyword":return 2;case"StringKeyword":case"NumberKeyword":case"BooleanKeyword":case"BigIntKeyword":case"SymbolKeyword":return 3}return 4})),cC={string:"StringKeyword",number:"NumberKeyword",boolean:"BooleanKeyword",bigint:"BigIntKeyword"},jD=(X)=>XJ(X,(J)=>q3(J)?jD(J.types):[J]),pC=(X)=>{let J=dC(X),Y=[],G={},Z=[];for(let $ of J)switch($._tag){case"NeverKeyword":break;case"AnyKeyword":return[OD];case"UnknownKeyword":return[zD];case"ObjectKeyword":case"UndefinedKeyword":case"VoidKeyword":case"StringKeyword":case"NumberKeyword":case"BooleanKeyword":case"BigIntKeyword":case"SymbolKeyword":{if(!G[$._tag])G[$._tag]=$,Y.push($);break}case"Literal":{let Q=typeof $.literal;switch(Q){case"string":case"number":case"bigint":case"boolean":{let K=cC[Q];if(!G[K]&&!Z.includes($.literal))Z.push($.literal),Y.push($);break}case"object":{if(!Z.includes($.literal))Z.push($.literal),Y.push($);break}}break}case"UniqueSymbol":{if(!G.SymbolKeyword&&!Z.includes($.symbol))Z.push($.symbol),Y.push($);break}case"TupleType":{if(!G.ObjectKeyword)Y.push($);break}case"TypeLiteral":{if($.propertySignatures.length===0&&$.indexSignatures.length===0){if(!G["{}"])G["{}"]=$,Y.push($)}else if(!G.ObjectKeyword)Y.push($);break}default:Y.push($)}return Y};class k5{types;annotations;static make=(X,J)=>{return SD(X)?new k5(X,J):X.length===1?X[0]:UD};static unify=(X,J)=>{return k5.make(pC(jD(X)),J)};_tag="Union";constructor(X,J={}){this.types=X,this.annotations=J}toString(){return K0(W9(this),()=>this.types.map(String).join(" | "))}toJSON(){return{_tag:this._tag,types:this.types.map((X)=>X.toJSON()),annotations:f0(this.annotations)}}}var SD=(X)=>X.length>1,q3=QJ("Union"),G3=h(Symbol.for("effect/Schema/AST/toJSONMemoMap"),()=>new WeakMap);class sG{f;annotations;_tag="Suspend";constructor(X,J={}){this.f=X,this.annotations=J,this.f=G7(X)}toString(){return W9(this).pipe(Y6(()=>i6(RG(this.f)(),(X)=>W9(X))),K0(()=>"<suspended schema>"))}toJSON(){let X=this.f(),J=G3.get(X);if(J)return J;return G3.set(X,{_tag:this._tag}),J={_tag:this._tag,ast:X.toJSON(),annotations:f0(this.annotations)},G3.set(X,J),J}}class BJ{from;filter;annotations;_tag="Refinement";constructor(X,J,Y={}){this.from=X,this.filter=J,this.annotations=Y}toString(){return Z7(this).pipe(K0(()=>$0(kD(this),{onNone:()=>`{ ${this.from} | filter }`,onSome:(X)=>MX(this.from)?String(this.from)+" & "+X:X})))}toJSON(){return{_tag:this._tag,from:this.from.toJSON(),annotations:f0(this.annotations)}}}var MX=QJ("Refinement"),VJ={};var G4=(X,J)=>{let Y=Object.getOwnPropertyDescriptors(X),G={...X.annotations,...J},Z=oG(X);if(c(Z))G[U3]=G4(Z.value,J);return Y.annotations.value=G,Object.create(Object.getPrototypeOf(X),Y)};var fC="[\\s\\S]*",uC="[+-]?\\d*\\.?\\d+(?:[Ee][+-]?\\d+)?",vD=(X,J)=>{switch(X._tag){case"Literal":return FX(String(X.literal));case"StringKeyword":return fC;case"NumberKeyword":return uC;case"TemplateLiteral":return xD(X,J,!1);case"Union":return X.types.map((Y)=>vD(Y,J)).join("|")}},oC=(X,J,Y,G)=>{if(q3(X)){if(Y&&!G)return`(?:${J})`}else if(!Y||!G)return J;return`(${J})`},xD=(X,J,Y)=>{let G="";if(X.head!==""){let Z=FX(X.head);G+=J&&Y?`(${Z})`:Z}for(let Z of X.spans){let $=vD(Z.type,J);if(G+=oC(Z.type,$,J,Y),Z.literal!==""){let Q=FX(Z.literal);G+=J&&Y?`(${Q})`:Q}}return G},L3=(X)=>new RegExp(`^${xD(X,!1,!0)}$`);var n8=(X)=>{switch(X._tag){case"Declaration":{let J=E6(X.typeParameters,n8);return J===X.typeParameters?X:new PX(J,X.decodeUnknown,X.encodeUnknown,X.annotations)}case"TupleType":{let J=E6(X.elements,(Z)=>{let $=n8(Z.type);return $===Z.type?Z:new KJ($,Z.isOptional)}),Y=ED(X.rest),G=E6(Y,n8);return J===X.elements&&G===Y?X:new iG(J,G.map((Z)=>new HJ(Z)),X.isReadonly,X.annotations)}case"TypeLiteral":{let J=E6(X.propertySignatures,(G)=>{let Z=n8(G.type);return Z===G.type?G:new $7(G.name,Z,G.isOptional,G.isReadonly)}),Y=E6(X.indexSignatures,(G)=>{let Z=n8(G.type);return Z===G.type?G:new aG(G.parameter,Z,G.isReadonly)});return J===X.propertySignatures&&Y===X.indexSignatures?X:new Q7(J,Y,X.annotations)}case"Union":{let J=E6(X.types,n8);return J===X.types?X:k5.make(J,X.annotations)}case"Suspend":return new sG(()=>n8(X.f()),X.annotations);case"Refinement":{let J=n8(X.from);return J===X.from?X:new BJ(J,X.filter,X.annotations)}case"Transformation":return n8(X.to)}return X};var _X=(X)=>$0(BD(X),{onNone:()=>{return},onSome:(J)=>({[A3]:J})});function E6(X,J){let Y=!1,G=X7(X.length);for(let Z=0;Z<X.length;Z++){let $=X[Z],Q=J($);if(Q!==$)Y=!0;G[Z]=Q}return Y?G:X}var cG=(X)=>{switch(X._tag){case"Transformation":return X.from;case"Refinement":return cG(X.from);case"Suspend":return cG(X.f())}},x5=(X,J)=>{switch(X._tag){case"Declaration":{let Y=E6(X.typeParameters,(G)=>x5(G,J));return Y===X.typeParameters?X:new PX(Y,X.decodeUnknown,X.encodeUnknown,X.annotations)}case"TupleType":{let Y=E6(X.elements,($)=>{let Q=x5($.type,J);return Q===$.type?$:new KJ(Q,$.isOptional)}),G=ED(X.rest),Z=E6(G,($)=>x5($,J));return Y===X.elements&&Z===G?X:new iG(Y,Z.map(($)=>new HJ($)),X.isReadonly,_X(X))}case"TypeLiteral":{let Y=E6(X.propertySignatures,(Z)=>{let $=x5(Z.type,J);return $===Z.type?Z:new $7(Z.name,$,Z.isOptional,Z.isReadonly)}),G=E6(X.indexSignatures,(Z)=>{let $=x5(Z.type,J);return $===Z.type?Z:new aG(Z.parameter,$,Z.isReadonly)});return Y===X.propertySignatures&&G===X.indexSignatures?X:new Q7(Y,G,_X(X))}case"Union":{let Y=E6(X.types,(G)=>x5(G,J));return Y===X.types?X:k5.make(Y,_X(X))}case"Suspend":return new sG(()=>x5(X.f(),J),_X(X));case"Refinement":{let Y=x5(X.from,J);if(J){if(Y===X.from)return X;if(cG(X.from)===void 0&&z3(X))return new BJ(Y,X.filter,X.annotations)}let G=_X(X);return G?G4(Y,G):Y}case"Transformation":{let Y=_X(X);return x5(Y?G4(X.from,Y):X.from,J)}}return X},tG=(X)=>x5(X,!1);var f0=(X)=>{let J={};for(let Y of Object.getOwnPropertySymbols(X))J[String(Y)]=X[Y];return J},w3=(X)=>{switch(X._tag){case"StringKeyword":case"SymbolKeyword":case"TemplateLiteral":return X;case"Refinement":return w3(X.from)}};var X5=(X)=>K0(W9(X),()=>X._tag);function nC(X){return $0(JD(X),{onNone:()=>"",onSome:(J)=>J.map((Y)=>` & Brand<${T6(Y)}>`).join("")})}var kD=(X)=>fG(X).pipe(Y6(()=>uG(X)),Y6(()=>D3(X)),g0((J)=>J+nC(X))),W9=(X)=>Y6(Z7(X),()=>kD(X));var F3=Symbol.for("effect/BigDecimal"),sC={[F3]:F3,[M](){let X=eG(this);return N(O(X.value),C(Q9(X.scale)),S(this))},[P](X){return gD(X)&&XT(this,X)},toString(){return`BigDecimal(${mD(this)})`},toJSON(){return{_id:"BigDecimal",value:String(this.value),scale:this.scale}},[v](){return this.toJSON()},pipe(){return D(this,arguments)}},gD=(X)=>A(X,F3),NJ=(X,J)=>{let Y=Object.create(sC);return Y.value=X,Y.scale=J,Y},bD=(X,J)=>{if(X!==Z4&&X%_3===Z4)throw new RangeError("Value must be normalized");let Y=NJ(X,J);return Y.normalized=Y,Y},Z4=BigInt(0);var _3=BigInt(10),tC=bD(Z4,0),eG=(X)=>{if(X.normalized===void 0)if(X.value===Z4)X.normalized=tC;else{let J=`${X.value}`,Y=0;for(let $=J.length-1;$>=0;$--)if(J[$]==="0")Y++;else break;if(Y===0)X.normalized=X;let G=BigInt(J.substring(0,J.length-Y)),Z=X.scale-Y;X.normalized=bD(G,Z)}return X.normalized},yD=B(2,(X,J)=>{if(J>X.scale)return NJ(X.value*_3**BigInt(J-X.scale),J);if(J<X.scale)return NJ(X.value/_3**BigInt(X.scale-J),J);return X});var eC=(X)=>X.value<Z4?NJ(-X.value,X.scale):X;var hD=B6((X,J)=>{if(X.scale>J.scale)return yD(J,X.scale).value===X.value;if(X.scale<J.scale)return yD(X,J.scale).value===J.value;return X.value===J.value}),XT=B(2,(X,J)=>hD(X,J));var mD=(X)=>{let J=eG(X);if(Math.abs(J.scale)>=16)return JT(J);let Y=J.value<Z4,G=Y?`${J.value}`.substring(1):`${J.value}`,Z,$;if(J.scale>=G.length)Z="0",$="0".repeat(J.scale-G.length)+G;else{let K=G.length-J.scale;if(K>G.length){let H=K-G.length;Z=`${G}${"0".repeat(H)}`,$=""}else $=G.slice(K),Z=G.slice(0,K)}let Q=$===""?Z:`${Z}.${$}`;return Y?`-${Q}`:Q},JT=(X)=>{if(YT(X))return"0e+0";let J=eG(X),Y=`${eC(J).value}`,G=Y.slice(0,1),Z=Y.slice(1),$=`${dD(J)?"-":""}${G}`;if(Z!=="")$+=`.${Z}`;let Q=Z.length-J.scale;return`${$}e${Q>=0?"+":""}${Q}`};var YT=(X)=>X.value===Z4,dD=(X)=>X.value<Z4;var fD=Symbol.for("effect/Context/Tag"),WJ=Symbol.for("effect/Context/Reference"),$T="effect/STM",QT=Symbol.for($T),R3={...B9,_op:"Tag",[QT]:T5,[fD]:{_Service:(X)=>X,_Identifier:(X)=>X},toString(){return d(this.toJSON())},toJSON(){return{_id:"Tag",key:this.key,stack:this.stack}},[v](){return this.toJSON()},of(X){return X},context(X){return T3(this,X)}},HT={...R3,[WJ]:WJ},uD=(X)=>{let J=Error.stackTraceLimit;Error.stackTraceLimit=2;let Y=new Error;Error.stackTraceLimit=J;let G=Object.create(R3);return Object.defineProperty(G,"stack",{get(){return Y.stack}}),G.key=X,G};var oD=()=>(X,J)=>{let Y=Error.stackTraceLimit;Error.stackTraceLimit=2;let G=new Error;Error.stackTraceLimit=Y;function Z(){}return Object.setPrototypeOf(Z,HT),Z.key=X,Z.defaultValue=J.defaultValue,Object.defineProperty(Z,"stack",{get(){return G.stack}}),Z},C3=Symbol.for("effect/Context"),KT={[C3]:{_Services:(X)=>X},[P](X){if(nD(X)){if(this.unsafeMap.size===X.unsafeMap.size){for(let J of this.unsafeMap.keys())if(!X.unsafeMap.has(J)||!w(this.unsafeMap.get(J),X.unsafeMap.get(J)))return!1;return!0}}return!1},[M](){return S(this,Q9(this.unsafeMap.size))},pipe(){return D(this,arguments)},toString(){return d(this.toJSON())},toJSON(){return{_id:"Context",services:Array.from(this.unsafeMap).map(r)}},[v](){return this.toJSON()}},$4=(X)=>{let J=Object.create(KT);return J.unsafeMap=X,J},BT=(X)=>{let J=new Error(`Service not found${X.key?`: ${String(X.key)}`:""}`);if(X.stack){let Y=X.stack.split(`
`);if(Y.length>2){let G=Y[2].match(/at (.*)/);if(G)J.message=J.message+` (defined at ${G[1]})`}}if(J.stack){let Y=J.stack.split(`
`);Y.splice(1,3),J.stack=Y.join(`
`)}return J},nD=(X)=>A(X,C3);var lD=(X)=>A(X,WJ),VT=$4(new Map),rD=()=>VT,T3=(X,J)=>$4(new Map([[X.key,J]])),iD=B(3,(X,J,Y)=>{let G=new Map(X.unsafeMap);return G.set(J.key,Y),$4(G)}),M3=h("effect/Context/defaultValueCache",()=>new Map),E3=(X)=>{if(M3.has(X.key))return M3.get(X.key);let J=X.defaultValue();return M3.set(X.key,J),J},aD=(X,J)=>{return X.unsafeMap.has(J.key)?X.unsafeMap.get(J.key):E3(J)},I3=B(2,(X,J)=>{if(!X.unsafeMap.has(J.key)){if(WJ in J)return E3(J);throw BT(J)}return X.unsafeMap.get(J.key)}),sD=I3;var tD=B(2,(X,J)=>{if(!X.unsafeMap.has(J.key))return lD(J)?t4(E3(J)):zX;return t4(X.unsafeMap.get(J.key))}),eD=B(2,(X,J)=>{let Y=new Map(X.unsafeMap);for(let[G,Z]of J.unsafeMap)Y.set(G,Z);return $4(Y)});var u0=uD;var y5=rD,CX=T3,l0=iD,I6=sD;var J5=I3,Q4=tD,g5=eD;var XZ=oD;var Gz=Symbol.for("effect/Chunk");function WT(X,J,Y,G,Z){for(let $=J;$<Math.min(X.length,J+Z);$++)Y[G+$-J]=X[$];return Y}var Zz=[],$z=(X)=>B6((J,Y)=>J.length===Y.length&&G6(J).every((G,Z)=>X(G,G5(Y,Z)))),UT=$z(w),DT={[Gz]:{_A:(X)=>X},toString(){return d(this.toJSON())},toJSON(){return{_id:"Chunk",values:G6(this).map(r)}},[v](){return this.toJSON()},[P](X){return DJ(X)&&UT(this,X)},[M](){return S(this,J8(G6(this)))},[Symbol.iterator](){switch(this.backing._tag){case"IArray":return this.backing.array[Symbol.iterator]();case"IEmpty":return Zz[Symbol.iterator]();default:return G6(this)[Symbol.iterator]()}},pipe(){return D(this,arguments)}},b0=(X)=>{let J=Object.create(DT);switch(J.backing=X,X._tag){case"IEmpty":{J.length=0,J.depth=0,J.left=J,J.right=J;break}case"IConcat":{J.length=X.left.length+X.right.length,J.depth=1+Math.max(X.left.depth,X.right.depth),J.left=X.left,J.right=X.right;break}case"IArray":{J.length=X.array.length,J.depth=0,J.left=Y5,J.right=Y5;break}case"ISingleton":{J.length=1,J.depth=0,J.left=Y5,J.right=Y5;break}case"ISlice":{J.length=X.length,J.depth=X.chunk.depth+1,J.left=Y5,J.right=Y5;break}}return J},DJ=(X)=>A(X,Gz),Y5=b0({_tag:"IEmpty"}),L0=()=>Y5,H7=(...X)=>X.length===1?z0(X[0]):Qz(X),z0=(X)=>b0({_tag:"ISingleton",a:X}),K8=(X)=>DJ(X)?X:b0({_tag:"IArray",array:p(X)}),j3=(X,J,Y)=>{switch(X.backing._tag){case"IArray":{WT(X.backing.array,0,J,Y,X.length);break}case"IConcat":{j3(X.left,J,Y),j3(X.right,J,Y+X.left.length);break}case"ISingleton":{J[Y]=X.backing.a;break}case"ISlice":{let G=0,Z=Y;while(G<X.length)J[Z]=G5(X,G),G+=1,Z+=1;break}}};var zT=(X)=>{switch(X.backing._tag){case"IEmpty":return Zz;case"IArray":return X.backing.array;default:{let J=new Array(X.length);return j3(X,J,0),X.backing={_tag:"IArray",array:J},X.left=Y5,X.right=Y5,X.depth=0,J}}},G6=zT,AT=(X)=>{switch(X.backing._tag){case"IEmpty":case"ISingleton":return X;case"IArray":return b0({_tag:"IArray",array:n2(X.backing.array)});case"IConcat":return b0({_tag:"IConcat",left:Z5(X.backing.right),right:Z5(X.backing.left)});case"ISlice":return B8(n2(G6(X)))}},Z5=AT;var B8=(X)=>b0({_tag:"IArray",array:X}),Qz=(X)=>B8(X),G5=B(2,(X,J)=>{switch(X.backing._tag){case"IEmpty":throw new Error("Index out of bounds");case"ISingleton":{if(J!==0)throw new Error("Index out of bounds");return X.backing.a}case"IArray":{if(J>=X.length||J<0)throw new Error("Index out of bounds");return X.backing.array[J]}case"IConcat":return J<X.left.length?G5(X.left,J):G5(X.right,J-X.left.length);case"ISlice":return G5(X.backing.chunk,J+X.backing.offset)}}),$5=B(2,(X,J)=>o0(X,z0(J))),R0=B(2,(X,J)=>o0(z0(J),X)),UJ=B(2,(X,J)=>{if(J<=0)return Y5;else if(J>=X.length)return X;else switch(X.backing._tag){case"ISlice":return b0({_tag:"ISlice",chunk:X.backing.chunk,length:J,offset:X.backing.offset});case"IConcat":{if(J>X.left.length)return b0({_tag:"IConcat",left:X.left,right:UJ(X.right,J-X.left.length)});return UJ(X.left,J)}default:return b0({_tag:"ISlice",chunk:X,offset:0,length:J})}}),U9=B(2,(X,J)=>{if(J<=0)return X;else if(J>=X.length)return Y5;else switch(X.backing._tag){case"ISlice":return b0({_tag:"ISlice",chunk:X.backing.chunk,offset:X.backing.offset+J,length:X.backing.length-J});case"IConcat":{if(J>X.left.length)return U9(X.right,J-X.left.length);return b0({_tag:"IConcat",left:U9(X.left,J),right:X.right})}default:return b0({_tag:"ISlice",chunk:X,offset:J,length:X.length-J})}});var o0=B(2,(X,J)=>{if(X.backing._tag==="IEmpty")return J;if(J.backing._tag==="IEmpty")return X;let Y=J.depth-X.depth;if(Math.abs(Y)<=1)return b0({_tag:"IConcat",left:X,right:J});else if(Y<-1)if(X.left.depth>=X.right.depth){let G=o0(X.right,J);return b0({_tag:"IConcat",left:X.left,right:G})}else{let G=o0(X.right.right,J);if(G.depth===X.depth-3){let Z=b0({_tag:"IConcat",left:X.right.left,right:G});return b0({_tag:"IConcat",left:X.left,right:Z})}else{let Z=b0({_tag:"IConcat",left:X.left,right:X.right.left});return b0({_tag:"IConcat",left:Z,right:G})}}else if(J.right.depth>=J.left.depth){let G=o0(X,J.left);return b0({_tag:"IConcat",left:G,right:J.right})}else{let G=o0(X,J.left.left);if(G.depth===J.depth-3){let Z=b0({_tag:"IConcat",left:G,right:J.left.right});return b0({_tag:"IConcat",left:Z,right:J.right})}else{let Z=b0({_tag:"IConcat",left:J.left.right,right:J.right});return b0({_tag:"IConcat",left:G,right:Z})}}});var D9=(X)=>X.length===0,y0=(X)=>X.length>0;var zJ=(X)=>G5(X,0),Y8=zJ;var JZ=B(2,(X,J)=>[UJ(X,J),U9(X,J)]);var G8=(X)=>U9(X,1);var S3=Symbol.for("effect/Duration"),OT=BigInt(0),Hz=BigInt(24),YZ=BigInt(60),v3=BigInt(1000),Kz=BigInt(1e6),x3=BigInt(1e9),Bz=/^(-?\d+(?:\.\d+)?)\s+(nanos?|micros?|millis?|seconds?|minutes?|hours?|days?|weeks?)$/,Z8=(X)=>{if(k3(X))return X;else if(k8(X))return Q5(X);else if(l6(X))return TX(X);else if(Array.isArray(X)){if(X.length===2&&k8(X[0])&&k8(X[1]))return TX(BigInt(X[0])*x3+BigInt(X[1]))}else if(X8(X)){Bz.lastIndex=0;let J=Bz.exec(X);if(J){let[Y,G,Z]=J,$=Number(G);switch(Z){case"nano":case"nanos":return TX(BigInt(G));case"micro":case"micros":return Nz(BigInt(G));case"milli":case"millis":return Q5($);case"second":case"seconds":return ZZ($);case"minute":case"minutes":return Wz($);case"hour":case"hours":return Uz($);case"day":case"days":return Dz($);case"week":case"weeks":return zz($)}}}throw new Error("Invalid DurationInput")};var Vz={_tag:"Millis",millis:0},qT={_tag:"Infinity"},LT={[S3]:S3,[M](){return S(this,zG(this.value))},[P](X){return k3(X)&&_T(this,X)},toString(){return`Duration(${Lz(this)})`},toJSON(){switch(this.value._tag){case"Millis":return{_id:"Duration",_tag:"Millis",millis:this.value.millis};case"Nanos":return{_id:"Duration",_tag:"Nanos",hrtime:Az(this)};case"Infinity":return{_id:"Duration",_tag:"Infinity"}}},[v](){return this.toJSON()},pipe(){return D(this,arguments)}},z9=(X)=>{let J=Object.create(LT);if(k8(X))if(isNaN(X)||X<=0)J.value=Vz;else if(!Number.isFinite(X))J.value=qT;else if(!Number.isInteger(X))J.value={_tag:"Nanos",nanos:BigInt(Math.round(X*1e6))};else J.value={_tag:"Millis",millis:X};else if(X<=OT)J.value=Vz;else J.value={_tag:"Nanos",nanos:X};return J},k3=(X)=>A(X,S3);var GZ=z9(0);var TX=(X)=>z9(X),Nz=(X)=>z9(X*v3),Q5=(X)=>z9(X),ZZ=(X)=>z9(X*1000),Wz=(X)=>z9(X*60000),Uz=(X)=>z9(X*3600000),Dz=(X)=>z9(X*86400000),zz=(X)=>z9(X*604800000),l8=(X)=>FT(X,{onMillis:(J)=>J,onNanos:(J)=>Number(J)/1e6});var wT=(X)=>{let J=Z8(X);switch(J.value._tag){case"Infinity":throw new Error("Cannot convert infinite duration to nanos");case"Nanos":return J.value.nanos;case"Millis":return BigInt(Math.round(J.value.millis*1e6))}},Az=(X)=>{let J=Z8(X);switch(J.value._tag){case"Infinity":return[1/0,0];case"Nanos":return[Number(J.value.nanos/x3),Number(J.value.nanos%x3)];case"Millis":return[Math.floor(J.value.millis/1000),Math.round(J.value.millis%1000*1e6)]}},FT=B(2,(X,J)=>{let Y=Z8(X);switch(Y.value._tag){case"Nanos":return J.onNanos(Y.value.nanos);case"Infinity":return J.onMillis(1/0);case"Millis":return J.onMillis(Y.value.millis)}}),Oz=B(3,(X,J,Y)=>{let G=Z8(X),Z=Z8(J);if(G.value._tag==="Infinity"||Z.value._tag==="Infinity")return Y.onMillis(l8(G),l8(Z));else if(G.value._tag==="Nanos"||Z.value._tag==="Nanos"){let $=G.value._tag==="Nanos"?G.value.nanos:BigInt(Math.round(G.value.millis*1e6)),Q=Z.value._tag==="Nanos"?Z.value.nanos:BigInt(Math.round(Z.value.millis*1e6));return Y.onNanos($,Q)}return Y.onMillis(G.value.millis,Z.value.millis)});var qz=(X,J)=>Oz(X,J,{onMillis:(Y,G)=>Y===G,onNanos:(Y,G)=>Y===G});var $Z=B(2,(X,J)=>Oz(X,J,{onMillis:(Y,G)=>Y>=G,onNanos:(Y,G)=>Y>=G})),_T=B(2,(X,J)=>qz(Z8(X),Z8(J))),PT=(X)=>{let J=Z8(X);if(J.value._tag==="Infinity")return{days:1/0,hours:1/0,minutes:1/0,seconds:1/0,millis:1/0,nanos:1/0};let Y=wT(J),G=Y/Kz,Z=G/v3,$=Z/YZ,Q=$/YZ,K=Q/Hz;return{days:Number(K),hours:Number(Q%Hz),minutes:Number($%YZ),seconds:Number(Z%YZ),millis:Number(G%v3),nanos:Number(Y%Kz)}},Lz=(X)=>{let J=Z8(X);if(J.value._tag==="Infinity")return"Infinity";let Y=PT(J),G=[];if(Y.days!==0)G.push(`${Y.days}d`);if(Y.hours!==0)G.push(`${Y.hours}h`);if(Y.minutes!==0)G.push(`${Y.minutes}m`);if(Y.seconds!==0)G.push(`${Y.seconds}s`);if(Y.millis!==0)G.push(`${Y.millis}ms`);if(Y.nanos!==0)G.push(`${Y.nanos}ns`);return G.join(" ")};var H4=5,y3=Math.pow(2,5),wz=y3-1,Fz=y3/2,_z=y3/4;function MT(X){return X-=X>>1&1431655765,X=(X&858993459)+(X>>2&858993459),X=X+(X>>4)&252645135,X+=X>>8,X+=X>>16,X&127}function K4(X,J){return J>>>X&wz}function B4(X){return 1<<X}function QZ(X,J){return MT(X&J-1)}var g3=(X,J)=>({value:X,previous:J});function K7(X,J,Y,G){let Z=G;if(!X){let $=G.length;Z=new Array($);for(let Q=0;Q<$;++Q)Z[Q]=G[Q]}return Z[J]=Y,Z}function b3(X,J,Y){let G=Y.length-1,Z=0,$=0,Q=Y;if(X)Z=$=J;else{Q=new Array(G);while(Z<J)Q[$++]=Y[Z++]}++Z;while(Z<=G)Q[$++]=Y[Z++];if(X)Q.length=G;return Q}function Mz(X,J,Y,G){let Z=G.length;if(X){let H=Z;while(H>=J)G[H--]=G[H];return G[J]=Y,G}let $=0,Q=0,K=new Array(Z+1);while($<J)K[Q++]=G[$++];K[J]=Y;while($<Z)K[++Q]=G[$++];return K}class A9{_tag="EmptyNode";modify(X,J,Y,G,Z,$){let Q=Y(q());if(H0(Q))return new A9;return++$.value,new B7(X,G,Z,Q)}}function j6(X){return Z9(X,"EmptyNode")}function RT(X){return j6(X)||X._tag==="LeafNode"||X._tag==="CollisionNode"}function HZ(X,J){return j6(X)?!1:J===X.edit}class B7{edit;hash;key;value;_tag="LeafNode";constructor(X,J,Y,G){this.edit=X,this.hash=J,this.key=Y,this.value=G}modify(X,J,Y,G,Z,$){if(w(Z,this.key)){let K=Y(this.value);if(K===this.value)return this;else if(H0(K))return--$.value,new A9;if(HZ(this,X))return this.value=K,this;return new B7(X,G,Z,K)}let Q=Y(q());if(H0(Q))return this;return++$.value,Rz(X,J,this.hash,this,G,new B7(X,G,Z,Q))}}class h3{edit;hash;children;_tag="CollisionNode";constructor(X,J,Y){this.edit=X,this.hash=J,this.children=Y}modify(X,J,Y,G,Z,$){if(G===this.hash){let K=HZ(this,X),H=this.updateCollisionList(K,X,this.hash,this.children,Y,Z,$);if(H===this.children)return this;return H.length>1?new h3(X,this.hash,H):H[0]}let Q=Y(q());if(H0(Q))return this;return++$.value,Rz(X,J,this.hash,this,G,new B7(X,G,Z,Q))}updateCollisionList(X,J,Y,G,Z,$,Q){let K=G.length;for(let V=0;V<K;++V){let W=G[V];if("key"in W&&w($,W.key)){let U=W.value,L=Z(U);if(L===U)return G;if(H0(L))return--Q.value,b3(X,V,G);return K7(X,V,new B7(J,Y,$,L),G)}}let H=Z(q());if(H0(H))return G;return++Q.value,K7(X,K,new B7(J,Y,$,H),G)}}class EX{edit;mask;children;_tag="IndexedNode";constructor(X,J,Y){this.edit=X,this.mask=J,this.children=Y}modify(X,J,Y,G,Z,$){let Q=this.mask,K=this.children,H=K4(J,G),V=B4(H),W=QZ(Q,V),U=Q&V,L=HZ(this,X);if(!U){let m=new A9().modify(X,J+H4,Y,G,Z,$);if(!m)return this;return K.length>=Fz?TT(X,H,m,Q,K):new EX(X,Q|V,Mz(L,W,m,K))}let _=K[W],z=_.modify(X,J+H4,Y,G,Z,$);if(_===z)return this;let R=Q,j;if(j6(z)){if(R&=~V,!R)return new A9;if(K.length<=2&&RT(K[W^1]))return K[W^1];j=b3(L,W,K)}else j=K7(L,W,z,K);if(L)return this.mask=R,this.children=j,this;return new EX(X,R,j)}}class m3{edit;size;children;_tag="ArrayNode";constructor(X,J,Y){this.edit=X,this.size=J,this.children=Y}modify(X,J,Y,G,Z,$){let Q=this.size,K=this.children,H=K4(J,G),V=K[H],W=(V||new A9).modify(X,J+H4,Y,G,Z,$);if(V===W)return this;let U=HZ(this,X),L;if(j6(V)&&!j6(W))++Q,L=K7(U,H,W,K);else if(!j6(V)&&j6(W)){if(--Q,Q<=_z)return CT(X,Q,H,K);L=K7(U,H,new A9,K)}else L=K7(U,H,W,K);if(U)return this.size=Q,this.children=L,this;return new m3(X,Q,L)}}function CT(X,J,Y,G){let Z=new Array(J-1),$=0,Q=0;for(let K=0,H=G.length;K<H;++K)if(K!==Y){let V=G[K];if(V&&!j6(V))Z[$++]=V,Q|=1<<K}return new EX(X,Q,Z)}function TT(X,J,Y,G,Z){let $=[],Q=G,K=0;for(let H=0;Q;++H){if(Q&1)$[H]=Z[K++];Q>>>=1}return $[J]=Y,new m3(X,K+1,$)}function ET(X,J,Y,G,Z,$){if(Y===Z)return new h3(X,Y,[$,G]);let Q=K4(J,Y),K=K4(J,Z);if(Q===K)return(H)=>new EX(X,B4(Q)|B4(K),[H]);else{let H=Q<K?[G,$]:[$,G];return new EX(X,B4(Q)|B4(K),H)}}function Rz(X,J,Y,G,Z,$){let Q=void 0,K=J;while(!0){let H=ET(X,K,Y,G,Z,$);if(typeof H==="function")Q=g3(H,Q),K=K+H4;else{let V=H;while(Q!=null)V=Q.value(V),Q=Q.previous;return V}}}var Cz="effect/HashMap",KZ=Symbol.for(Cz),jT={[KZ]:KZ,[Symbol.iterator](){return new VZ(this,(X,J)=>[X,J])},[M](){let X=O(Cz);for(let J of this)X^=N(O(J[0]),C(O(J[1])));return S(this,X)},[P](X){if(jz(X)){if(X._size!==this._size)return!1;for(let J of this){let Y=N(X,NZ(J[0],O(J[0])));if(H0(Y))return!1;else if(!w(J[1],Y.value))return!1}return!0}return!1},toString(){return d(this.toJSON())},toJSON(){return{_id:"HashMap",values:Array.from(this).map(r)}},[v](){return this.toJSON()},pipe(){return D(this,arguments)}},d3=(X,J,Y,G)=>{let Z=Object.create(jT);return Z._editable=X,Z._edit=J,Z._root=Y,Z._size=G,Z};class VZ{map;f;v;constructor(X,J){this.map=X,this.f=J,this.v=Tz(this.map._root,this.f,void 0)}next(){if(H0(this.v))return{done:!0,value:void 0};let X=this.v.value;return this.v=BZ(X.cont),{done:!1,value:X.value}}[Symbol.iterator](){return new VZ(this.map,this.f)}}var BZ=(X)=>X?Ez(X[0],X[1],X[2],X[3],X[4]):q(),Tz=(X,J,Y=void 0)=>{switch(X._tag){case"LeafNode":{if(c(X.value))return F({value:J(X.key,X.value.value),cont:Y});return BZ(Y)}case"CollisionNode":case"ArrayNode":case"IndexedNode":{let G=X.children;return Ez(G.length,G,0,J,Y)}default:return BZ(Y)}},Ez=(X,J,Y,G,Z)=>{while(Y<X){let $=J[Y++];if($&&!j6($))return Tz($,G,[X,J,Y,G,Z])}return BZ(Z)},ST=d3(!1,0,new A9,0),IX=()=>ST;var Iz=(X)=>{let J=UZ(IX());for(let Y of X)V7(J,Y[0],Y[1]);return xz(J)},jz=(X)=>A(X,KZ),Sz=(X)=>X&&j6(X._root),vz=B(2,(X,J)=>NZ(X,J,O(J))),NZ=B(3,(X,J,Y)=>{let G=X._root,Z=0;while(!0)switch(G._tag){case"LeafNode":return w(J,G.key)?G.value:q();case"CollisionNode":{if(Y===G.hash){let $=G.children;for(let Q=0,K=$.length;Q<K;++Q){let H=$[Q];if("key"in H&&w(J,H.key))return H.value}}return q()}case"IndexedNode":{let $=K4(Z,Y),Q=B4($);if(G.mask&Q){G=G.children[QZ(G.mask,Q)],Z+=H4;break}return q()}case"ArrayNode":{if(G=G.children[K4(Z,Y)],G){Z+=H4;break}return q()}default:return q()}});var c3=B(2,(X,J)=>c(NZ(X,J,O(J))));var V7=B(3,(X,J,Y)=>DZ(X,J,()=>F(Y))),vT=B(3,(X,J,Y)=>{if(X._editable)return X._root=J,X._size=Y,X;return J===X._root?X:d3(X._editable,X._edit,J,Y)}),WZ=(X)=>new VZ(X,(J)=>J);var AJ=(X)=>X._size,UZ=(X)=>d3(!0,X._edit+1,X._root,X._size),xz=(X)=>{return X._editable=!1,X};var DZ=B(3,(X,J,Y)=>kz(X,J,O(J),Y)),kz=B(4,(X,J,Y,G)=>{let Z={value:X._size},$=X._root.modify(X._editable?X._edit:NaN,0,G,Y,J,Z);return N(X,vT($,Z.value))});var zZ=B(2,(X,J)=>DZ(X,J,q));var yz=B(2,(X,J)=>jX(X,IX(),(Y,G,Z)=>V7(Y,Z,J(G,Z))));var p3=B(2,(X,J)=>jX(X,void 0,(Y,G,Z)=>J(G,Z))),jX=B(3,(X,J,Y)=>{let G=X._root;if(G._tag==="LeafNode")return c(G.value)?Y(J,G.value.value,G.key):J;if(G._tag==="EmptyNode")return J;let Z=[G.children],$;while($=Z.pop())for(let Q=0,K=$.length;Q<K;){let H=$[Q++];if(H&&!j6(H))if(H._tag==="LeafNode"){if(c(H.value))J=Y(J,H.value.value,H.key)}else Z.push(H.children)}return J});var bz="effect/HashSet",AZ=Symbol.for(bz),xT={[AZ]:AZ,[Symbol.iterator](){return WZ(this._keyMap)},[M](){return S(this,C(O(this._keyMap))(O(bz)))},[P](X){if(hz(X))return AJ(this._keyMap)===AJ(X._keyMap)&&w(this._keyMap,X._keyMap);return!1},toString(){return d(this.toJSON())},toJSON(){return{_id:"HashSet",values:Array.from(this).map(r)}},[v](){return this.toJSON()},pipe(){return D(this,arguments)}},OJ=(X)=>{let J=Object.create(xT);return J._keyMap=X,J},hz=(X)=>A(X,AZ),kT=OJ(IX()),qJ=()=>kT,mz=(X)=>{let J=OZ(qJ());for(let Y of X)SX(J,Y);return qZ(J)},dz=(...X)=>{let J=OZ(qJ());for(let Y of X)SX(J,Y);return qZ(J)},cz=B(2,(X,J)=>c3(X._keyMap,J));var pz=(X)=>AJ(X._keyMap),OZ=(X)=>OJ(UZ(X._keyMap)),qZ=(X)=>{return X._keyMap._editable=!1,X},f3=B(2,(X,J)=>{let Y=OZ(X);return J(Y),qZ(Y)}),SX=B(2,(X,J)=>X._keyMap._editable?(V7(J,!0)(X._keyMap),X):OJ(V7(J,!0)(X._keyMap))),u3=B(2,(X,J)=>X._keyMap._editable?(zZ(J)(X._keyMap),X):OJ(zZ(J)(X._keyMap))),fz=B(2,(X,J)=>f3(X,(Y)=>{for(let G of J)u3(Y,G)}));var uz=B(2,(X,J)=>f3(qJ(),(Y)=>{o3(X,(G)=>SX(Y,G));for(let G of J)SX(Y,G)}));var o3=B(2,(X,J)=>p3(X._keyMap,(Y,G)=>J(G))),oz=B(3,(X,J,Y)=>jX(X._keyMap,J,(G,Z,$)=>Y(G,$)));var r8=qJ,vX=mz,N7=dz,W7=cz;var U7=pz;var H5=SX,xX=u3,n3=fz;var b5=uz;var nz=o3,D7=oz;var lz=Symbol.for("effect/MutableRef"),gT={[lz]:lz,toString(){return d(this.toJSON())},toJSON(){return{_id:"MutableRef",current:r(this.current)}},[v](){return this.toJSON()},pipe(){return D(this,arguments)}},K5=(X)=>{let J=Object.create(gT);return J.current=X,J};var S6=(X)=>X.current;var h5=B(2,(X,J)=>{return X.current=J,X});var r3="effect/FiberId",kX=Symbol.for(r3),LZ="None",l3="Runtime",bT="Composite",hT=D0(`${r3}-${LZ}`);class iz{[kX]=kX;_tag=LZ;id=-1;startTimeMillis=-1;[M](){return hT}[P](X){return i3(X)&&X._tag===LZ}toString(){return d(this.toJSON())}toJSON(){return{_id:"FiberId",_tag:this._tag}}[v](){return this.toJSON()}}class az{id;startTimeMillis;[kX]=kX;_tag=l3;constructor(X,J){this.id=X,this.startTimeMillis=J}[M](){return S(this,D0(`${r3}-${this._tag}-${this.id}-${this.startTimeMillis}`))}[P](X){return i3(X)&&X._tag===l3&&this.id===X.id&&this.startTimeMillis===X.startTimeMillis}toString(){return d(this.toJSON())}toJSON(){return{_id:"FiberId",_tag:this._tag,id:this.id,startTimeMillis:this.startTimeMillis}}[v](){return this.toJSON()}}var FZ=new iz;var i3=(X)=>A(X,kX);var wZ=(X)=>{switch(X._tag){case LZ:return r8();case l3:return N7(X.id);case bT:return N(wZ(X.left),b5(wZ(X.right)))}},rz=h(Symbol.for("effect/Fiber/Id/_fiberCounter"),()=>K5(0));var _Z=(X)=>{return Array.from(wZ(X)).map((Y)=>`#${Y}`).join(",")};var sz=()=>{let X=S6(rz);return N(rz,h5(X+1)),new az(X,Date.now())};var h8=FZ;var s3=_Z;var PZ=sz;var W6=IX;var t3=Iz,e3=Sz,z7=vz;var U6=V7,XH=WZ;var tz=DZ;var ez=yz;var MZ=jX;var LJ=Symbol.for("effect/List"),JH=(X)=>p(X),cT=(X)=>P2(Y4(X),JH),pT=cT(w),fT={[LJ]:LJ,_tag:"Cons",toString(){return d(this.toJSON())},toJSON(){return{_id:"List",_tag:"Cons",values:JH(this).map(r)}},[v](){return this.toJSON()},[P](X){return YH(X)&&this._tag===X._tag&&pT(this,X)},[M](){return S(this,J8(JH(this)))},[Symbol.iterator](){let X=!1,J=this;return{next(){if(X)return this.return();if(J._tag==="Nil")return X=!0,this.return();let Y=J.head;return J=J.tail,{done:X,value:Y}},return(Y){if(!X)X=!0;return{done:!0,value:Y}}}},pipe(){return D(this,arguments)}},RZ=(X,J)=>{let Y=Object.create(fT);return Y.head=X,Y.tail=J,Y},uT=D0("Nil"),oT={[LJ]:LJ,_tag:"Nil",toString(){return d(this.toJSON())},toJSON(){return{_id:"List",_tag:"Nil"}},[v](){return this.toJSON()},[M](){return uT},[P](X){return YH(X)&&this._tag===X._tag},[Symbol.iterator](){return{next(){return{done:!0,value:void 0}}}},pipe(){return D(this,arguments)}},XA=Object.create(oT),YH=(X)=>A(X,LJ),m5=(X)=>X._tag==="Nil",CZ=(X)=>X._tag==="Cons";var nT=()=>XA,O9=(X,J)=>RZ(X,J),d5=nT,wJ=(X)=>RZ(X,XA);var JA=B(2,(X,J)=>lT(J,X)),YA=B(2,(X,J)=>O9(J,X)),lT=B(2,(X,J)=>{if(m5(X))return J;else if(m5(J))return X;else{let Y=RZ(J.head,X),G=Y,Z=J.tail;while(!m5(Z)){let $=RZ(Z.head,X);G.tail=$,G=$,Z=Z.tail}return Y}});var GA=B(3,(X,J,Y)=>{let G=J,Z=X;while(!m5(Z))G=Y(G,Z.head),Z=Z.tail;return G});var ZA=(X)=>{let J=d5(),Y=X;while(!m5(Y))J=YA(J,Y.head),Y=Y.tail;return J};var rT=Object.assign(Object.create(Array.prototype),{[M](){return S(this,J8(this))},[P](X){if(Array.isArray(X)&&this.length===X.length)return this.every((J,Y)=>w(J,X[Y]));else return!1}}),D6=function(){function X(J){if(J)Object.assign(this,J)}return X.prototype=s4,X}();var QA=Symbol.for("effect/DifferChunkPatch");function $A(X){return X}var Bn={...D6.prototype,[QA]:{_Value:$A,_Patch:$A}};var BA=Symbol.for("effect/DifferContextPatch");function KA(X){return X}var _J={...D6.prototype,[BA]:{_Value:KA,_Patch:KA}},iT=Object.assign(Object.create(_J),{_tag:"Empty"}),aT=Object.create(iT),GH=()=>aT,sT=Object.assign(Object.create(_J),{_tag:"AndThen"}),tT=(X,J)=>{let Y=Object.create(sT);return Y.first=X,Y.second=J,Y},eT=Object.assign(Object.create(_J),{_tag:"AddService"}),XE=(X,J)=>{let Y=Object.create(eT);return Y.key=X,Y.service=J,Y},JE=Object.assign(Object.create(_J),{_tag:"RemoveService"}),YE=(X)=>{let J=Object.create(JE);return J.key=X,J},GE=Object.assign(Object.create(_J),{_tag:"UpdateService"}),ZE=(X,J)=>{let Y=Object.create(GE);return Y.key=X,Y.update=J,Y},VA=(X,J)=>{let Y=new Map(X.unsafeMap),G=GH();for(let[Z,$]of J.unsafeMap.entries())if(Y.has(Z)){let Q=Y.get(Z);if(Y.delete(Z),!w(Q,$))G=FJ(ZE(Z,()=>$))(G)}else Y.delete(Z),G=FJ(XE(Z,$))(G);for(let[Z]of Y.entries())G=FJ(YE(Z))(G);return G},FJ=B(2,(X,J)=>tT(X,J)),NA=B(2,(X,J)=>{if(X._tag==="Empty")return J;let Y=!1,G=z0(X),Z=new Map(J.unsafeMap);while(y0(G)){let Q=Y8(G),K=G8(G);switch(Q._tag){case"Empty":{G=K;break}case"AddService":{Z.set(Q.key,Q.service),G=K;break}case"AndThen":{G=R0(R0(K,Q.second),Q.first);break}case"RemoveService":{Z.delete(Q.key),G=K;break}case"UpdateService":{Z.set(Q.key,Q.update(Z.get(Q.key))),Y=!0,G=K;break}}}if(!Y)return $4(Z);let $=new Map;for(let[Q]of J.unsafeMap)if(Z.has(Q))$.set(Q,Z.get(Q)),Z.delete(Q);for(let[Q,K]of Z)$.set(Q,K);return $4($)});var DA=Symbol.for("effect/DifferHashMapPatch");function ZH(X){return X}var Un={...D6.prototype,[DA]:{_Value:ZH,_Key:ZH,_Patch:ZH}};var AA=Symbol.for("effect/DifferHashSetPatch");function $H(X){return X}var IZ={...D6.prototype,[AA]:{_Value:$H,_Key:$H,_Patch:$H}},$E=Object.assign(Object.create(IZ),{_tag:"Empty"}),QE=Object.create($E),QH=()=>QE,HE=Object.assign(Object.create(IZ),{_tag:"AndThen"}),KE=(X,J)=>{let Y=Object.create(HE);return Y.first=X,Y.second=J,Y},BE=Object.assign(Object.create(IZ),{_tag:"Add"}),VE=(X)=>{let J=Object.create(BE);return J.value=X,J},NE=Object.assign(Object.create(IZ),{_tag:"Remove"}),WE=(X)=>{let J=Object.create(NE);return J.value=X,J},OA=(X,J)=>{let[Y,G]=D7([X,QH()],([Z,$],Q)=>{if(W7(Q)(Z))return[xX(Q)(Z),$];return[Z,EZ(VE(Q))($)]})(J);return D7(G,(Z,$)=>EZ(WE($))(Z))(Y)},EZ=B(2,(X,J)=>KE(X,J)),qA=B(2,(X,J)=>{if(X._tag==="Empty")return J;let Y=J,G=z0(X);while(y0(G)){let Z=Y8(G),$=G8(G);switch(Z._tag){case"Empty":{G=$;break}case"AndThen":{G=R0(Z.first)(R0(Z.second)($));break}case"Add":{Y=H5(Z.value)(Y),G=$;break}case"Remove":Y=xX(Z.value)(Y),G=$}}return Y});var wA=Symbol.for("effect/DifferOrPatch");function HH(X){return X}var An={...D6.prototype,[wA]:{_Value:HH,_Key:HH,_Patch:HH}};var PA=Symbol.for("effect/DifferReadonlyArrayPatch");function _A(X){return X}var MJ={...D6.prototype,[PA]:{_Value:_A,_Patch:_A}},UE=Object.assign(Object.create(MJ),{_tag:"Empty"}),DE=Object.create(UE),KH=()=>DE,zE=Object.assign(Object.create(MJ),{_tag:"AndThen"}),AE=(X,J)=>{let Y=Object.create(zE);return Y.first=X,Y.second=J,Y},OE=Object.assign(Object.create(MJ),{_tag:"Append"}),qE=(X)=>{let J=Object.create(OE);return J.values=X,J},LE=Object.assign(Object.create(MJ),{_tag:"Slice"}),wE=(X,J)=>{let Y=Object.create(LE);return Y.from=X,Y.until=J,Y},FE=Object.assign(Object.create(MJ),{_tag:"Update"}),_E=(X,J)=>{let Y=Object.create(FE);return Y.index=X,Y.patch=J,Y},MA=(X)=>{let J=0,Y=KH();while(J<X.oldValue.length&&J<X.newValue.length){let G=X.oldValue[J],Z=X.newValue[J],$=X.differ.diff(G,Z);if(!w($,X.differ.empty))Y=PJ(Y,_E(J,$));J=J+1}if(J<X.oldValue.length)Y=PJ(Y,wE(0,J));if(J<X.newValue.length)Y=PJ(Y,qE(gU(J)(X.newValue)));return Y},PJ=B(2,(X,J)=>AE(X,J)),RA=B(3,(X,J,Y)=>{if(X._tag==="Empty")return J;let G=J.slice(),Z=E8(X);while(a6(Z)){let $=F8(Z),Q=s6(Z);switch($._tag){case"Empty":{Z=Q;break}case"AndThen":{Q.unshift($.first,$.second),Z=Q;break}case"Append":{for(let K of $.values)G.push(K);Z=Q;break}case"Slice":{G=G.slice($.from,$.until),Z=Q;break}case"Update":{G[$.index]=Y.patch($.patch,G[$.index]),Z=Q;break}}}return G});var TA=Symbol.for("effect/Differ"),PE={[TA]:{_P:x,_V:x}},N4=(X)=>{let J=Object.create(PE);return J.empty=X.empty,J.diff=X.diff,J.combine=X.combine,J.patch=X.patch,J},BH=()=>N4({empty:GH(),combine:(X,J)=>FJ(J)(X),diff:(X,J)=>VA(X,J),patch:(X,J)=>NA(J)(X)});var VH=()=>N4({empty:QH(),combine:(X,J)=>EZ(J)(X),diff:(X,J)=>OA(X,J),patch:(X,J)=>qA(J)(X)});var NH=(X)=>N4({empty:KH(),combine:(J,Y)=>PJ(J,Y),diff:(J,Y)=>MA({oldValue:J,newValue:Y,differ:X}),patch:(J,Y)=>RA(J,Y,X)});var jZ=()=>EA((X,J)=>J),EA=(X)=>N4({empty:x,combine:(J,Y)=>{if(J===x)return Y;if(Y===x)return J;return(G)=>Y(J(G))},diff:(J,Y)=>{if(w(J,Y))return x;return d1(Y)},patch:(J,Y)=>X(Y,J(Y))});var RJ=255,IA=8,SZ=(X)=>X&RJ,vZ=(X)=>X>>IA&RJ,A7=(X,J)=>(X&RJ)+((J&X&RJ)<<IA),UH=A7(0,0),DH=(X)=>A7(X,X),zH=(X)=>A7(X,0);var jA=B(2,(X,J)=>A7(SZ(X)&~J,vZ(X)));var AH=B(2,(X,J)=>X|J);var SA=(X)=>~X>>>0&RJ;var vA=0,B5=1,xZ=2,CJ=4,yX=16,TJ=32;var qH=(X)=>EJ(X,TJ);var kZ=B(2,(X,J)=>X|J);var V5=(X)=>yZ(X)&&!xA(X),yZ=(X)=>EJ(X,B5);var EJ=B(2,(X,J)=>(X&J)!==0),gZ=(...X)=>X.reduce((J,Y)=>J|Y,0),LH=gZ(vA);var bZ=(X)=>EJ(X,CJ);var xA=(X)=>EJ(X,yX);var W4=B(2,(X,J)=>A7(X^J,J)),O7=B(2,(X,J)=>X&(SA(SZ(J))|vZ(J))|SZ(J)&vZ(J));var hZ=N4({empty:UH,diff:(X,J)=>W4(X,J),combine:(X,J)=>AH(J)(X),patch:(X,J)=>O7(J,X)});var kA=DH,wH=zH;var FH=jA;var IJ=(X,J)=>({_tag:"Par",left:X,right:J}),gX=(X,J)=>({_tag:"Seq",left:X,right:J});var yA=(X)=>{let J=wJ(X),Y=d5();while(!0){let[G,Z]=GA(J,[gA(),d5()],([$,Q],K)=>{let[H,V]=RE(K);return[jE($,H),JA(Q,V)]});if(Y=CE(Y,G),m5(Z))return ZA(Y);J=Z}throw new Error("BUG: BlockedRequests.flatten - please report an issue at https://github.com/Effect-TS/effect/issues")},RE=(X)=>{let J=X,Y=gA(),G=d5(),Z=d5();while(!0)switch(J._tag){case"Empty":{if(m5(G))return[Y,Z];J=G.head,G=G.tail;break}case"Par":{G=O9(J.right,G),J=J.left;break}case"Seq":{let{left:$,right:Q}=J;switch($._tag){case"Empty":{J=Q;break}case"Par":{let{left:K,right:H}=$;J=IJ(gX(K,Q),gX(H,Q));break}case"Seq":{let{left:K,right:H}=$;J=gX(K,gX(H,Q));break}case"Single":{J=$,Z=O9(Q,Z);break}}break}case"Single":{if(Y=IE(Y,J),m5(G))return[Y,Z];J=G.head,G=G.tail;break}}throw new Error("BUG: BlockedRequests.step - please report an issue at https://github.com/Effect-TS/effect/issues")},CE=(X,J)=>{if(m5(X))return wJ(PH(J));if(SE(J))return X;let Y=bE(X.head),G=vE(J);if(Y.length===1&&G.length===1&&w(Y[0],G[0]))return O9(gE(X.head,PH(J)),X.tail);return O9(PH(J),X)};var TE=Symbol.for("effect/RequestBlock/RequestBlockParallel"),EE={_R:(X)=>X};class mZ{map;[TE]=EE;constructor(X){this.map=X}}var gA=()=>new mZ(W6());var IE=(X,J)=>new mZ(tz(X.map,J.dataSource,(Y)=>TU(g0(Y,$5(J.blockedRequest)),()=>z0(J.blockedRequest)))),jE=(X,J)=>new mZ(MZ(X.map,J.map,(Y,G,Z)=>U6(Y,Z,$0(z7(Y,Z),{onNone:()=>G,onSome:($)=>o0(G,$)})))),SE=(X)=>e3(X.map),vE=(X)=>Array.from(XH(X.map)),PH=(X)=>yE(ez(X.map,(J)=>z0(J))),xE=Symbol.for("effect/RequestBlock/RequestBlockSequential"),kE={_R:(X)=>X};class MH{map;[xE]=kE;constructor(X){this.map=X}}var yE=(X)=>new MH(X),gE=(X,J)=>new MH(MZ(J.map,X.map,(Y,G,Z)=>U6(Y,Z,$0(z7(Y,Z),{onNone:()=>L0(),onSome:($)=>o0($,G)}))));var bE=(X)=>Array.from(XH(X.map)),bA=(X)=>Array.from(X.map);var bX="Die",U4="Empty",q7="Fail",L7="Interrupt",w7="Parallel",F7="Sequential";var cA="effect/Cause",CH=Symbol.for(cA),mE={_E:(X)=>X},hX={[CH]:mE,[M](){return N(O(cA),C(O(cE(this))),S(this))},[P](X){return TH(X)&&dE(this,X)},pipe(){return D(this,arguments)},toJSON(){switch(this._tag){case"Empty":return{_id:"Cause",_tag:this._tag};case"Die":return{_id:"Cause",_tag:this._tag,defect:r(this.defect)};case"Interrupt":return{_id:"Cause",_tag:this._tag,fiberId:this.fiberId.toJSON()};case"Fail":return{_id:"Cause",_tag:this._tag,failure:r(this.error)};case"Sequential":case"Parallel":return{_id:"Cause",_tag:this._tag,left:r(this.left),right:r(this.right)}}},toString(){return z4(this)},[v](){return this.toJSON()}},D4=(()=>{let X=Object.create(hX);return X._tag=U4,X})(),P7=(X)=>{let J=Object.create(hX);return J._tag=q7,J.error=X,J},j8=(X)=>{let J=Object.create(hX);return J._tag=bX,J.defect=X,J},z6=(X)=>{let J=Object.create(hX);return J._tag=L7,J.fiberId=X,J},L9=(X,J)=>{let Y=Object.create(hX);return Y._tag=w7,Y.left=X,Y.right=J,Y},V8=(X,J)=>{let Y=Object.create(hX);return Y._tag=F7,Y.left=X,Y.right=J,Y},TH=(X)=>A(X,CH),EH=(X)=>X._tag===U4;var cZ=(X)=>{if(X._tag===U4)return!0;return _7(X,!0,(J,Y)=>{switch(Y._tag){case U4:return F(J);case bX:case q7:case L7:return F(!1);default:return q()}})};var pZ=(X)=>c(pA(X)),mX=(X)=>lZ(void 0,fE)(X),fZ=(X)=>Z5(_7(X,L0(),(J,Y)=>Y._tag===q7?F(N(J,R0(Y.error))):q())),SJ=(X)=>Z5(_7(X,L0(),(J,Y)=>Y._tag===bX?F(N(J,R0(Y.defect))):q())),uZ=(X)=>_7(X,r8(),(J,Y)=>Y._tag===L7?F(N(J,H5(Y.fiberId))):q()),IH=(X)=>xJ(X,(J)=>J._tag===q7?F(J.error):q()),vJ=(X)=>{let J=IH(X);switch(J._tag){case"None":return u(X);case"Some":return k(J.value)}};var pA=(X)=>xJ(X,(J)=>J._tag===L7?F(J.fiberId):q());var fA=(X)=>nZ(X,{onEmpty:q(),onFail:(J)=>F(j8(J)),onDie:(J)=>F(j8(J)),onInterrupt:()=>q(),onSequential:(J,Y)=>{if(c(J)&&c(Y))return F(V8(J.value,Y.value));if(c(J)&&H0(Y))return F(J.value);if(H0(J)&&c(Y))return F(Y.value);return q()},onParallel:(J,Y)=>{if(c(J)&&c(Y))return F(L9(J.value,Y.value));if(c(J)&&H0(Y))return F(J.value);if(H0(J)&&c(Y))return F(Y.value);return q()}});var oZ=(X)=>nZ(X,{onEmpty:D4,onFail:()=>D4,onDie:(J)=>j8(J),onInterrupt:(J)=>z6(J),onSequential:V8,onParallel:L9}),uA=(X)=>nZ(X,{onEmpty:D4,onFail:(J)=>j8(J),onDie:(J)=>j8(J),onInterrupt:(J)=>z6(J),onSequential:(J,Y)=>V8(J,Y),onParallel:(J,Y)=>L9(J,Y)});var dE=(X,J)=>{let Y=z0(X),G=z0(J);while(y0(Y)&&y0(G)){let[Z,$]=N(Y8(Y),_7([r8(),L0()],([H,V],W)=>{let[U,L]=RH(W);return F([N(H,b5(U)),N(V,o0(L))])})),[Q,K]=N(Y8(G),_7([r8(),L0()],([H,V],W)=>{let[U,L]=RH(W);return F([N(H,b5(U)),N(V,o0(L))])}));if(!w(Z,Q))return!1;Y=$,G=K}return!0},cE=(X)=>{return pE(z0(X),L0())},pE=(X,J)=>{while(!0){let[Y,G]=N(X,j5([r8(),L0()],([$,Q],K)=>{let[H,V]=RH(K);return[N($,b5(H)),N(Q,o0(V))]})),Z=U7(Y)>0?N(J,R0(Y)):J;if(D9(G))return Z5(Z);X=G,J=Z}throw new Error($9("Cause.flattenCauseLoop"))},xJ=B(2,(X,J)=>{let Y=[X];while(Y.length>0){let G=Y.pop(),Z=J(G);switch(Z._tag){case"None":{switch(G._tag){case F7:case w7:{Y.push(G.right),Y.push(G.left);break}}break}case"Some":return Z}}return q()});var RH=(X)=>{let J=X,Y=[],G=r8(),Z=L0();while(J!==void 0)switch(J._tag){case U4:{if(Y.length===0)return[G,Z];J=Y.pop();break}case q7:{if(G=H5(G,H7(J._tag,J.error)),Y.length===0)return[G,Z];J=Y.pop();break}case bX:{if(G=H5(G,H7(J._tag,J.defect)),Y.length===0)return[G,Z];J=Y.pop();break}case L7:{if(G=H5(G,H7(J._tag,J.fiberId)),Y.length===0)return[G,Z];J=Y.pop();break}case F7:{switch(J.left._tag){case U4:{J=J.right;break}case F7:{J=V8(J.left.left,V8(J.left.right,J.right));break}case w7:{J=L9(V8(J.left.left,J.right),V8(J.left.right,J.right));break}default:{Z=R0(Z,J.right),J=J.left;break}}break}case w7:{Y.push(J.right),J=J.left;break}}throw new Error($9("Cause.evaluateCauseLoop"))};var fE={emptyCase:n6,failCase:K6,dieCase:K6,interruptCase:n6,sequentialCase:(X,J,Y)=>J&&Y,parallelCase:(X,J,Y)=>J&&Y};var hA="SequentialCase",mA="ParallelCase",nZ=B(2,(X,{onDie:J,onEmpty:Y,onFail:G,onInterrupt:Z,onParallel:$,onSequential:Q})=>{return lZ(X,void 0,{emptyCase:()=>Y,failCase:(K,H)=>G(H),dieCase:(K,H)=>J(H),interruptCase:(K,H)=>Z(H),sequentialCase:(K,H,V)=>Q(H,V),parallelCase:(K,H,V)=>$(H,V)})}),_7=B(3,(X,J,Y)=>{let G=J,Z=X,$=[];while(Z!==void 0){let Q=Y(G,Z);switch(G=c(Q)?Q.value:G,Z._tag){case F7:{$.push(Z.right),Z=Z.left;break}case w7:{$.push(Z.right),Z=Z.left;break}default:{Z=void 0;break}}if(Z===void 0&&$.length>0)Z=$.pop()}return G}),lZ=B(3,(X,J,Y)=>{let G=[X],Z=[];while(G.length>0){let Q=G.pop();switch(Q._tag){case U4:{Z.push(u(Y.emptyCase(J)));break}case q7:{Z.push(u(Y.failCase(J,Q.error)));break}case bX:{Z.push(u(Y.dieCase(J,Q.defect)));break}case L7:{Z.push(u(Y.interruptCase(J,Q.fiberId)));break}case F7:{G.push(Q.right),G.push(Q.left),Z.push(k({_tag:hA}));break}case w7:{G.push(Q.right),G.push(Q.left),Z.push(k({_tag:mA}));break}}}let $=[];while(Z.length>0){let Q=Z.pop();switch(Q._tag){case"Left":{switch(Q.left._tag){case hA:{let K=$.pop(),H=$.pop(),V=Y.sequentialCase(J,K,H);$.push(V);break}case mA:{let K=$.pop(),H=$.pop(),V=Y.parallelCase(J,K,H);$.push(V);break}}break}case"Right":{$.push(Q.right);break}}}if($.length===0)throw new Error("BUG: Cause.reduceWithContext - please report an issue at https://github.com/Effect-TS/effect/issues");return $.pop()}),z4=(X,J)=>{if(mX(X))return"All fibers interrupted without errors.";return rZ(X).map(function(Y){if(J?.renderErrorCause!==!0||Y.cause===void 0)return Y.stack;return`${Y.stack} {
${oA(Y.cause,"  ")}
}`}).join(`
`)},oA=(X,J)=>{let Y=X.stack.split(`
`),G=`${J}[cause]: ${Y[0]}`;for(let Z=1,$=Y.length;Z<$;Z++)G+=`
${J}${Y[Z]}`;if(X.cause)G+=` {
${oA(X.cause,`${J}  `)}
${J}}`;return G};class dZ extends globalThis.Error{span=void 0;constructor(X){let J=typeof X==="object"&&X!==null,Y=Error.stackTraceLimit;Error.stackTraceLimit=1;super(uE(X),J&&"cause"in X&&typeof X.cause!=="undefined"?{cause:new dZ(X.cause)}:void 0);if(this.message==="")this.message="An error has occurred";if(Error.stackTraceLimit=Y,this.name=X instanceof Error?X.name:"Error",J){if(dA in X)this.span=X[dA];Object.keys(X).forEach((G)=>{if(!(G in this))this[G]=X[G]})}this.stack=nE(`${this.name}: ${this.message}`,X instanceof Error&&X.stack?X.stack:"",this.span)}}var uE=(X)=>{if(typeof X==="string")return X;if(typeof X==="object"&&X!==null&&X instanceof Error)return X.message;try{if(A(X,"toString")&&M5(X.toString)&&X.toString!==Object.prototype.toString&&X.toString!==globalThis.Array.prototype.toString)return X.toString()}catch{}return OG(X)},oE=/\((.*)\)/g,nA=h("effect/Tracer/spanToTrace",()=>new WeakMap),nE=(X,J,Y)=>{let G=[X],Z=J.startsWith(X)?J.slice(X.length).split(`
`):J.split(`
`);for(let $=1;$<Z.length;$++){if(Z[$].includes("Generator.next"))break;if(Z[$].includes("effect_internal_function")){G.pop();break}G.push(Z[$].replace(/at .*effect_instruction_i.*\((.*)\)/,"at $1").replace(/EffectPrimitive\.\w+/,"<anonymous>"))}if(Y){let $=Y,Q=0;while($&&$._tag==="Span"&&Q<10){let K=nA.get($);if(typeof K==="function"){let H=K();if(typeof H==="string"){let V=H.matchAll(oE),W=!1;for(let[,U]of V)W=!0,G.push(`    at ${$.name} (${U})`);if(!W)G.push(`    at ${$.name} (${H.replace(/^at /,"")})`)}else G.push(`    at ${$.name}`)}else G.push(`    at ${$.name}`);$=T8($.parent),Q++}}return G.join(`
`)},dA=Symbol.for("effect/SpanAnnotation"),rZ=(X)=>lZ(X,void 0,{emptyCase:()=>[],dieCase:(J,Y)=>{return[new dZ(Y)]},failCase:(J,Y)=>{return[new dZ(Y)]},interruptCase:()=>[],parallelCase:(J,Y,G)=>[...Y,...G],sequentialCase:(J,Y,G)=>[...Y,...G]});var dX="Pending",iZ="Done";var lE="effect/Deferred",jH=Symbol.for(lE),rA={_E:(X)=>X,_A:(X)=>X},iA=(X)=>{return{_tag:dX,joiners:X}},aA=(X)=>{return{_tag:iZ,effect:X}};class A4{self;called=!1;constructor(X){this.self=X}next(X){return this.called?{value:X,done:!0}:(this.called=!0,{value:this.self,done:!1})}return(X){return{value:X,done:!0}}throw(X){throw X}[Symbol.iterator](){return new A4(this.self)}}var yJ=(X,J)=>{let Y=new N8("Blocked");return Y.effect_instruction_i0=X,Y.effect_instruction_i1=J,Y},mH=(X)=>{let J=new N8("RunBlocked");return J.effect_instruction_i0=X,J},w9=Symbol.for("effect/Effect");class dH{patch;op;_op=o1;constructor(X,J){this.patch=X,this.op=J}}class N8{_op;effect_instruction_i0=void 0;effect_instruction_i1=void 0;effect_instruction_i2=void 0;trace=void 0;[w9]=T5;constructor(X){this._op=X}[P](X){return this===X}[M](){return S(this,n4(this))}pipe(){return D(this,arguments)}toJSON(){return{_id:"Effect",_op:this._op,effect_instruction_i0:r(this.effect_instruction_i0),effect_instruction_i1:r(this.effect_instruction_i1),effect_instruction_i2:r(this.effect_instruction_i2)}}toString(){return d(this.toJSON())}[v](){return this.toJSON()}[Symbol.iterator](){return new A4(new r6(this))}}class cH{_op;effect_instruction_i0=void 0;effect_instruction_i1=void 0;effect_instruction_i2=void 0;trace=void 0;[w9]=T5;constructor(X){this._op=X,this._tag=X}[P](X){return cJ(X)&&X._op==="Failure"&&w(this.effect_instruction_i0,X.effect_instruction_i0)}[M](){return N(D0(this._tag),C(O(this.effect_instruction_i0)),S(this))}get cause(){return this.effect_instruction_i0}pipe(){return D(this,arguments)}toJSON(){return{_id:"Exit",_tag:this._op,cause:this.cause.toJSON()}}toString(){return d(this.toJSON())}[v](){return this.toJSON()}[Symbol.iterator](){return new A4(new r6(this))}}class pH{_op;effect_instruction_i0=void 0;effect_instruction_i1=void 0;effect_instruction_i2=void 0;trace=void 0;[w9]=T5;constructor(X){this._op=X,this._tag=X}[P](X){return cJ(X)&&X._op==="Success"&&w(this.effect_instruction_i0,X.effect_instruction_i0)}[M](){return N(D0(this._tag),C(O(this.effect_instruction_i0)),S(this))}get value(){return this.effect_instruction_i0}pipe(){return D(this,arguments)}toJSON(){return{_id:"Exit",_tag:this._op,value:r(this.value)}}toString(){return d(this.toJSON())}[v](){return this.toJSON()}[Symbol.iterator](){return new A4(new r6(this))}}var N5=(X)=>A(X,w9),A0=(X)=>{let J=new N8(LG);return J.effect_instruction_i0=X,J},cX=B(3,(X,J,Y)=>i0((G)=>T(X,(Z)=>T(P8(n(()=>G(J(Z)))),($)=>{return n(()=>Y(Z,$)).pipe(S8({onFailure:(Q)=>{switch($._tag){case y8:return k0(V8($.effect_instruction_i0,Q));case g8:return k0(Q)}},onSuccess:()=>$}))})))),n0=B(2,(X,J)=>T(X,()=>g(J))),W8=(X)=>n0(X,void 0),fH=function(){let X=new N8(K9);switch(arguments.length){case 2:{X.effect_instruction_i0=arguments[0],X.commit=arguments[1];break}case 3:{X.effect_instruction_i0=arguments[0],X.effect_instruction_i1=arguments[1],X.commit=arguments[2];break}case 4:{X.effect_instruction_i0=arguments[0],X.effect_instruction_i1=arguments[1],X.effect_instruction_i2=arguments[2],X.commit=arguments[3];break}default:throw new Error($9("you're not supposed to end up here"))}return X},gJ=(X,J=h8)=>{let Y=new N8(i4),G=void 0;return Y.effect_instruction_i0=(Z)=>{G=X(Z)},Y.effect_instruction_i1=J,U5(Y,(Z)=>N5(G)?G:l)},pX=(X,J=h8)=>n(()=>gJ(X,J)),W5=(X,J=h8)=>{return fH(X,function(){let Y=void 0,G=void 0;function Z(H){if(Y)Y(H);else if(G===void 0)G=H}let $=new N8(i4);$.effect_instruction_i0=(H)=>{if(Y=H,G)H(G)},$.effect_instruction_i1=J;let Q=void 0,K=void 0;if(this.effect_instruction_i0.length!==1)K=new AbortController,Q=M0(()=>this.effect_instruction_i0(Z,K.signal));else Q=M0(()=>this.effect_instruction_i0(Z));return Q||K?U5($,(H)=>{if(K)K.abort();return Q??l}):$})};var fX=B(2,(X,J)=>{let Y=new N8(BX);return Y.effect_instruction_i0=X,Y.effect_instruction_i1=J,Y}),O4=B(2,(X,J)=>F9(X,{onFailure:J,onSuccess:g}));var sZ=Symbol.for("effect/SpanAnnotation"),tA=Symbol.for("effect/OriginalAnnotation");var J$=(X,J)=>{if(c(J))return new Proxy(X,{has(Y,G){return G===sZ||G===tA||G in Y},get(Y,G){if(G===sZ)return J.value;if(G===tA)return X;return Y[G]}});return X},M7=(X)=>R5(X)&&!(sZ in X)?A0((J)=>k0(j8(J$(X,U$(J))))):k0(j8(X)),uX=(X)=>bJ(()=>j8(new WO(X)));var R7=(X)=>F9(X,{onFailure:(J)=>g(k(J)),onSuccess:(J)=>g(u(J))}),P8=(X)=>oH(X,{onFailure:_0,onSuccess:C0}),h0=(X)=>R5(X)&&!(sZ in X)?A0((J)=>k0(P7(J$(X,U$(J))))):k0(P7(X)),oX=(X)=>T(I(X),h0),k0=(X)=>{let J=new cH(y8);return J.effect_instruction_i0=X,J},bJ=(X)=>T(I(X),k0),q4=A0((X)=>g(X.id())),L4=(X)=>A0((J)=>X(J.id())),T=B(2,(X,J)=>{let Y=new N8(VX);return Y.effect_instruction_i0=X,Y.effect_instruction_i1=J,Y});var uH=(X)=>{let J=new N8("OnStep");return J.effect_instruction_i0=X,J},p5=(X)=>T(X,x);var oH=B(2,(X,J)=>S8(X,{onFailure:(Y)=>g(J.onFailure(Y)),onSuccess:(Y)=>g(J.onSuccess(Y))})),S8=B(2,(X,J)=>{let Y=new N8(NX);return Y.effect_instruction_i0=X,Y.effect_instruction_i1=J.onFailure,Y.effect_instruction_i2=J.onSuccess,Y}),F9=B(2,(X,J)=>S8(X,{onFailure:(Y)=>{if(SJ(Y).length>0)return k0(uA(Y));let Z=fZ(Y);if(Z.length>0)return J.onFailure(zJ(Z));return k0(Y)},onSuccess:J.onSuccess})),M8=B(2,(X,J)=>n(()=>{let Y=p(X),G=X7(Y.length),Z=0;return n0(hJ({while:()=>Z<Y.length,body:()=>J(Y[Z],Z),step:($)=>{G[Z++]=$}}),G)})),i8=B(2,(X,J)=>n(()=>{let Y=p(X),G=0;return hJ({while:()=>G<Y.length,body:()=>J(Y[G],G),step:()=>{G++}})}));var f5=T(q4,(X)=>JO(X)),JO=(X)=>k0(z6(X)),k6=(X)=>{let J=new N8(a4);return J.effect_instruction_i0=kA(B5),J.effect_instruction_i1=()=>X,J};var o=B(2,(X,J)=>T(X,(Y)=>I(()=>J(Y)))),Y$=B(2,(X,J)=>F9(X,{onFailure:(Y)=>oX(()=>J.onFailure(Y)),onSuccess:(Y)=>I(()=>J.onSuccess(Y))})),C7=B(2,(X,J)=>S8(X,{onFailure:(Y)=>{let G=vJ(Y);switch(G._tag){case"Left":return oX(()=>J(G.left));case"Right":return k0(G.right)}},onSuccess:g}));var u5=B(2,(X,J)=>i0((Y)=>S8(Y(X),{onFailure:(G)=>{let Z=_0(G);return S8(J(Z),{onFailure:($)=>_0(V8(G,$)),onSuccess:()=>Z})},onSuccess:(G)=>{let Z=C0(G);return w0(J(Z),Z)}}))),U5=B(2,(X,J)=>u5(X,aX({onFailure:(Y)=>mX(Y)?W8(J(uZ(Y))):l,onSuccess:()=>l}))),nH=B(2,(X,J)=>aE(X,J,g));var g=(X)=>{let J=new pH(g8);return J.effect_instruction_i0=X,J},n=(X)=>{let J=new N8(K9);return J.commit=X,J},I=(X)=>{let J=new N8(qG);return J.effect_instruction_i0=X,J},U8=B((X)=>X.length===3||X.length===2&&!(R5(X[1])&&("onlyEffect"in X[1])),(X,J)=>T(X,(Y)=>{let G=typeof J==="function"?J(Y):J;if(N5(G))return n0(G,Y);else if(WU(G))return gJ((Z)=>{G.then(($)=>Z(g(Y)),($)=>Z(h0(new tH($))))});return g(Y)})),lH=(X)=>A0((J)=>{let Y=J.getFiberRef(tZ),G=N(Y,K0(()=>J.scope()));return X(a8(tZ,F(G)))}),aE=B(3,(X,J,Y)=>S8(X,{onFailure:(G)=>{if(SJ(G).length>0)return k0(CG(fA(G)));return J()},onSuccess:Y})),_9=(X)=>{let J=new N8(a4);return J.effect_instruction_i0=wH(B5),J.effect_instruction_i1=()=>X,J},i0=(X)=>fH(X,function(){let J=new N8(a4);return J.effect_instruction_i0=wH(B5),J.effect_instruction_i1=(Y)=>yZ(Y)?M0(()=>this.effect_instruction_i0(k6)):M0(()=>this.effect_instruction_i0(_9)),J}),l=g(void 0);var G$=(X)=>{let J=new N8(a4);return J.effect_instruction_i0=X,J.effect_instruction_i1=void 0,J};var hJ=(X)=>{let J=new N8(WX);return J.effect_instruction_i0=X.while,J.effect_instruction_i1=X.body,J.effect_instruction_i2=X.step,J};var T7=(X)=>{let J=new N8(DX);return typeof X?.priority!=="undefined"?NO(J,X.priority):J},E7=B(2,(X,J)=>T(X,(Y)=>o(J,(G)=>[Y,G])));var I7=B(2,(X,J)=>T(X,(Y)=>n0(J,Y))),w0=B(2,(X,J)=>T(X,()=>J));var nX=pX(()=>{let X=setInterval(()=>{},2147483647);return I(()=>clearInterval(X))}),D5=(X)=>T(q4,(J)=>N(X,j7(J))),j7=B(2,(X,J)=>T(X.interruptAsFork(J),()=>X.await)),YO={_tag:"All",syslog:0,label:"ALL",ordinal:Number.MIN_SAFE_INTEGER,pipe(){return D(this,arguments)}},GO={_tag:"Fatal",syslog:2,label:"FATAL",ordinal:50000,pipe(){return D(this,arguments)}},ZO={_tag:"Error",syslog:3,label:"ERROR",ordinal:40000,pipe(){return D(this,arguments)}},$O={_tag:"Warning",syslog:4,label:"WARN",ordinal:30000,pipe(){return D(this,arguments)}},Z$={_tag:"Info",syslog:6,label:"INFO",ordinal:20000,pipe(){return D(this,arguments)}},rH={_tag:"Debug",syslog:7,label:"DEBUG",ordinal:1e4,pipe(){return D(this,arguments)}},QO={_tag:"Trace",syslog:7,label:"TRACE",ordinal:0,pipe(){return D(this,arguments)}},HO={_tag:"None",syslog:7,label:"OFF",ordinal:Number.MAX_SAFE_INTEGER,pipe(){return D(this,arguments)}};var sE="effect/FiberRef",KO=Symbol.for(sE),tE={_A:(X)=>X},w4=(X)=>A0((J)=>C0(J.getFiberRef(X)));var y6=B(2,(X,J)=>T(w4(X),J)),kJ=B(2,(X,J)=>BO(X,()=>[void 0,J]));var BO=B(2,(X,J)=>A0((Y)=>{let[G,Z]=J(Y.getFiberRef(X));return Y.setFiberRef(X,Z),g(G)}));var a8=B(3,(X,J,Y)=>cX(I7(w4(J),kJ(J,Y)),()=>X,(G)=>kJ(J,G)));var D8=(X,J)=>F4(X,{differ:jZ(),fork:J?.fork??x,join:J?.join}),iH=(X)=>{let J=VH();return F4(X,{differ:J,fork:J.empty})},eE=(X)=>{let J=NH(jZ());return F4(X,{differ:J,fork:J.empty})},lX=(X)=>{let J=BH();return F4(X,{differ:J,fork:J.empty})},F4=(X,J)=>{return{...o8,[KO]:tE,initial:X,commit(){return w4(this)},diff:(G,Z)=>J.differ.diff(G,Z),combine:(G,Z)=>J.differ.combine(G,Z),patch:(G)=>(Z)=>J.differ.patch(G,Z),fork:J.fork,join:J.join??((G,Z)=>Z)}},VO=(X)=>F4(X,{differ:hZ,fork:hZ.empty}),A6=h(Symbol.for("effect/FiberRef/currentContext"),()=>lX(y5())),z5=h(Symbol.for("effect/FiberRef/currentSchedulingPriority"),()=>D8(0)),$$=h(Symbol.for("effect/FiberRef/currentMaxOpsBeforeYield"),()=>D8(2048)),mJ=h(Symbol.for("effect/FiberRef/currentLogAnnotation"),()=>D8(W6())),Q$=h(Symbol.for("effect/FiberRef/currentLogLevel"),()=>D8(Z$)),H$=h(Symbol.for("effect/FiberRef/currentLogSpan"),()=>D8(d5())),NO=B(2,(X,J)=>a8(X,z5,J));var aH=h(Symbol.for("effect/FiberRef/currentConcurrency"),()=>D8("unbounded")),K$=h(Symbol.for("effect/FiberRef/currentRequestBatching"),()=>D8(!0)),rX=h(Symbol.for("effect/FiberRef/currentUnhandledErrorLogLevel"),()=>D8(F(rH)));var S7=h(Symbol.for("effect/FiberRef/currentMetricLabels"),()=>eE(t6()));var tZ=h(Symbol.for("effect/FiberRef/currentForkScopeOverride"),()=>D8(q(),{fork:()=>q(),join:(X,J)=>X})),v7=h(Symbol.for("effect/FiberRef/currentInterruptedCause"),()=>D8(D4,{fork:()=>D4,join:(X,J)=>X}));var B$=Symbol.for("effect/Scope"),V$=Symbol.for("effect/CloseableScope"),N$=(X,J)=>X.addFinalizer(()=>W8(J));var x7=(X,J)=>X.close(J),iX=(X,J)=>X.fork(J);var dJ=function(){class X extends globalThis.Error{commit(){return h0(this)}toJSON(){return{...this}}[v](){if(this.toString!==globalThis.Error.prototype.toString)return this.stack?`${this.toString()}
${this.stack.split(`
`).slice(1).join(`
`)}`:this.toString();else if("Bun"in globalThis)return z4(P7(this),{renderErrorCause:!0});return this}}return Object.assign(X.prototype,j2),X}(),k7=(X,J)=>{class Y extends dJ{_tag=J}return Object.assign(Y.prototype,X),Y.prototype.name=J,Y},SH=Symbol.for("effect/Cause/errors/RuntimeException"),WO=k7({[SH]:SH},"RuntimeException");var eZ=Symbol.for("effect/Cause/errors/InterruptedException"),XI=k7({[eZ]:eZ},"InterruptedException"),sH=(X)=>A(X,eZ),vH=Symbol.for("effect/Cause/errors/IllegalArgument"),W$=k7({[vH]:vH},"IllegalArgumentException");var xH=Symbol.for("effect/Cause/errors/NoSuchElement"),P9=k7({[xH]:xH},"NoSuchElementException");var kH=Symbol.for("effect/Cause/errors/InvalidPubSubCapacityException"),JI=k7({[kH]:kH},"InvalidPubSubCapacityException"),yH=Symbol.for("effect/Cause/errors/ExceededCapacityException"),UO=k7({[yH]:yH},"ExceededCapacityException");var gH=Symbol.for("effect/Cause/errors/Timeout"),YI=k7({[gH]:gH},"TimeoutException");var bH=Symbol.for("effect/Cause/errors/UnknownException"),tH=function(){class X extends dJ{cause;_tag="UnknownException";error;constructor(J,Y){super(Y??"An unknown error occurred",{cause:J});this.cause=J,this.error=J}}return Object.assign(X.prototype,{[bH]:bH,name:"UnknownException"}),X}();var cJ=(X)=>N5(X)&&("_tag"in X)&&(X._tag==="Success"||X._tag==="Failure");var eH=B(2,(X,J)=>{switch(X._tag){case y8:return _0(X.effect_instruction_i0);case g8:return C0(J)}}),pJ=(X)=>eH(X,void 0);var _4=(X,J)=>GI(X,J?.parallel?L9:V8),fJ=(X)=>_0(j8(X));var M9=(X)=>_0(P7(X)),_0=(X)=>{let J=new cH(y8);return J.effect_instruction_i0=X,J};var uJ=(X)=>_0(z6(X)),aZ=B(2,(X,J)=>{switch(X._tag){case y8:return _0(X.effect_instruction_i0);case g8:return C0(J(X.effect_instruction_i0))}});var aX=B(2,(X,{onFailure:J,onSuccess:Y})=>{switch(X._tag){case y8:return J(X.effect_instruction_i0);case g8:return Y(X.effect_instruction_i0)}});var C0=(X)=>{let J=new pH(g8);return J.effect_instruction_i0=X,J},a0=C0(void 0);var XK=B(3,(X,J,{onFailure:Y,onSuccess:G})=>{switch(X._tag){case y8:switch(J._tag){case g8:return _0(X.effect_instruction_i0);case y8:return _0(Y(X.effect_instruction_i0,J.effect_instruction_i0))}case g8:switch(J._tag){case g8:return C0(G(X.effect_instruction_i0,J.effect_instruction_i0));case y8:return _0(J.effect_instruction_i0)}}}),GI=(X,J)=>{let Y=K8(X);if(!y0(Y))return q();return N(G8(Y),j5(N(Y8(Y),aZ(z0)),(G,Z)=>N(G,XK(Z,{onSuccess:($,Q)=>N($,R0(Q)),onFailure:J}))),aZ(Z5),aZ((G)=>G6(G)),F)},sX=(X)=>{return{...o8,[jH]:rA,state:K5(iA([])),commit(){return Z6(this)},blockingOn:X}};var Z6=(X)=>pX((J)=>{let Y=S6(X.state);switch(Y._tag){case iZ:return J(Y.effect);case dX:return Y.joiners.push(J),ZI(X,J)}},X.blockingOn);var y7=(X,J)=>{let Y=S6(X.state);if(Y._tag===dX){h5(X.state,aA(J));for(let G=0,Z=Y.joiners.length;G<Z;G++)Y.joiners[G](J)}},ZI=(X,J)=>I(()=>{let Y=S6(X.state);if(Y._tag===dX){let G=Y.joiners.indexOf(J);if(G>=0)Y.joiners.splice(G,1)}}),$I=A0((X)=>C0(X.currentContext)),g6=()=>$I;var R9=(X)=>T(g6(),X),A5=B(2,(X,J)=>a8(A6,J)(X));var P4=B(2,(X,J)=>R9((Y)=>A5(X,J(Y)))),U$=(X)=>{let J=X.currentSpan;return J!==void 0&&J._tag==="Span"?F(J):q()};var oJ=fJ;var g7=M9,s8=_0;var JK=uJ;var t8=C0;var AO=Symbol.for("effect/MutableHashMap"),NI={[AO]:AO,[Symbol.iterator](){return new YK(this)},toString(){return d(this.toJSON())},toJSON(){return{_id:"MutableHashMap",values:Array.from(this).map(r)}},[v](){return this.toJSON()},pipe(){return D(this,arguments)}};class YK{self;referentialIterator;bucketIterator;constructor(X){this.self=X,this.referentialIterator=X.referential[Symbol.iterator]()}next(){if(this.bucketIterator!==void 0)return this.bucketIterator.next();let X=this.referentialIterator.next();if(X.done)return this.bucketIterator=new OO(this.self.buckets.values()),this.next();return X}[Symbol.iterator](){return new YK(this.self)}}class OO{backing;constructor(X){this.backing=X}currentBucket;next(){if(this.currentBucket===void 0){let J=this.backing.next();if(J.done)return J;this.currentBucket=J.value[Symbol.iterator]()}let X=this.currentBucket.next();if(X.done)return this.currentBucket=void 0,this.next();return X}}var M4=()=>{let X=Object.create(NI);return X.referential=new Map,X.buckets=new Map,X.bucketsSize=0,X};var O6=B(2,(X,J)=>{if(KX(J)===!1)return X.referential.has(J)?F(X.referential.get(J)):q();let Y=J[M](),G=X.buckets.get(Y);if(G===void 0)return q();return WI(X,G,J)});var WI=(X,J,Y,G=!1)=>{for(let Z=0,$=J.length;Z<$;Z++)if(Y[P](J[Z][0])){let Q=J[Z][1];if(G)J.splice(Z,1),X.bucketsSize--;return F(Q)}return q()},o5=B(2,(X,J)=>c(O6(X,J))),h6=B(3,(X,J,Y)=>{if(KX(J)===!1)return X.referential.set(J,Y),X;let G=J[M](),Z=X.buckets.get(G);if(Z===void 0)return X.buckets.set(G,[[J,Y]]),X.bucketsSize++,X;return UI(X,Z,J),Z.push([J,Y]),X.bucketsSize++,X}),UI=(X,J,Y)=>{for(let G=0,Z=J.length;G<Z;G++)if(Y[P](J[G][0])){J.splice(G,1),X.bucketsSize--;return}};var qO=Symbol.for("effect/MutableList"),ul={[qO]:qO,[Symbol.iterator](){let X=!1,J=this.head;return{next(){if(X)return this.return();if(J==null)return X=!0,this.return();let Y=J.value;return J=J.next,{done:X,value:Y}},return(Y){if(!X)X=!0;return{done:!0,value:Y}}}},toString(){return d(this.toJSON())},toJSON(){return{_id:"MutableList",values:Array.from(this).map(r)}},[v](){return this.toJSON()},pipe(){return D(this,arguments)}};var wO=Symbol.for("effect/MutableQueue");var tl={[wO]:wO,[Symbol.iterator](){return Array.from(this.queue)[Symbol.iterator]()},toString(){return d(this.toJSON())},toJSON(){return{_id:"MutableQueue",values:Array.from(this).map(r)}},[v](){return this.toJSON()},pipe(){return D(this,arguments)}};var DI="effect/Clock",z$=Symbol.for(DI),C9=u0("effect/Clock"),zI=2147483647,FO={unsafeSchedule(X,J){let Y=l8(J);if(Y>zI)return K6;let G=!1,Z=setTimeout(()=>{G=!0,X()},Y);return()=>{return clearTimeout(Z),!G}}},_O=function(){let X=BigInt(1e6);if(typeof performance==="undefined")return()=>BigInt(Date.now())*X;else if(typeof performance.timeOrigin==="number"&&performance.timeOrigin===0)return()=>BigInt(Math.round(performance.now()*1e6));let J=BigInt(Date.now())*X-BigInt(Math.round(performance.now()*1e6));return()=>J+BigInt(Math.round(performance.now()*1e6))}(),AI=function(){let X=typeof process==="object"&&"hrtime"in process&&typeof process.hrtime.bigint==="function"?process.hrtime:void 0;if(!X)return _O;let J=_O()-X.bigint();return()=>J+X.bigint()}();class PO{[z$]=z$;unsafeCurrentTimeMillis(){return Date.now()}unsafeCurrentTimeNanos(){return AI()}currentTimeMillis=I(()=>this.unsafeCurrentTimeMillis());currentTimeNanos=I(()=>this.unsafeCurrentTimeNanos());scheduler(){return g(FO)}sleep(X){return W5((J)=>{let Y=FO.unsafeSchedule(()=>J(l),X);return W8(I(Y))})}}var GK=()=>new PO;var ZK="And",$K="Or",QK="InvalidData",HK="MissingData",KK="SourceUnavailable",BK="Unsupported";var qI="effect/ConfigError",VK=Symbol.for(qI),eX={_tag:"ConfigError",[VK]:VK},O$=(X,J)=>{let Y=Object.create(eX);return Y._op=ZK,Y.left=X,Y.right=J,Object.defineProperty(Y,"toString",{enumerable:!1,value(){return`${this.left} and ${this.right}`}}),Y},q$=(X,J)=>{let Y=Object.create(eX);return Y._op=$K,Y.left=X,Y.right=J,Object.defineProperty(Y,"toString",{enumerable:!1,value(){return`${this.left} or ${this.right}`}}),Y},NK=(X,J,Y={pathDelim:"."})=>{let G=Object.create(eX);return G._op=QK,G.path=X,G.message=J,Object.defineProperty(G,"toString",{enumerable:!1,value(){return`(Invalid data at ${N(this.path,S5(Y.pathDelim))}: "${this.message}")`}}),G},q5=(X,J,Y={pathDelim:"."})=>{let G=Object.create(eX);return G._op=HK,G.path=X,G.message=J,Object.defineProperty(G,"toString",{enumerable:!1,value(){return`(Missing data at ${N(this.path,S5(Y.pathDelim))}: "${this.message}")`}}),G},MO=(X,J,Y,G={pathDelim:"."})=>{let Z=Object.create(eX);return Z._op=KK,Z.path=X,Z.message=J,Z.cause=Y,Object.defineProperty(Z,"toString",{enumerable:!1,value(){return`(Source unavailable at ${N(this.path,S5(G.pathDelim))}: "${this.message}")`}}),Z},WK=(X,J,Y={pathDelim:"."})=>{let G=Object.create(eX);return G._op=BK,G.path=X,G.message=J,Object.defineProperty(G,"toString",{enumerable:!1,value(){return`(Unsupported operation at ${N(this.path,S5(Y.pathDelim))}: "${this.message}")`}}),G};var T9=B(2,(X,J)=>{switch(X._op){case ZK:return O$(T9(X.left,J),T9(X.right,J));case $K:return q$(T9(X.left,J),T9(X.right,J));case QK:return NK([...J,...X.path],X.message);case HK:return q5([...J,...X.path],X.message);case KK:return MO([...J,...X.path],X.message,X.cause);case BK:return WK([...J,...X.path],X.message)}});var UK={_tag:"Empty"};var w$=B(2,(X,J)=>{let Y=wJ(J),G=X;while(CZ(Y)){let Z=Y.head;switch(Z._tag){case"Empty":{Y=Y.tail;break}case"AndThen":{Y=O9(Z.first,O9(Z.second,Y.tail));break}case"MapName":{G=C6(G,Z.f),Y=Y.tail;break}case"Nested":{G=J7(G,Z.name),Y=Y.tail;break}case"Unnested":{if(N(E5(G),jU(Z.name)))G=s6(G),Y=Y.tail;else return k(q5(G,`Expected ${Z.name} to be in path in ConfigProvider#unnested`));break}}}return u(G)});var DK="Constant",zK="Fail",AK="Fallback",OK="Described",qK="Lazy",LK="MapOrFail",wK="Nested",FK="Primitive",_K="Sequence",PK="HashMap",MK="ZipWith";var F$=(X,J)=>[...X,...J],PI="effect/ConfigProvider",RK=Symbol.for(PI),lJ=u0("effect/ConfigProvider"),MI="effect/ConfigProviderFlat",CK=Symbol.for(MI),TO=(X)=>({[RK]:RK,pipe(){return D(this,arguments)},...X}),EO=(X)=>({[CK]:CK,patch:X.patch,load:(J,Y,G=!0)=>X.load(J,Y,G),enumerateChildren:X.enumerateChildren}),IO=(X)=>TO({load:(J)=>T(m6(X,t6(),J,!1),(Y)=>$0(E5(Y),{onNone:()=>h0(q5(t6(),`Expected a single value having structure: ${J}`)),onSome:g})),flattened:X}),TK=(X)=>{let{pathDelim:J,seqDelim:Y}=Object.assign({},{pathDelim:"_",seqDelim:","},X),G=(H)=>N(H,S5(J)),Z=(H)=>H.split(J),$=()=>typeof process!=="undefined"&&("env"in process)&&typeof process.env==="object"?process.env:{};return IO(EO({load:(H,V,W=!0)=>{let U=G(H),L=$(),_=U in L?F(L[U]):q();return N(_,C7(()=>q5(H,`Expected ${U} to exist in the process context`)),T((z)=>II(z,H,V,Y,W)))},enumerateChildren:(H)=>I(()=>{let V=$(),L=Object.keys(V).map((_)=>Z(_.toUpperCase())).filter((_)=>{for(let z=0;z<H.length;z++){let R=N(H,f2(z)),j=_[z];if(j===void 0||R!==j)return!1}return!0}).flatMap((_)=>_.slice(H.length,H.length+1));return vX(L)}),patch:UK}))};var RI=(X,J,Y,G)=>{let Z=i2(Y.length,(H)=>H>=G.length?q():F([X(H),H+1])),$=i2(G.length,(H)=>H>=Y.length?q():F([J(H),H+1])),Q=F$(Y,Z),K=F$(G,$);return[Q,K]},CI=(X,J)=>{let Y=J;if(Y._tag==="Nested"){let G=X.slice();while(Y._tag==="Nested")G.push(Y.name),Y=Y.config;return G}return X},m6=(X,J,Y,G)=>{let Z=Y;switch(Z._tag){case DK:return g(E8(Z.value));case OK:return n(()=>m6(X,J,Z.config,G));case zK:return h0(q5(J,Z.message));case AK:return N(n(()=>m6(X,J,Z.first,G)),O4(($)=>{if(Z.condition($))return N(m6(X,J,Z.second,G),O4((Q)=>h0(q$($,Q))));return h0($)}));case qK:return n(()=>m6(X,J,Z.config(),G));case LK:return n(()=>N(m6(X,J,Z.original,G),T(M8(($)=>N(Z.mapOrFail($),C7(T9(CI(J,Z.original))))))));case wK:return n(()=>m6(X,F$(J,E8(Z.name)),Z.config,G));case FK:return N(w$(J,X.patch),T(($)=>N(X.load($,Z,G),T((Q)=>{if(Q.length===0){let K=N(vG($),K0(()=>"<n/a>"));return h0(q5([],`Expected ${Z.description} with name ${K}`))}return g(Q)}))));case _K:return N(w$(J,X.patch),T(($)=>N(X.enumerateChildren($),T(SI),T((Q)=>{if(Q.length===0)return n(()=>o(m6(X,J,Z.config,!0),E8));return N(M8(Q,(K)=>m6(X,xU(J,`[${K}]`),Z.config,!0)),o((K)=>{let H=JJ(K);if(H.length===0)return E8(t6());return E8(H)}))}))));case PK:return n(()=>N(w$(J,X.patch),T(($)=>N(X.enumerateChildren($),T((Q)=>{return N(Q,M8((K)=>m6(X,F$($,E8(K)),Z.valueConfig,G)),o((K)=>{if(K.length===0)return E8(W6());return N(jI(K),C6((H)=>t3(l2(p(Q),H))))}))})))));case MK:return n(()=>N(m6(X,J,Z.left,G),R7,T(($)=>N(m6(X,J,Z.right,G),R7,T((Q)=>{if(v0($)&&v0(Q))return h0(O$($.left,Q.left));if(v0($)&&J6(Q))return h0($.left);if(J6($)&&v0(Q))return h0(Q.left);if(J6($)&&J6(Q)){let K=N(J,S5(".")),H=TI(J,K),[V,W]=RI(H,H,N($.right,C6(u)),N(Q.right,C6(u)));return N(V,l2(W),M8(([U,L])=>N(E7(U,L),o(([_,z])=>Z.zip(_,z)))))}throw new Error("BUG: ConfigProvider.fromFlatLoop - please report an issue at https://github.com/Effect-TS/effect/issues")})))))}},TI=(X,J)=>(Y)=>k(q5(X,`The element at index ${Y} in a sequence at path "${J}" was missing`));var EI=(X,J)=>{return X.split(new RegExp(`\\s*${FX(J)}\\s*`))},II=(X,J,Y,G,Z)=>{if(!Z)return N(Y.parse(X),Y$({onFailure:T9(J),onSuccess:E8}));return N(EI(X,G),M8(($)=>Y.parse($.trim())),C7(T9(J)))},jI=(X)=>{return Object.keys(X[0]).map((J)=>X.map((Y)=>Y[J]))},SI=(X)=>N(M8(X,xI),Y$({onFailure:()=>t6(),onSuccess:I5(N6)}),R7,o(s1));var vI=/^(\[(\d+)\])$/,xI=(X)=>{let J=X.match(vI);if(J!==null){let Y=J[2];return N(Y!==void 0&&Y.length>0?F(Y):q(),i6(kI))}return q()};var kI=(X)=>{let J=Number.parseInt(X);return Number.isNaN(J)?q():F(J)};var EK=Symbol.for("effect/Console"),b7=u0("effect/Console"),SO={[EK]:EK,assert(X,...J){return I(()=>{console.assert(X,...J)})},clear:I(()=>{console.clear()}),count(X){return I(()=>{console.count(X)})},countReset(X){return I(()=>{console.countReset(X)})},debug(...X){return I(()=>{console.debug(...X)})},dir(X,J){return I(()=>{console.dir(X,J)})},dirxml(...X){return I(()=>{console.dirxml(...X)})},error(...X){return I(()=>{console.error(...X)})},group(X){return X?.collapsed?I(()=>console.groupCollapsed(X?.label)):I(()=>console.group(X?.label))},groupEnd:I(()=>{console.groupEnd()}),info(...X){return I(()=>{console.info(...X)})},log(...X){return I(()=>{console.log(...X)})},table(X,J){return I(()=>{console.table(X,J)})},time(X){return I(()=>console.time(X))},timeEnd(X){return I(()=>console.timeEnd(X))},timeLog(X,...J){return I(()=>{console.timeLog(X,...J)})},trace(...X){return I(()=>{console.trace(...X)})},warn(...X){return I(()=>{console.warn(...X)})},unsafe:console};var yI="effect/Random",jK=Symbol.for(yI),_$=u0("effect/Random");class vO{seed;[jK]=jK;PRNG;constructor(X){this.seed=X,this.PRNG=new UG(X)}get next(){return I(()=>this.PRNG.number())}get nextBoolean(){return o(this.next,(X)=>X>0.5)}get nextInt(){return I(()=>this.PRNG.integer(Number.MAX_SAFE_INTEGER))}nextRange(X,J){return o(this.next,(Y)=>(J-X)*Y+X)}nextIntBetween(X,J){return I(()=>this.PRNG.integer(J-X)+X)}shuffle(X){return gI(X,(J)=>this.nextIntBetween(0,J))}}var gI=(X,J)=>{return n(()=>N(I(()=>Array.from(X)),T((Y)=>{let G=[];for(let Z=Y.length;Z>=2;Z=Z-1)G.push(Z);return N(G,i8((Z)=>N(J(Z),o(($)=>bI(Y,Z-1,$)))),n0(K8(Y)))})))},bI=(X,J,Y)=>{let G=X[J];return X[J]=X[Y],X[Y]=G,X},SK=(X)=>new vO(O(X));var vK=Symbol.for("effect/Tracer"),yO=(X)=>({[vK]:vK,...X}),X1=u0("effect/Tracer"),C4=u0("effect/ParentSpan"),kO=function(){return function(Y){let G="";for(let Z=0;Z<Y;Z++)G+="abcdef0123456789".charAt(Math.floor(Math.random()*16));return G}}();class gO{name;parent;context;links;startTime;kind;_tag="Span";spanId;traceId="native";sampled=!0;status;attributes;events=[];constructor(X,J,Y,G,Z,$){this.name=X,this.parent=J,this.context=Y,this.links=G,this.startTime=Z,this.kind=$,this.status={_tag:"Started",startTime:Z},this.attributes=new Map,this.traceId=J._tag==="Some"?J.value.traceId:kO(32),this.spanId=kO(16)}end(X,J){this.status={_tag:"Ended",endTime:X,exit:J,startTime:this.status.startTime}}attribute(X,J){this.attributes.set(X,J)}event(X,J,Y){this.events.push([X,J,Y??{}])}}var bO=yO({span:(X,J,Y,G,Z,$)=>new gO(X,J,Y,G,Z,$),context:(X)=>X()});var P$=N(y5(),l0(C9,GK()),l0(b7,SO),l0(_$,SK(Math.random())),l0(lJ,TK()),l0(X1,bO)),q6=h(Symbol.for("effect/DefaultServices/currentServices"),()=>lX(P$));var hI=(X)=>A0((J)=>X(J.currentDefaultServices));var mO=(X)=>hI((J)=>X(J.unsafeMap.get(lJ.key))),dO=(X)=>mO((J)=>J.load(X));function cO(X){return new j9(X)}function yK(){return cO(new Map)}var xK=Symbol.for("effect/FiberRefs");class j9{locals;[xK]=xK;constructor(X){this.locals=X}pipe(){return D(this,arguments)}}var dI=(X,J,Y,G=!1)=>{let Z=X,$=J,Q=Y,K=G,H=void 0;while(H===void 0)if(T0($)&&T0(Q)){let V=F8($)[0],W=s6($),U=F8(Q)[0],L=F8(Q)[1],_=s6(Q);if(V.startTimeMillis<U.startTimeMillis)Q=_,K=!0;else if(V.startTimeMillis>U.startTimeMillis)$=W;else if(V.id<U.id)Q=_,K=!0;else if(V.id>U.id)$=W;else H=[L,K]}else H=[Z.initial,!0];return H},gK=B(3,(X,J,Y)=>{let G=new Map(X.locals);return Y.locals.forEach((Z,$)=>{let Q=Z[0][1];if(!Z[0][0][P](J)){if(!G.has($)){if(w(Q,$.initial))return;G.set($,[[J,$.join($.initial,Q)]]);return}let K=G.get($),[H,V]=dI($,K,Z);if(V){let W=$.diff(H,Q),U=K[0][1],L=$.join(U,$.patch(W)(U));if(!w(U,L)){let _,z=K[0][0];if(z[P](J))_=[[z,L],...K.slice(1)];else _=[[J,L],...K];G.set($,_)}}}}),new j9(G)}),bK=B(2,(X,J)=>{let Y=new Map;return pO(X,Y,J),new j9(Y)}),pO=(X,J,Y)=>{X.locals.forEach((G,Z)=>{let $=G[0][1],Q=Z.patch(Z.fork)($);if(w($,Q))J.set(Z,G);else J.set(Z,[[Y,Q],...G])})};var rJ=B(2,(X,J)=>{let Y=new Map(X.locals);return Y.delete(J),new j9(Y)}),hK=B(2,(X,J)=>{if(!X.locals.has(J))return q();return F(F8(X.locals.get(J))[1])}),T4=B(2,(X,J)=>N(hK(X,J),K0(()=>J.initial))),J1=B(2,(X,{fiberId:J,fiberRef:Y,value:G})=>{if(X.locals.size===0)return new j9(new Map([[Y,[[J,G]]]]));let Z=new Map(X.locals);return kK(Z,J,Y,G),new j9(Z)}),kK=(X,J,Y,G)=>{let Z=X.get(Y)??[],$;if(T0(Z)){let[Q,K]=F8(Z);if(Q[P](J))if(w(K,G))return;else $=[[J,G],...Z.slice(1)];else $=[[J,G],...Z]}else $=[[J,G]];X.set(Y,$)},fO=B(2,(X,{entries:J,forkAs:Y})=>{if(X.locals.size===0)return new j9(new Map(J));let G=new Map(X.locals);if(Y!==void 0)pO(X,G,Y);return J.forEach(([Z,$])=>{if($.length===1)kK(G,$[0][0],Z,$[0][1]);else $.forEach(([Q,K])=>{kK(G,Q,Z,K)})}),new j9(G)});var mK=T4;var uO=fO;var oO=yK;var pI=YO,nO=GO,lO=ZO,rO=$O,iO=Z$,aO=rH,sO=QO,fI=HO;var uI=N(N6,J4((X)=>X.ordinal));var tO=e4(uI);var eO=(X)=>{switch(X){case"All":return pI;case"Debug":return aO;case"Error":return lO;case"Fatal":return nO;case"Info":return iO;case"Trace":return sO;case"None":return fI;case"Warning":return rO}};var cK=(X)=>X.replace(/[\s="]/g,"_"),pK=(X)=>(J)=>{return`${cK(J.label)}=${X-J.startTime}ms`};var Yq=B9,R$=o8;var oI=FU;class $6 extends oI{}var S9=Symbol.for("effect/Readable");var Ir={[S9]:S9,pipe(){return D(this,arguments)}};var E4=(X)=>X.get;var Kq="Empty",Bq="Add",Vq="Remove",Nq="Update",Wq="AndThen",Uq={_tag:Kq},uK=(X,J)=>{let Y=new Map(X.locals),G=Uq;for(let[Z,$]of J.locals.entries()){let Q=F8($)[1],K=Y.get(Z);if(K!==void 0){let H=F8(K)[1];if(!w(H,Q))G=C$({_tag:Nq,fiberRef:Z,patch:Z.diff(H,Q)})(G)}else G=C$({_tag:Bq,fiberRef:Z,value:Q})(G);Y.delete(Z)}for(let[Z]of Y.entries())G=C$({_tag:Vq,fiberRef:Z})(G);return G},C$=B(2,(X,J)=>({_tag:Wq,first:X,second:J})),oK=B(3,(X,J,Y)=>{let G=Y,Z=E8(X);while(T0(Z)){let $=F8(Z),Q=s6(Z);switch($._tag){case Kq:{Z=Q;break}case Bq:{G=J1(G,{fiberId:J,fiberRef:$.fiberRef,value:$.value}),Z=Q;break}case Vq:{G=rJ(G,$.fiberRef),Z=Q;break}case Nq:{let K=T4(G,$.fiberRef);G=J1(G,{fiberId:J,fiberRef:$.fiberRef,value:$.fiberRef.patch($.patch)(K)}),Z=Q;break}case Wq:{Z=J7($.first)(J7($.second)(Q));break}}}return G});var zq="effect/MetricLabel",T$=Symbol.for(zq);class Aq{key;value;[T$]=T$;_hash;constructor(X,J){this.key=X,this.value=J,this._hash=D0(zq+this.key+this.value)}[M](){return this._hash}[P](X){return Oq(X)&&this.key===X.key&&this.value===X.value}pipe(){return D(this,arguments)}}var G1=(X,J)=>{return new Aq(X,J)},Oq=(X)=>A(X,T$);var I$=(X)=>o(X,F);var eJ=g(q());var Cq="Sequential",Tq="Parallel",Kj="ParallelN",n5={_tag:Cq},Eq={_tag:Tq},Iq=(X)=>({_tag:Kj,parallelism:X}),iK=(X)=>X._tag===Cq,aK=(X)=>X._tag===Tq;var JY=n5,j$=Eq,S$=Iq;var tK=uK;var eK=oK;var x$="effect/FiberStatus",j4=Symbol.for(x$),v$="Done",jq="Running",Sq="Suspended",Bj=D0(`${x$}-${v$}`);class vq{[j4]=j4;_tag=v$;[M](){return Bj}[P](X){return k$(X)&&X._tag===v$}}class xq{runtimeFlags;[j4]=j4;_tag=jq;constructor(X){this.runtimeFlags=X}[M](){return N(O(x$),C(O(this._tag)),C(O(this.runtimeFlags)),S(this))}[P](X){return k$(X)&&X._tag===jq&&this.runtimeFlags===X.runtimeFlags}}class kq{runtimeFlags;blockingOn;[j4]=j4;_tag=Sq;constructor(X,J){this.runtimeFlags=X,this.blockingOn=J}[M](){return N(O(x$),C(O(this._tag)),C(O(this.runtimeFlags)),C(O(this.blockingOn)),S(this))}[P](X){return k$(X)&&X._tag===Sq&&this.runtimeFlags===X.runtimeFlags&&w(this.blockingOn,X.blockingOn)}}var yq=new vq,gq=(X)=>new xq(X),bq=(X,J)=>new kq(X,J),k$=(X)=>A(X,j4),hq=(X)=>X._tag===v$;var mq=yq,JB=gq,dq=bq;var y$=hq;var Nj=Symbol.for("effect/Micro"),h$=Symbol.for("effect/Micro/MicroExit");var cq=Symbol.for("effect/Micro/MicroCause");var Wj={_E:x};class ZB extends globalThis.Error{_tag;traces;[cq];constructor(X,J,Y){let G=`MicroCause.${X}`,Z,$,Q;if(J instanceof globalThis.Error){Z=`(${G}) ${J.name}`,$=J.message;let K=$.split(`
`).length;Q=J.stack?`(${G}) ${J.stack.split(`
`).slice(0,K+3).join(`
`)}`:`${Z}: ${$}`}else Z=G,$=H9(J,0),Q=`${Z}: ${$}`;if(Y.length>0)Q+=`
    ${Y.join(`
    `)}`;super($);this._tag=X,this.traces=Y,this[cq]=Wj,this.name=Z,this.stack=Q}pipe(){return D(this,arguments)}toString(){return this.stack}[v](){return this.stack}}class uq extends ZB{defect;constructor(X,J=[]){super("Die",X,J);this.defect=X}}var Uj=(X,J=[])=>new uq(X,J);class oq extends ZB{constructor(X=[]){super("Interrupt","interrupted",X)}}var Dj=(X=[])=>new oq(X);var zj=(X)=>X._tag==="Interrupt";var pq=Symbol.for("effect/Micro/MicroFiber"),Aj={_A:x,_E:x};class nq{context;interruptible;[pq];_stack=[];_observers=[];_exit;_children;currentOpCount=0;constructor(X,J=!0){this.context=X,this.interruptible=J,this[pq]=Aj}getRef(X){return aD(this.context,X)}addObserver(X){if(this._exit)return X(this._exit),u8;return this._observers.push(X),()=>{let J=this._observers.indexOf(X);if(J>=0)this._observers.splice(J,1)}}_interrupted=!1;unsafeInterrupt(){if(this._exit)return;if(this._interrupted=!0,this.interruptible)this.evaluate(BB)}unsafePoll(){return this._exit}evaluate(X){if(this._exit)return;else if(this._yielded!==void 0){let G=this._yielded;this._yielded=void 0,G()}let J=this.runLoop(X);if(J===b$)return;let Y=fq.interruptChildren&&fq.interruptChildren(this);if(Y!==void 0)return this.evaluate(d$(Y,()=>J));this._exit=J;for(let G=0;G<this._observers.length;G++)this._observers[G](J);this._observers.length=0}runLoop(X){let J=!1,Y=X;this.currentOpCount=0;try{while(!0){if(this.currentOpCount++,!J&&this.getRef(p$).shouldYield(this)){J=!0;let G=Y;Y=d$(Fj,()=>G)}if(Y=Y[YB](this),Y===b$){let G=this._yielded;if(h$ in G)return this._yielded=void 0,G;return b$}}}catch(G){if(!A(Y,YB))return GB(`MicroFiber.runLoop: Not a valid effect: ${String(Y)}`);return GB(G)}}getCont(X){while(!0){let J=this._stack.pop();if(!J)return;let Y=J[m$]&&J[m$](this);if(Y)return{[X]:Y};if(J[X])return J}}_yielded=void 0;yieldWith(X){return this._yielded=X,b$}children(){return this._children??=new Set}}var fq=h("effect/Micro/fiberMiddleware",()=>({interruptChildren:void 0}));var lq=Symbol.for("effect/Micro/identifier"),z8=Symbol.for("effect/Micro/args"),YB=Symbol.for("effect/Micro/evaluate"),Q1=Symbol.for("effect/Micro/successCont"),$1=Symbol.for("effect/Micro/failureCont"),m$=Symbol.for("effect/Micro/ensureCont"),b$=Symbol.for("effect/Micro/Yield"),Oj={_A:x,_E:x,_R:x},qj={...Yq,_op:"Micro",[Nj]:Oj,pipe(){return D(this,arguments)},[Symbol.iterator](){return new QX(new r6(this))},toJSON(){return{_id:"Micro",op:this[lq],...z8 in this?{args:this[z8]}:void 0}},toString(){return d(this)},[v](){return d(this)}};function Lj(X){return GB("Micro.evaluate: Not implemented")}var c$=(X)=>({...qj,[lq]:X.op,[YB]:X.eval??Lj,[Q1]:X.contA,[$1]:X.contE,[m$]:X.ensure}),$B=(X)=>{let J=c$(X);return function(){let Y=Object.create(J);return Y[z8]=X.single===!1?arguments:arguments[0],Y}},rq=(X)=>{let J={...c$(X),[h$]:h$,_tag:X.op,get[X.prop](){return this[z8]},toJSON(){return{_id:"MicroExit",_tag:X.op,[X.prop]:this[z8]}},[P](Y){return Mj(Y)&&Y._tag===X.op&&w(this[z8],Y[z8])},[M](){return S(this,C(D0(X.op))(O(this[z8])))}};return function(Y){let G=Object.create(J);return G[z8]=Y,G[Q1]=void 0,G[$1]=void 0,G[m$]=void 0,G}},QB=rq({op:"Success",prop:"value",eval(X){let J=X.getCont(Q1);return J?J[Q1](this[z8],X):X.yieldWith(this)}}),iq=rq({op:"Failure",prop:"cause",eval(X){let J=X.getCont($1);while(zj(this[z8])&&J&&X.interruptible)J=X.getCont($1);return J?J[$1](this[z8],X):X.yieldWith(this)}});var wj=$B({op:"Yield",eval(X){let J=!1;return X.getRef(p$).scheduleTask(()=>{if(J)return;X.evaluate(Rj)},this[z8]??0),X.yieldWith(()=>{J=!0})}}),Fj=wj(0);var _j=QB(void 0);var HB=$B({op:"WithMicroFiber",eval(X){return this[z8](X)}});var d$=B(2,(X,J)=>{let Y=Object.create(Pj);return Y[z8]=X,Y[Q1]=J,Y}),Pj=c$({op:"OnSuccess",eval(X){return X._stack.push(this),this[z8]}});var Mj=(X)=>A(X,h$),aq=QB,KB=iq,BB=KB(Dj());var GB=(X)=>KB(Uj(X));var Rj=aq(void 0);var Cj="setImmediate"in globalThis?globalThis.setImmediate:(X)=>setTimeout(X,0);class VB{tasks=[];running=!1;scheduleTask(X,J){if(this.tasks.push(X),!this.running)this.running=!0,Cj(this.afterScheduled)}afterScheduled=()=>{this.running=!1,this.runTasks()};runTasks(){let X=this.tasks;this.tasks=[];for(let J=0,Y=X.length;J<Y;J++)X[J]()}shouldYield(X){return X.currentOpCount>=X.getRef(tq)}flush(){while(this.tasks.length>0)this.runTasks()}}var Tj=B(2,(X,J)=>HB((Y)=>{let G=Y.context;return Y.context=J(G),jj(X,()=>{return Y.context=G,_j})}));var sq=B(2,(X,J)=>Tj(X,g5(J)));class tq extends XZ()("effect/Micro/currentMaxOpsBeforeYield",{defaultValue:()=>2048}){}class p$ extends XZ()("effect/Micro/currentScheduler",{defaultValue:()=>new VB}){}var Ej=B(2,(X,J)=>{let Y=Object.create(Ij);return Y[z8]=X,Y[Q1]=J.onSuccess,Y[$1]=J.onFailure,Y}),Ij=c$({op:"OnSuccessAndFailure",eval(X){return X._stack.push(this),this[z8]}});var jj=B(2,(X,J)=>vj((Y)=>Ej(Y(X),{onFailure:(G)=>d$(J(KB(G)),()=>iq(G)),onSuccess:(G)=>d$(J(aq(G)),()=>QB(G))})));var eq=$B({op:"SetInterruptible",ensure(X){if(X.interruptible=this[z8],X._interrupted&&X.interruptible)return()=>BB}}),Sj=(X)=>HB((J)=>{if(J.interruptible)return X;if(J.interruptible=!0,J._stack.push(eq(!1)),J._interrupted)return BB;return X}),vj=(X)=>HB((J)=>{if(!J.interruptible)return X(x);return J.interruptible=!1,J._stack.push(eq(!0)),X(Sj)});var XL=(X,J)=>{let Y=new nq(p$.context(J?.scheduler??new VB));if(Y.evaluate(X),J?.signal)if(J.signal.aborted)Y.unsafeInterrupt();else{let G=()=>Y.unsafeInterrupt();J.signal.addEventListener("abort",G,{once:!0}),Y.addObserver(()=>J.signal.removeEventListener("abort",G))}return Y};class NB{buckets=[];scheduleTask(X,J){let Y=this.buckets.length,G=void 0,Z=0;for(;Z<Y;Z++)if(this.buckets[Z][0]<=J)G=this.buckets[Z];else break;if(G&&G[0]===J)G[1].push(X);else if(Z===Y)this.buckets.push([J,[X]]);else this.buckets.splice(Z,0,[J,[X]])}}class YL{maxNextTickBeforeTimer;running=!1;tasks=new NB;constructor(X){this.maxNextTickBeforeTimer=X}starveInternal(X){let J=this.tasks.buckets;this.tasks.buckets=[];for(let[Y,G]of J)for(let Z=0;Z<G.length;Z++)G[Z]();if(this.tasks.buckets.length===0)this.running=!1;else this.starve(X)}starve(X=0){if(X>=this.maxNextTickBeforeTimer)setTimeout(()=>this.starveInternal(0),0);else Promise.resolve(void 0).then(()=>this.starveInternal(X+1))}shouldYield(X){return X.currentOpCount>X.getFiberRef($$)?X.getFiberRef(z5):!1}scheduleTask(X,J){if(this.tasks.scheduleTask(X,J),!this.running)this.running=!0,this.starve()}}var GL=h(Symbol.for("effect/Scheduler/defaultScheduler"),()=>new YL(2048));class WB{tasks=new NB;deferred=!1;scheduleTask(X,J){if(this.deferred)GL.scheduleTask(X,J);else this.tasks.scheduleTask(X,J)}shouldYield(X){return X.currentOpCount>X.getFiberRef($$)?X.getFiberRef(z5):!1}flush(){while(this.tasks.buckets.length>0){let X=this.tasks.buckets;this.tasks.buckets=[];for(let[J,Y]of X)for(let G=0;G<Y.length;G++)Y[G]()}this.deferred=!0}}var x9=h(Symbol.for("effect/FiberRef/currentScheduler"),()=>D8(GL));var f$=h(Symbol.for("effect/FiberRef/currentRequestMap"),()=>D8(new Map));var UB=(X,J,Y,G)=>{switch(X){case void 0:return J();case"unbounded":return Y();case"inherit":return y6(aH,(Z)=>Z==="unbounded"?Y():Z>1?G(Z):J());default:return X>1?G(X):J()}};var DB="InterruptSignal",zB="Stateful",AB="Resume",OB="YieldNow",u$=(X)=>({_tag:"InterruptSignal",cause:X}),H1=(X)=>({_tag:"Stateful",onFiber:X}),d7=(X)=>({_tag:"Resume",effect:X}),ZL=()=>({_tag:"YieldNow"});var yj="effect/FiberScope",o$=Symbol.for(yj);class QL{[o$]=o$;fiberId=h8;roots=new Set;add(X,J){this.roots.add(J),J.addObserver(()=>{this.roots.delete(J)})}}class HL{fiberId;parent;[o$]=o$;constructor(X,J){this.fiberId=X,this.parent=J}add(X,J){this.parent.tell(H1((Y)=>{Y.addChild(J),J.addObserver(()=>{Y.removeChild(J)})}))}}var KL=(X)=>{return new HL(X.id(),X)},c7=h(Symbol.for("effect/FiberScope/Global"),()=>new QL);var mj="effect/Fiber",ZY=Symbol.for(mj),n$={_E:(X)=>X,_A:(X)=>X},dj={[ZY]:n$,pipe(){return D(this,arguments)}},cj="effect/Fiber",LB=Symbol.for(cj);var B1=(X)=>I7(p5(X.await),X.inheritAll);var qi={...o8,commit(){return B1(this)},...dj,id:()=>h8,await:nX,children:g([]),inheritAll:nX,poll:g(q()),interruptAsFork:()=>nX};var S4="effect/FiberCurrent";var fj="effect/Logger",wB=Symbol.for(fj),VL={_Message:(X)=>X,_Output:(X)=>X},V1=(X)=>({[wB]:VL,log:X,pipe(){return D(this,arguments)}});var uj={[wB]:VL,log:u8,pipe(){return D(this,arguments)}};var oj=/^[^\s"=]*$/,NL=(X,J)=>({annotations:Y,cause:G,date:Z,fiberId:$,logLevel:Q,message:K,spans:H})=>{let V=(z)=>z.match(oj)?z:X(z),W=(z,R)=>`${cK(z)}=${V(R)}`,U=(z,R)=>" "+W(z,R),L=W("timestamp",Z.toISOString());L+=U("level",Q.label),L+=U("fiber",_Z($));let _=c2(K);for(let z=0;z<_.length;z++)L+=U("message",H9(_[z],J));if(!EH(G))L+=U("cause",z4(G,{renderErrorCause:!0}));for(let z of H)L+=" "+pK(Z.getTime())(z);for(let[z,R]of Y)L+=U(z,H9(R,J));return L},nj=(X)=>`"${X.replace(/\\([\s\S])|(")/g,"\\$1$2")}"`,FB=V1(NL(nj)),WL=V1(NL(JSON.stringify,0));var p7={bold:"1",red:"31",green:"32",yellow:"33",blue:"34",cyan:"36",white:"37",gray:"90",black:"30",bgBrightRed:"101"},Pi={None:[],All:[],Trace:[p7.gray],Debug:[p7.blue],Info:[p7.green],Warning:[p7.yellow],Error:[p7.red],Fatal:[p7.bgBrightRed,p7.black]};var UL=typeof process==="object"&&process!==null&&typeof process.stdout==="object"&&process.stdout!==null,Mi=UL&&process.stdout.isTTY===!0,Ri=UL||"Deno"in globalThis;var zL="effect/MetricBoundaries",r$=Symbol.for(zL);class AL{values;[r$]=r$;constructor(X){this.values=X,this._hash=N(D0(zL),C(J8(this.values)))}_hash;[M](){return this._hash}[P](X){return OL(X)&&w(this.values,X.values)}pipe(){return D(this,arguments)}}var OL=(X)=>A(X,r$),_B=(X)=>{let J=N(X,p2(z0(Number.POSITIVE_INFINITY)),a2);return new AL(J)};var i$=(X)=>N(d2(X.count-1,(J)=>X.start*Math.pow(X.factor,J)),B8,_B);var lj="effect/MetricKeyType",MB=Symbol.for(lj),qL="effect/MetricKeyType/Counter",a$=Symbol.for(qL),rj="effect/MetricKeyType/Frequency",LL=Symbol.for(rj),ij="effect/MetricKeyType/Gauge",wL=Symbol.for(ij),FL="effect/MetricKeyType/Histogram",s$=Symbol.for(FL),aj="effect/MetricKeyType/Summary",_L=Symbol.for(aj),PL={_In:(X)=>X,_Out:(X)=>X};class ML{incremental;bigint;[MB]=PL;[a$]=a$;constructor(X,J){this.incremental=X,this.bigint=J,this._hash=D0(qL)}_hash;[M](){return this._hash}[P](X){return $Y(X)}pipe(){return D(this,arguments)}}class RL{boundaries;[MB]=PL;[s$]=s$;constructor(X){this.boundaries=X,this._hash=N(D0(FL),C(O(this.boundaries)))}_hash;[M](){return this._hash}[P](X){return t$(X)&&w(this.boundaries,X.boundaries)}pipe(){return D(this,arguments)}}var RB=(X)=>new ML(X?.incremental??!1,X?.bigint??!1);var CB=(X)=>{return new RL(X)};var $Y=(X)=>A(X,a$),TB=(X)=>A(X,LL),EB=(X)=>A(X,wL),t$=(X)=>A(X,s$),IB=(X)=>A(X,_L);var XS="effect/MetricKey",jB=Symbol.for(XS),JS={_Type:(X)=>X},YS=Y4(w);class XQ{name;keyType;description;tags;[jB]=JS;constructor(X,J,Y,G=[]){this.name=X,this.keyType=J,this.description=Y,this.tags=G,this._hash=N(D0(this.name+this.description),C(O(this.keyType)),C(J8(this.tags)))}_hash;[M](){return this._hash}[P](X){return CL(X)&&this.name===X.name&&w(this.keyType,X.keyType)&&w(this.description,X.description)&&YS(this.tags,X.tags)}pipe(){return D(this,arguments)}}var CL=(X)=>A(X,jB),SB=(X,J)=>new XQ(X,RB(J),H8(J?.description));var vB=(X,J,Y)=>new XQ(X,CB(J),H8(Y));var xB=B(2,(X,J)=>J.length===0?X:new XQ(X.name,X.keyType,X.description,N9(X.tags,J)));var GS="effect/MetricState",N1=Symbol.for(GS),EL="effect/MetricState/Counter",JQ=Symbol.for(EL),IL="effect/MetricState/Frequency",YQ=Symbol.for(IL),jL="effect/MetricState/Gauge",GQ=Symbol.for(jL),SL="effect/MetricState/Histogram",ZQ=Symbol.for(SL),vL="effect/MetricState/Summary",$Q=Symbol.for(vL),QY={_A:(X)=>X};class xL{count;[N1]=QY;[JQ]=JQ;constructor(X){this.count=X}[M](){return N(O(EL),C(O(this.count)),S(this))}[P](X){return hL(X)&&this.count===X.count}pipe(){return D(this,arguments)}}var ZS=Y4(w);class kL{occurrences;[N1]=QY;[YQ]=YQ;constructor(X){this.occurrences=X}_hash;[M](){return N(D0(IL),C(J8(p(this.occurrences.entries()))),S(this))}[P](X){return mL(X)&&ZS(p(this.occurrences.entries()),p(X.occurrences.entries()))}pipe(){return D(this,arguments)}}class yL{value;[N1]=QY;[GQ]=GQ;constructor(X){this.value=X}[M](){return N(O(jL),C(O(this.value)),S(this))}[P](X){return dL(X)&&this.value===X.value}pipe(){return D(this,arguments)}}class gL{buckets;count;min;max;sum;[N1]=QY;[ZQ]=ZQ;constructor(X,J,Y,G,Z){this.buckets=X,this.count=J,this.min=Y,this.max=G,this.sum=Z}[M](){return N(O(SL),C(O(this.buckets)),C(O(this.count)),C(O(this.min)),C(O(this.max)),C(O(this.sum)),S(this))}[P](X){return cL(X)&&w(this.buckets,X.buckets)&&this.count===X.count&&this.min===X.min&&this.max===X.max&&this.sum===X.sum}pipe(){return D(this,arguments)}}class bL{error;quantiles;count;min;max;sum;[N1]=QY;[$Q]=$Q;constructor(X,J,Y,G,Z,$){this.error=X,this.quantiles=J,this.count=Y,this.min=G,this.max=Z,this.sum=$}[M](){return N(O(vL),C(O(this.error)),C(O(this.quantiles)),C(O(this.count)),C(O(this.min)),C(O(this.max)),C(O(this.sum)),S(this))}[P](X){return pL(X)&&this.error===X.error&&w(this.quantiles,X.quantiles)&&this.count===X.count&&this.min===X.min&&this.max===X.max&&this.sum===X.sum}pipe(){return D(this,arguments)}}var kB=(X)=>new xL(X),yB=(X)=>{return new kL(X)},gB=(X)=>new yL(X),bB=(X)=>new gL(X.buckets,X.count,X.min,X.max,X.sum),hB=(X)=>new bL(X.error,X.quantiles,X.count,X.min,X.max,X.sum);var hL=(X)=>A(X,JQ),mL=(X)=>A(X,YQ),dL=(X)=>A(X,GQ),cL=(X)=>A(X,ZQ),pL=(X)=>A(X,$Q);var $S="effect/MetricHook",nL=Symbol.for($S),QS={_In:(X)=>X,_Out:(X)=>X},W1=(X)=>({[nL]:QS,pipe(){return D(this,arguments)},...X});var uL=BigInt(0),mB=(X)=>{let J=X.keyType.bigint?uL:0,Y=X.keyType.incremental?X.keyType.bigint?(Z)=>Z>=uL:(Z)=>Z>=0:(Z)=>!0,G=(Z)=>{if(Y(Z))J=J+Z};return W1({get:()=>kB(J),update:G,modify:G})},dB=(X)=>{let J=new Map;for(let G of X.keyType.preregisteredWords)J.set(G,0);let Y=(G)=>{let Z=J.get(G)??0;J.set(G,Z+1)};return W1({get:()=>yB(J),update:Y,modify:Y})},cB=(X,J)=>{let Y=J;return W1({get:()=>gB(Y),update:(G)=>{Y=G},modify:(G)=>{Y=Y+G}})},pB=(X)=>{let J=X.keyType.boundaries.values,Y=J.length,G=new Uint32Array(Y+1),Z=new Float32Array(Y),$=0,Q=0,K=Number.MAX_VALUE,H=Number.MIN_VALUE;N(J,I5(N6),C6((U,L)=>{Z[L]=U}));let V=(U)=>{let L=0,_=Y;while(L!==_){let z=Math.floor(L+(_-L)/2),R=Z[z];if(U<=R)_=z;else L=z;if(_===L+1)if(U<=Z[L])_=L;else L=_}if(G[L]=G[L]+1,$=$+1,Q=Q+U,U<K)K=U;if(U>H)H=U},W=()=>{let U=X7(Y),L=0;for(let _=0;_<Y;_++){let z=Z[_],R=G[_];L=L+R,U[_]=[z,L]}return U};return W1({get:()=>bB({buckets:W(),count:$,min:K,max:H,sum:Q}),update:V,modify:V})},fB=(X)=>{let{error:J,maxAge:Y,maxSize:G,quantiles:Z}=X.keyType,$=N(Z,I5(N6)),Q=X7(G),K=0,H=0,V=0,W=Number.MAX_VALUE,U=Number.MIN_VALUE,L=(z)=>{let R=[],j=0;while(j!==G-1){let m=Q[j];if(m!=null){let[B0,f]=m,Y0=Q5(z-B0);if($Z(Y0,GZ)&&Y0<=Y)R.push(f)}j=j+1}return HS(J,$,I5(R,N6))},_=(z,R)=>{if(G>0){K=K+1;let j=K%G;Q[j]=[R,z]}if(H=H+1,V=V+z,z<W)W=z;if(z>U)U=z};return W1({get:()=>hB({error:J,quantiles:L(Date.now()),count:H,min:W,max:U,sum:V}),update:([z,R])=>_(z,R),modify:([z,R])=>_(z,R)})},HS=(X,J,Y)=>{let G=Y.length;if(!T0(J))return t6();let Z=J[0],$=J.slice(1),Q=oL(X,G,q(),0,Z,Y),K=E8(Q);return $.forEach((H)=>{K.push(oL(X,G,Q.value,Q.consumed,H,Q.rest))}),C6(K,(H)=>[H.quantile,H.value])},oL=(X,J,Y,G,Z,$)=>{let Q=X,K=J,H=Y,V=G,W=Z,U=$,L=X,_=J,z=Y,R=G,j=Z,m=$;while(!0){if(!T0(U))return{quantile:W,value:q(),consumed:V,rest:[]};if(W===1)return{quantile:W,value:F(u2(U)),consumed:V+U.length,rest:[]};let B0=o2(U,(t)=>t<=U[0]),f=W*K,Y0=Q/2*f,N0=V+B0[0].length,G0=Math.abs(N0-f);if(N0<f-Y0){L=Q,_=K,z=E5(U),R=N0,j=W,m=B0[1],Q=L,K=_,H=z,V=R,W=j,U=m;continue}if(N0>f+Y0)return{quantile:W,value:H,consumed:V,rest:U};switch(H._tag){case"None":{L=Q,_=K,z=E5(U),R=N0,j=W,m=B0[1],Q=L,K=_,H=z,V=R,W=j,U=m;continue}case"Some":{let t=Math.abs(f-H.value);if(G0<t){L=Q,_=K,z=E5(U),R=N0,j=W,m=B0[1],Q=L,K=_,H=z,V=R,W=j,U=m;continue}return{quantile:W,value:F(H.value),consumed:V,rest:U}}}}throw new Error("BUG: MetricHook.resolveQuantiles - please report an issue at https://github.com/Effect-TS/effect/issues")};var KS="effect/MetricPair",rL=Symbol.for(KS),BS={_Type:(X)=>X};var uB=(X,J)=>{return{[rL]:BS,metricKey:X,metricState:J,pipe(){return D(this,arguments)}}};var VS="effect/MetricRegistry",oB=Symbol.for(VS);class aL{[oB]=oB;map=M4();snapshot(){let X=[];for(let[J,Y]of this.map)X.push(uB(J,Y.get()));return X}get(X){let J=N(this.map,O6(X),T8);if(J==null){if($Y(X.keyType))return this.getCounter(X);if(EB(X.keyType))return this.getGauge(X);if(TB(X.keyType))return this.getFrequency(X);if(t$(X.keyType))return this.getHistogram(X);if(IB(X.keyType))return this.getSummary(X);throw new Error("BUG: MetricRegistry.get - unknown MetricKeyType - please report an issue at https://github.com/Effect-TS/effect/issues")}else return J}getCounter(X){let J=N(this.map,O6(X),T8);if(J==null){let Y=mB(X);if(!N(this.map,o5(X)))N(this.map,h6(X,Y));J=Y}return J}getFrequency(X){let J=N(this.map,O6(X),T8);if(J==null){let Y=dB(X);if(!N(this.map,o5(X)))N(this.map,h6(X,Y));J=Y}return J}getGauge(X){let J=N(this.map,O6(X),T8);if(J==null){let Y=cB(X,X.keyType.bigint?BigInt(0):0);if(!N(this.map,o5(X)))N(this.map,h6(X,Y));J=Y}return J}getHistogram(X){let J=N(this.map,O6(X),T8);if(J==null){let Y=pB(X);if(!N(this.map,o5(X)))N(this.map,h6(X,Y));J=Y}return J}getSummary(X){let J=N(this.map,O6(X),T8);if(J==null){let Y=fB(X);if(!N(this.map,o5(X)))N(this.map,h6(X,Y));J=Y}return J}}var nB=()=>{return new aL};var AS="effect/Metric",tL=Symbol.for(AS),OS={_Type:(X)=>X,_In:(X)=>X,_Out:(X)=>X},lB=h(Symbol.for("effect/Metric/globalMetricRegistry"),()=>nB()),QQ=function(X,J,Y,G){let Z=Object.assign(($)=>U8($,(Q)=>sB(Z,Q)),{[tL]:OS,keyType:X,unsafeUpdate:J,unsafeValue:Y,unsafeModify:G,register(){return this.unsafeValue([]),this},pipe(){return D(this,arguments)}});return Z};var U1=(X,J)=>rB(SB(X,J));var rB=(X)=>{let J,Y=new WeakMap,G=(Z)=>{if(Z.length===0){if(J!==void 0)return J;return J=lB.get(X),J}let $=Y.get(Z);if($!==void 0)return $;return $=lB.get(xB(X,Z)),Y.set(Z,$),$};return QQ(X.keyType,(Z,$)=>G($).update(Z),(Z)=>G(Z).get(),(Z,$)=>G($).modify(Z))};var iB=(X,J,Y)=>rB(vB(X,J,Y));var aB=B(3,(X,J,Y)=>eL(X,[G1(J,Y)]));var eL=B(2,(X,J)=>{return QQ(X.keyType,(Y,G)=>X.unsafeUpdate(Y,N9(J,G)),(Y)=>X.unsafeValue(N9(J,Y)),(Y,G)=>X.unsafeModify(Y,N9(J,G)))});var sB=B(2,(X,J)=>y6(S7,(Y)=>I(()=>X.unsafeUpdate(J,Y))));var qS="effect/Request",Xw=Symbol.for(qS),LS={_E:(X)=>X,_A:(X)=>X},ri={...s4,[Xw]:LS};var HQ=B(2,(X,J)=>y6(f$,(Y)=>I(()=>{if(Y.has(X)){let G=Y.get(X);if(!G.state.completed)G.state.completed=!0,y7(G.result,J)}})));var k9={Forward:0,Backward:1};class HY{self;stack;direction;count=0;constructor(X,J,Y){this.self=X,this.stack=J,this.direction=Y}clone(){return new HY(this.self,this.stack.slice(),this.direction)}reversed(){return new HY(this.self,this.stack.slice(),this.direction===k9.Forward?k9.Backward:k9.Forward)}next(){let X=this.entry;if(this.count++,this.direction===k9.Forward)this.moveNext();else this.movePrev();switch(X._tag){case"None":return{done:!0,value:this.count};case"Some":return{done:!1,value:X.value}}}get key(){if(this.stack.length>0)return F(this.stack[this.stack.length-1].key);return q()}get value(){if(this.stack.length>0)return F(this.stack[this.stack.length-1].value);return q()}get entry(){return g0(vG(this.stack),(X)=>[X.key,X.value])}get index(){let X=0,J=this.stack;if(J.length===0){let Y=this.self._root;if(Y!=null)return Y.count;return 0}else if(J[J.length-1].left!=null)X=J[J.length-1].left.count;for(let Y=J.length-2;Y>=0;--Y)if(J[Y+1]===J[Y].right){if(++X,J[Y].left!=null)X+=J[Y].left.count}return X}moveNext(){let X=this.stack;if(X.length===0)return;let J=X[X.length-1];if(J.right!=null){J=J.right;while(J!=null)X.push(J),J=J.left}else{X.pop();while(X.length>0&&X[X.length-1].right===J)J=X[X.length-1],X.pop()}}get hasNext(){let X=this.stack;if(X.length===0)return!1;if(X[X.length-1].right!=null)return!0;for(let J=X.length-1;J>0;--J)if(X[J-1].left===X[J])return!0;return!1}movePrev(){let X=this.stack;if(X.length===0)return;let J=X[X.length-1];if(J!=null&&J.left!=null){J=J.left;while(J!=null)X.push(J),J=J.right}else{X.pop();while(X.length>0&&X[X.length-1].left===J)J=X[X.length-1],X.pop()}}get hasPrev(){let X=this.stack;if(X.length===0)return!1;if(X[X.length-1].left!=null)return!0;for(let J=X.length-1;J>0;--J)if(X[J-1].right===X[J])return!0;return!1}}var Jw="effect/RedBlackTree",eB=Symbol.for(Jw),PS={_Key:(X)=>X,_Value:(X)=>X},$a={[eB]:PS,[M](){let X=O(Jw);for(let J of this)X^=N(O(J[0]),C(O(J[1])));return S(this,X)},[P](X){if(Yw(X)){if((this._root?.count??0)!==(X._root?.count??0))return!1;let J=Array.from(X);return Array.from(this).every((Y,G)=>{let Z=J[G];return w(Y[0],Z[0])&&w(Y[1],Z[1])})}return!1},[Symbol.iterator](){let X=[],J=this._root;while(J!=null)X.push(J),J=J.left;return new HY(this,X,k9.Forward)},toString(){return d(this.toJSON())},toJSON(){return{_id:"RedBlackTree",values:Array.from(this).map(r)}},[v](){return this.toJSON()},pipe(){return D(this,arguments)}};var Yw=(X)=>A(X,eB);var Gw=(X)=>Zw(X,k9.Forward);var Zw=(X,J)=>{let Y=X[Symbol.iterator](),G=0;return{[Symbol.iterator]:()=>Zw(X,J),next:()=>{G++;let Z=Y.key;if(J===k9.Forward)Y.moveNext();else Y.movePrev();switch(Z._tag){case"None":return{done:!0,value:G};case"Some":return{done:!1,value:Z.value}}}}};var XV=Gw;var YV=Symbol.for("effect/SortedSet"),fa={[YV]:{_A:(X)=>X},[M](){return N(O(this.keyTree),C(O(YV)),S(this))},[P](X){return $w(X)&&w(this.keyTree,X.keyTree)},[Symbol.iterator](){return XV(this.keyTree)},toString(){return d(this.toJSON())},toJSON(){return{_id:"SortedSet",values:Array.from(this).map(r)}},[v](){return this.toJSON()},pipe(){return D(this,arguments)}};var $w=(X)=>A(X,YV);var vS="effect/Supervisor",KY=Symbol.for(vS),BQ={_T:(X)=>X};class BY{underlying;value0;[KY]=BQ;constructor(X,J){this.underlying=X,this.value0=J}get value(){return this.value0}onStart(X,J,Y,G){this.underlying.onStart(X,J,Y,G)}onEnd(X,J){this.underlying.onEnd(X,J)}onEffect(X,J){this.underlying.onEffect(X,J)}onSuspend(X){this.underlying.onSuspend(X)}onResume(X){this.underlying.onResume(X)}map(X){return new BY(this,N(this.value,o(X)))}zip(X){return new D1(this,X)}}class D1{left;right;_tag="Zip";[KY]=BQ;constructor(X,J){this.left=X,this.right=J}get value(){return E7(this.left.value,this.right.value)}onStart(X,J,Y,G){this.left.onStart(X,J,Y,G),this.right.onStart(X,J,Y,G)}onEnd(X,J){this.left.onEnd(X,J),this.right.onEnd(X,J)}onEffect(X,J){this.left.onEffect(X,J),this.right.onEffect(X,J)}onSuspend(X){this.left.onSuspend(X),this.right.onSuspend(X)}onResume(X){this.left.onResume(X),this.right.onResume(X)}map(X){return new BY(this,N(this.value,o(X)))}zip(X){return new D1(this,X)}}var GV=(X)=>A(X,KY)&&Z9(X,"Zip");class Qw{effect;[KY]=BQ;constructor(X){this.effect=X}get value(){return this.effect}onStart(X,J,Y,G){}onEnd(X,J){}onEffect(X,J){}onSuspend(X){}onResume(X){}map(X){return new BY(this,N(this.value,o(X)))}zip(X){return new D1(this,X)}onRun(X,J){return X()}}var Hw=(X)=>{return new Qw(X)},v4=h("effect/Supervisor/none",()=>Hw(l));var Kw=N4;var Vw="Empty",Nw="AddSupervisor",Ww="RemoveSupervisor",Uw="AndThen",A1={_tag:Vw},VQ=(X,J)=>{return{_tag:Uw,first:X,second:J}},xS=(X,J)=>{return kS(J,z0(X))},kS=(X,J)=>{let Y=X,G=J;while(y0(G)){let Z=Y8(G);switch(Z._tag){case Vw:{G=G8(G);break}case Nw:{Y=Y.zip(Z.supervisor),G=G8(G);break}case Ww:{Y=ZV(Y,Z.supervisor),G=G8(G);break}case Uw:{G=R0(Z.first)(R0(Z.second)(G8(G)));break}}}return Y},ZV=(X,J)=>{if(w(X,J))return v4;else if(GV(X))return ZV(X.left,J).zip(ZV(X.right,J));else return X},NQ=(X)=>{if(w(X,v4))return r8();else if(GV(X))return N(NQ(X.left),b5(NQ(X.right)));else return N7(X)},yS=(X,J)=>{if(w(X,J))return A1;let Y=NQ(X),G=NQ(J),Z=N(G,n3(Y),D7(A1,(Q,K)=>VQ(Q,{_tag:Nw,supervisor:K}))),$=N(Y,n3(G),D7(A1,(Q,K)=>VQ(Q,{_tag:Ww,supervisor:K})));return VQ(Z,$)},Dw=Kw({empty:A1,patch:xS,combine:VQ,diff:yS});var Fw=U1("effect_fiber_started",{incremental:!0}),$V=U1("effect_fiber_active"),_w=U1("effect_fiber_successes",{incremental:!0}),Pw=U1("effect_fiber_failures",{incremental:!0}),Mw=aB(iB("effect_fiber_lifetimes",i$({start:0.5,factor:2,count:35})),"time_unit","milliseconds"),VY="Continue",eS="Done",zw="Yield",Xv={_E:(X)=>X,_A:(X)=>X},WQ=(X)=>{throw new Error(`BUG: FiberRuntime - ${H9(X)} - please report an issue at https://github.com/Effect-TS/effect/issues`)},y9=Symbol.for("effect/internal/fiberRuntime/YieldedOp"),g9=h("effect/internal/fiberRuntime/yieldedOpChannel",()=>({currentOp:null})),NY={[VX]:(X,J,Y)=>{return M0(()=>J.effect_instruction_i1(Y))},["OnStep"]:(X,J,Y)=>{return C0(C0(Y))},[NX]:(X,J,Y)=>{return M0(()=>J.effect_instruction_i2(Y))},[o1]:(X,J,Y)=>{if(X.patchRuntimeFlags(X.currentRuntimeFlags,J.patch),V5(X.currentRuntimeFlags)&&X.isInterrupted())return _0(X.getInterruptedCause());else return C0(Y)},[WX]:(X,J,Y)=>{if(M0(()=>J.effect_instruction_i2(Y)),M0(()=>J.effect_instruction_i0()))return X.pushStack(J),M0(()=>J.effect_instruction_i1());else return l},[UX]:(X,J,Y)=>{let G=M0(()=>J.effect_instruction_i0.next(Y));if(G.done)return C0(G.value);return X.pushStack(J),HX(G.value)}},Jv={[DB]:(X,J,Y,G)=>{return X.processNewInterruptSignal(G.cause),V5(J)?_0(G.cause):Y},[AB]:(X,J,Y,G)=>{throw new Error("It is illegal to have multiple concurrent run loops in a single fiber")},[zB]:(X,J,Y,G)=>{return G.onFiber(X,JB(J)),Y},[OB]:(X,J,Y,G)=>{return T(T7(),()=>Y)}},Yv=(X)=>i8(yA(X),(J)=>l5(bA(J),([Y,G])=>{let Z=new Map,$=[];for(let K of G){$.push(G6(K));for(let H of K)Z.set(H.request,H)}let Q=$.flat();return a8(vw(Y.runAll($),Q,()=>Q.forEach((K)=>{K.listeners.interrupted=!0})),f$,Z)},!1,!1)),Gv=X4();class DQ extends $6{[ZY]=n$;[LB]=Xv;_fiberRefs;_fiberId;_queue=new Array;_children=null;_observers=new Array;_running=!1;_stack=[];_asyncInterruptor=null;_asyncBlockingOn=null;_exitValue=null;_steps=[];_isYielding=!1;currentRuntimeFlags;currentOpCount=0;currentSupervisor;currentScheduler;currentTracer;currentSpan;currentContext;currentDefaultServices;constructor(X,J,Y){super();if(this.currentRuntimeFlags=Y,this._fiberId=X,this._fiberRefs=J,bZ(Y)){let G=this.getFiberRef(S7);Fw.unsafeUpdate(1,G),$V.unsafeUpdate(1,G)}this.refreshRefCache()}commit(){return B1(this)}id(){return this._fiberId}resume(X){this.tell(d7(X))}get status(){return this.ask((X,J)=>J)}get runtimeFlags(){return this.ask((X,J)=>{if(y$(J))return X.currentRuntimeFlags;return J.runtimeFlags})}scope(){return KL(this)}get children(){return this.ask((X)=>Array.from(X.getChildren()))}getChildren(){if(this._children===null)this._children=new Set;return this._children}getInterruptedCause(){return this.getFiberRef(v7)}fiberRefs(){return this.ask((X)=>X.getFiberRefs())}ask(X){return n(()=>{let J=sX(this._fiberId);return this.tell(H1((Y,G)=>{y7(J,I(()=>X(Y,G)))})),Z6(J)})}tell(X){if(this._queue.push(X),!this._running)this._running=!0,this.drainQueueLaterOnExecutor()}get await(){return W5((X)=>{let J=(Y)=>X(g(Y));return this.tell(H1((Y,G)=>{if(Y._exitValue!==null)J(this._exitValue);else Y.addObserver(J)})),I(()=>this.tell(H1((Y,G)=>{Y.removeObserver(J)})))},this.id())}get inheritAll(){return A0((X,J)=>{let Y=X.id(),G=X.getFiberRefs(),Z=J.runtimeFlags,$=this.getFiberRefs(),Q=gK(G,Y,$);X.setFiberRefs(Q);let K=X.getFiberRef(BV),H=N(W4(Z,K),FH(B5),FH(yX));return G$(H)})}get poll(){return I(()=>H8(this._exitValue))}unsafePoll(){return this._exitValue}interruptAsFork(X){return I(()=>this.tell(u$(z6(X))))}unsafeInterruptAsFork(X){this.tell(u$(z6(X)))}addObserver(X){if(this._exitValue!==null)X(this._exitValue);else this._observers.push(X)}removeObserver(X){this._observers=this._observers.filter((J)=>J!==X)}getFiberRefs(){return this.setFiberRef(BV,this.currentRuntimeFlags),this._fiberRefs}unsafeDeleteFiberRef(X){this._fiberRefs=rJ(this._fiberRefs,X)}getFiberRef(X){if(this._fiberRefs.locals.has(X))return this._fiberRefs.locals.get(X)[0][1];return X.initial}setFiberRef(X,J){this._fiberRefs=J1(this._fiberRefs,{fiberId:this._fiberId,fiberRef:X,value:J}),this.refreshRefCache()}refreshRefCache(){this.currentDefaultServices=this.getFiberRef(q6),this.currentTracer=this.currentDefaultServices.unsafeMap.get(X1.key),this.currentSupervisor=this.getFiberRef(zQ),this.currentScheduler=this.getFiberRef(x9),this.currentContext=this.getFiberRef(A6),this.currentSpan=this.currentContext.unsafeMap.get(C4.key)}setFiberRefs(X){this._fiberRefs=X,this.refreshRefCache()}addChild(X){this.getChildren().add(X)}removeChild(X){this.getChildren().delete(X)}transferChildren(X){let J=this._children;if(this._children=null,J!==null&&J.size>0){for(let Y of J)if(Y._exitValue===null)X.add(this.currentRuntimeFlags,Y)}}drainQueueOnCurrentThread(){let X=!0;while(X){let J=VY,Y=globalThis[S4];globalThis[S4]=this;try{while(J===VY)J=this._queue.length===0?eS:this.evaluateMessageWhileSuspended(this._queue.splice(0,1)[0])}finally{this._running=!1,globalThis[S4]=Y}if(this._queue.length>0&&!this._running)if(this._running=!0,J===zw)this.drainQueueLaterOnExecutor(),X=!1;else X=!0;else X=!1}}drainQueueLaterOnExecutor(){this.currentScheduler.scheduleTask(this.run,this.getFiberRef(z5))}drainQueueWhileRunning(X,J){let Y=J;while(this._queue.length>0){let G=this._queue.splice(0,1)[0];Y=Jv[G._tag](this,X,Y,G)}return Y}isInterrupted(){return!cZ(this.getFiberRef(v7))}addInterruptedCause(X){let J=this.getFiberRef(v7);this.setFiberRef(v7,V8(J,X))}processNewInterruptSignal(X){this.addInterruptedCause(X),this.sendInterruptSignalToAllChildren()}sendInterruptSignalToAllChildren(){if(this._children===null||this._children.size===0)return!1;let X=!1;for(let J of this._children)J.tell(u$(z6(this.id()))),X=!0;return X}interruptAllChildren(){if(this.sendInterruptSignalToAllChildren()){let X=this._children.values();this._children=null;let J=!1;return hJ({while:()=>!J,body:()=>{let G=X.next();if(!G.done)return W8(G.value.await);else return I(()=>{J=!0})},step:()=>{}})}return null}reportExitValue(X){if(bZ(this.currentRuntimeFlags)){let J=this.getFiberRef(S7),Y=this.id().startTimeMillis,G=Date.now();switch(Mw.unsafeUpdate(G-Y,J),$V.unsafeUpdate(-1,J),X._tag){case g8:{_w.unsafeUpdate(1,J);break}case y8:{Pw.unsafeUpdate(1,J);break}}}if(X._tag==="Failure"){let J=this.getFiberRef(rX);if(!mX(X.cause)&&J._tag==="Some")this.log("Fiber terminated with an unhandled error",X.cause,J)}}setExitValue(X){this._exitValue=X,this.reportExitValue(X);for(let J=this._observers.length-1;J>=0;J--)this._observers[J](X);this._observers=[]}getLoggers(){return this.getFiberRef(WV)}log(X,J,Y){let G=c(Y)?Y.value:this.getFiberRef(Q$),Z=this.getFiberRef(NV);if(tO(Z,G))return;let $=this.getFiberRef(H$),Q=this.getFiberRef(mJ),K=this.getLoggers(),H=this.getFiberRefs();if(U7(K)>0){let V=I6(this.getFiberRef(q6),C9),W=new Date(V.unsafeCurrentTimeMillis());zU(H,()=>{for(let U of K)U.log({fiberId:this.id(),logLevel:G,message:X,cause:J,context:H,spans:$,annotations:Q,date:W})})}}evaluateMessageWhileSuspended(X){switch(X._tag){case OB:return zw;case DB:{if(this.processNewInterruptSignal(X.cause),this._asyncInterruptor!==null)this._asyncInterruptor(_0(X.cause)),this._asyncInterruptor=null;return VY}case AB:return this._asyncInterruptor=null,this._asyncBlockingOn=null,this.evaluateEffect(X.effect),VY;case zB:return X.onFiber(this,this._exitValue!==null?mq:dq(this.currentRuntimeFlags,this._asyncBlockingOn)),VY;default:return WQ(X)}}evaluateEffect(X){this.currentSupervisor.onResume(this);try{let J=V5(this.currentRuntimeFlags)&&this.isInterrupted()?_0(this.getInterruptedCause()):X;while(J!==null){let Y=J,G=this.runLoop(Y);if(G===y9){let Z=g9.currentOp;if(g9.currentOp=null,Z._op===DX)if(qH(this.currentRuntimeFlags))this.tell(ZL()),this.tell(d7(a0)),J=null;else J=a0;else if(Z._op===i4)J=null}else{this.currentRuntimeFlags=N(this.currentRuntimeFlags,kZ(yX));let Z=this.interruptAllChildren();if(Z!==null)J=T(Z,()=>G);else{if(this._queue.length===0)this.setExitValue(G);else this.tell(d7(G));J=null}}}}finally{this.currentSupervisor.onSuspend(this)}}start(X){if(!this._running){this._running=!0;let J=globalThis[S4];globalThis[S4]=this;try{this.evaluateEffect(X)}finally{if(this._running=!1,globalThis[S4]=J,this._queue.length>0)this.drainQueueLaterOnExecutor()}}else this.tell(d7(X))}startFork(X){this.tell(d7(X))}patchRuntimeFlags(X,J){let Y=O7(X,J);return globalThis[S4]=this,this.currentRuntimeFlags=Y,Y}initiateAsync(X,J){let Y=!1,G=(Z)=>{if(!Y)Y=!0,this.tell(d7(Z))};if(V5(X))this._asyncInterruptor=G;try{J(G)}catch(Z){G(k0(j8(Z)))}}pushStack(X){if(this._stack.push(X),X._op==="OnStep")this._steps.push({refs:this.getFiberRefs(),flags:this.currentRuntimeFlags})}popStack(){let X=this._stack.pop();if(X){if(X._op==="OnStep")this._steps.pop();return X}return}getNextSuccessCont(){let X=this.popStack();while(X){if(X._op!==BX)return X;X=this.popStack()}}getNextFailCont(){let X=this.popStack();while(X){if(X._op!==VX&&X._op!==WX&&X._op!==UX)return X;X=this.popStack()}}[OU](X){return I(()=>J5(this.currentContext,X))}["Left"](X){return h0(X.left)}["None"](X){return h0(new P9)}["Right"](X){return C0(X.right)}["Some"](X){return C0(X.value)}["Micro"](X){return gJ((J)=>{let Y=J,G=XL(sq(X,this.currentContext));return G.addObserver((Z)=>{if(Z._tag==="Success")return Y(C0(Z.value));switch(Z.cause._tag){case"Interrupt":return Y(_0(z6(h8)));case"Fail":return Y(h0(Z.cause.error));case"Die":return Y(M7(Z.cause.defect))}}),gJ((Z)=>{Y=($)=>{Z(l)},G.unsafeInterrupt()})})}[qG](X){let J=M0(()=>X.effect_instruction_i0()),Y=this.getNextSuccessCont();if(Y!==void 0){if(!(Y._op in NY))WQ(Y);return NY[Y._op](this,Y,J)}else return g9.currentOp=C0(J),y9}[g8](X){let J=X,Y=this.getNextSuccessCont();if(Y!==void 0){if(!(Y._op in NY))WQ(Y);return NY[Y._op](this,Y,J.effect_instruction_i0)}else return g9.currentOp=J,y9}[y8](X){let J=X.effect_instruction_i0,Y=this.getNextFailCont();if(Y!==void 0)switch(Y._op){case BX:case NX:if(!(V5(this.currentRuntimeFlags)&&this.isInterrupted()))return M0(()=>Y.effect_instruction_i1(J));else return _0(oZ(J));case"OnStep":if(!(V5(this.currentRuntimeFlags)&&this.isInterrupted()))return C0(_0(J));else return _0(oZ(J));case o1:if(this.patchRuntimeFlags(this.currentRuntimeFlags,Y.patch),V5(this.currentRuntimeFlags)&&this.isInterrupted())return _0(V8(J,this.getInterruptedCause()));else return _0(J);default:WQ(Y)}else return g9.currentOp=_0(J),y9}[LG](X){return M0(()=>X.effect_instruction_i0(this,JB(this.currentRuntimeFlags)))}["Blocked"](X){let J=this.getFiberRefs(),Y=this.currentRuntimeFlags;if(this._steps.length>0){let G=[],Z=this._steps[this._steps.length-1],$=this.popStack();while($&&$._op!=="OnStep")G.push($),$=this.popStack();this.setFiberRefs(Z.refs),this.currentRuntimeFlags=Z.flags;let Q=tK(Z.refs,J),K=W4(Z.flags,Y);return C0(yJ(X.effect_instruction_i0,A0((H)=>{while(G.length>0)H.pushStack(G.pop());return H.setFiberRefs(eK(H.id(),H.getFiberRefs())(Q)),H.currentRuntimeFlags=O7(K)(H.currentRuntimeFlags),X.effect_instruction_i1})))}return i0((G)=>T(x4(mH(X.effect_instruction_i0)),()=>G(X.effect_instruction_i1)))}["RunBlocked"](X){return Yv(X.effect_instruction_i0)}[a4](X){let J=X.effect_instruction_i0,Y=this.currentRuntimeFlags,G=O7(Y,J);if(V5(G)&&this.isInterrupted())return _0(this.getInterruptedCause());else if(this.patchRuntimeFlags(this.currentRuntimeFlags,J),X.effect_instruction_i1){let Z=W4(G,Y);return this.pushStack(new dH(Z,X)),M0(()=>X.effect_instruction_i1(Y))}else return a0}[VX](X){return this.pushStack(X),X.effect_instruction_i0}["OnStep"](X){return this.pushStack(X),X.effect_instruction_i0}[BX](X){return this.pushStack(X),X.effect_instruction_i0}[NX](X){return this.pushStack(X),X.effect_instruction_i0}[i4](X){return this._asyncBlockingOn=X.effect_instruction_i1,this.initiateAsync(this.currentRuntimeFlags,X.effect_instruction_i0),g9.currentOp=X,y9}[DX](X){return this._isYielding=!1,g9.currentOp=X,y9}[WX](X){let{effect_instruction_i0:J,effect_instruction_i1:Y}=X;if(J())return this.pushStack(X),Y();else return a0}[UX](X){return NY[UX](this,X,void 0)}[K9](X){return M0(()=>X.commit())}runLoop(X){let J=X;this.currentOpCount=0;while(!0){if((this.currentRuntimeFlags&xZ)!==0)this.currentSupervisor.onEffect(this,J);if(this._queue.length>0)J=this.drainQueueWhileRunning(this.currentRuntimeFlags,J);if(!this._isYielding){this.currentOpCount+=1;let Y=this.currentScheduler.shouldYield(this);if(Y!==!1){this._isYielding=!0,this.currentOpCount=0;let G=J;J=T(T7({priority:Y}),()=>G)}}try{if(J=this.currentTracer.context(()=>{if(Gv!==J[w9]._V)return uX(`Cannot execute an Effect versioned ${J[w9]._V} with a Runtime of version ${X4()}`);return this[J._op](J)},this),J===y9){let Y=g9.currentOp;if(Y._op===DX||Y._op===i4)return y9;return g9.currentOp=null,Y._op===g8||Y._op===y8?Y:_0(j8(Y))}}catch(Y){if(J!==y9&&!A(J,"_op")||!(J._op in this))J=uX(`Not a valid effect: ${H9(J)}`);else if(sH(Y))J=_0(V8(j8(Y),z6(h8)));else J=M7(Y)}}}run=()=>{this.drainQueueOnCurrentThread()}}var NV=h("effect/FiberRef/currentMinimumLogLevel",()=>D8(eO("Info"))),Rw=(X)=>V1((J)=>{let Y=mK(J.context,q6);I6(Y,b7).unsafe.log(X.log(J))});var Cw=h(Symbol.for("effect/Logger/defaultLogger"),()=>Rw(FB));var Tw=h(Symbol.for("effect/Logger/tracerLogger"),()=>V1(({annotations:X,cause:J,context:Y,fiberId:G,logLevel:Z,message:$})=>{let Q=Q4(T4(Y,A6),C4);if(Q._tag==="None"||Q.value._tag==="ExternalSpan")return;let K=J5(T4(Y,q6),C9),H={};for(let[V,W]of X)H[V]=W;if(H["effect.fiberId"]=s3(G),H["effect.logLevel"]=Z.label,J!==null&&J._tag!=="Empty")H["effect.cause"]=z4(J,{renderErrorCause:!0});Q.value.event(H9(Array.isArray($)?$[0]:$),K.unsafeCurrentTimeNanos(),H)}));var WV=h(Symbol.for("effect/FiberRef/currentLoggers"),()=>iH(N7(Cw,Tw)));var Ew=B((X)=>$X(X[0]),(X,J,Y)=>A0((G)=>{let Z=Y?.batching===!0||Y?.batching==="inherit"&&G.getFiberRef(K$);if(Y?.discard)return UB(Y.concurrency,()=>O1(JY,Y?.concurrentFinalizers)(($)=>Z?l5(X,(Q,K)=>$(J(Q,K)),!0,!1,1):i8(X,(Q,K)=>$(J(Q,K)))),()=>O1(j$,Y?.concurrentFinalizers)(($)=>l5(X,(Q,K)=>$(J(Q,K)),Z,!1)),($)=>O1(S$($),Y?.concurrentFinalizers)((Q)=>l5(X,(K,H)=>Q(J(K,H)),Z,!1,$)));return UB(Y?.concurrency,()=>O1(JY,Y?.concurrentFinalizers)(($)=>Z?QV(X,1,(Q,K)=>$(J(Q,K)),!0):M8(X,(Q,K)=>$(J(Q,K)))),()=>O1(j$,Y?.concurrentFinalizers)(($)=>UV(X,(Q,K)=>$(J(Q,K)),Z)),($)=>O1(S$($),Y?.concurrentFinalizers)((Q)=>QV(X,$,(K,H)=>Q(J(K,H)),Z)))})),UV=(X,J,Y)=>n(()=>{let G=p(X),Z=new Array(G.length);return w0(l5(G,(Q,K)=>T(J(Q,K),(H)=>I(()=>Z[K]=H)),Y,!1),g(Z))}),l5=(X,J,Y,G,Z)=>i0(($)=>lH((Q)=>A0((K)=>{let H=Array.from(X).reverse(),V=H.length;if(V===0)return l;let W=0,U=!1,L=Z?Math.min(H.length,Z):H.length,_=new Set,z=new Array,R=()=>_.forEach((i)=>{i.currentScheduler.scheduleTask(()=>{i.unsafeInterruptAsFork(K.id())},0)}),j=new Array,m=new Array,B0=new Array,f=()=>{let i=z.filter(({exit:O0})=>O0._tag==="Failure").sort((O0,q0)=>O0.index<q0.index?-1:O0.index===q0.index?0:1).map(({exit:O0})=>O0);if(i.length===0)i.push(a0);return i},Y0=(i,O0=!1)=>{let q0=_9(Q(i)),W0=$v(q0,K,K.currentRuntimeFlags,c7);return K.currentScheduler.scheduleTask(()=>{if(O0)W0.unsafeInterruptAsFork(K.id());W0.resume(q0)},0),W0},N0=()=>{if(!G)V-=H.length,H=[];U=!0,R()},G0=Y?uH:P8,t=Y0(W5((i)=>{let O0=(W0,S0)=>{if(W0._op==="Blocked")B0.push(W0);else if(z.push({index:S0,exit:W0}),W0._op==="Failure"&&!U)N0()},q0=()=>{if(H.length>0){let W0=H.pop(),S0=W++,q8=()=>{let Q8=H.pop();return S0=W++,T(T7(),()=>T(G0($(J(Q8,S0))),p8))},p8=(Q8)=>{if(H.length>0){if(O0(Q8,S0),H.length>0)return q8()}return g(Q8)},u6=T(G0($(J(W0,S0))),p8),f8=Y0(u6);if(j.push(f8),_.add(f8),U)f8.currentScheduler.scheduleTask(()=>{f8.unsafeInterruptAsFork(K.id())},0);f8.addObserver((Q8)=>{let o6;if(Q8._op==="Failure")o6=Q8;else o6=Q8.effect_instruction_i0;if(m.push(f8),_.delete(f8),O0(o6,S0),z.length===V)i(g(K0(_4(f(),{parallel:!0}),()=>a0)));else if(B0.length+z.length===V){let u4=B0.map((e9)=>e9.effect_instruction_i0).reduce(IJ);i(g(yJ(u4,l5([K0(_4(f(),{parallel:!0}),()=>a0),...B0.map((e9)=>e9.effect_instruction_i1)],(e9)=>e9,Y,!0,Z))))}else q0()})}};for(let W0=0;W0<L;W0++)q0()}));return W8(u5(p5($(B1(t))),aX({onFailure:()=>{N0();let i=B0.length+1,O0=Math.min(typeof Z==="number"?Z:B0.length,B0.length),q0=Array.from(B0);return W5((W0)=>{let S0=[],q8=0,p8=0,u6=(Q8,o6)=>(u4)=>{if(S0[Q8]=u4,q8++,q8===i)W0(CG(_4(S0,{parallel:!0})));if(q0.length>0&&o6)f8()},f8=()=>{Y0(q0.pop(),!0).addObserver(u6(p8,!0)),p8++};t.addObserver(u6(p8,!1)),p8++;for(let Q8=0;Q8<O0;Q8++)f8()})},onSuccess:()=>M8(m,(i)=>i.inheritAll)})))}))),QV=(X,J,Y,G)=>n(()=>{let Z=p(X),$=new Array(Z.length);return w0(l5(Z,(K,H)=>o(Y(K,H),(V)=>$[H]=V),G,!1,J),g($))});var x4=(X)=>Qv(X,c7);var Zv=(X,J,Y,G=null)=>{let Z=Iw(X,J,Y,G);return Z.resume(X),Z},$v=(X,J,Y,G=null)=>{return Iw(X,J,Y,G)},Iw=(X,J,Y,G=null)=>{let Z=PZ(),$=J.getFiberRefs(),Q=bK($,Z),K=new DQ(Z,Q,Y),H=T4(Q,A6),V=K.currentSupervisor;return V.onStart(H,X,F(J),K),K.addObserver((U)=>V.onEnd(U,K)),(G!==null?G:N(J.getFiberRef(tZ),K0(()=>J.scope()))).add(Y,K),K},Qv=(X,J)=>A0((Y,G)=>g(Zv(X,Y,G.runtimeFlags,J)));var HV=(X)=>R9((J)=>$0(Q4(J,L5),{onNone:()=>X,onSome:(Y)=>{switch(Y.strategy._tag){case"Parallel":return X;case"Sequential":case"ParallelN":return T(iX(Y,j$),(G)=>b9(X,G))}}})),Aw=(X)=>(J)=>R9((Y)=>$0(Q4(Y,L5),{onNone:()=>J,onSome:(G)=>{if(G.strategy._tag==="ParallelN"&&G.strategy.parallelism===X)return J;return T(iX(G,S$(X)),(Z)=>b9(J,Z))}}));var O1=(X,J)=>(Y)=>R9((G)=>$0(Q4(G,L5),{onNone:()=>Y(x),onSome:(Z)=>{if(J===!0){let $=X._tag==="Parallel"?HV:X._tag==="Sequential"?KV:Aw(X.parallelism);switch(Z.strategy._tag){case"Parallel":return $(Y(HV));case"Sequential":return $(Y(KV));case"ParallelN":return $(Y(Aw(Z.strategy.parallelism)))}}else return Y(x)}}));var KV=(X)=>R9((J)=>$0(Q4(J,L5),{onNone:()=>X,onSome:(Y)=>{switch(Y.strategy._tag){case"Sequential":return X;case"Parallel":case"ParallelN":return T(iX(Y,JY),(G)=>b9(X,G))}}}));var L5=u0("effect/Scope");var Hv=(X,J)=>{if(X.state._tag==="Open")X.state.finalizers.add(J)},Kv={[B$]:B$,[V$]:V$,pipe(){return D(this,arguments)},fork(X){return I(()=>{let J=jw(X);if(this.state._tag==="Closed")return J.state=this.state,J;let Y=(G)=>J.close(G);return this.state.finalizers.add(Y),Hv(J,(G)=>I(()=>{if(this.state._tag==="Open")this.state.finalizers.delete(Y)})),J})},close(X){return n(()=>{if(this.state._tag==="Closed")return l;let J=Array.from(this.state.finalizers.values()).reverse();if(this.state={_tag:"Closed",exit:X},J.length===0)return l;return iK(this.strategy)?N(M8(J,(Y)=>P8(Y(X))),T((Y)=>N(_4(Y),g0(pJ),K0(()=>a0)))):aK(this.strategy)?N(UV(J,(Y)=>P8(Y(X)),!1),T((Y)=>N(_4(Y,{parallel:!0}),g0(pJ),K0(()=>a0)))):N(QV(J,this.strategy.parallelism,(Y)=>P8(Y(X)),!1),T((Y)=>N(_4(Y,{parallel:!0}),g0(pJ),K0(()=>a0))))})},addFinalizer(X){return n(()=>{if(this.state._tag==="Closed")return X(this.state.exit);return this.state.finalizers.add(X),l})}},jw=(X=n5)=>{let J=Object.create(Kv);return J.strategy=X,J.state={_tag:"Open",finalizers:new Set},J},i5=(X=n5)=>I(()=>jw(X)),b9=B(2,(X,J)=>P4(X,g5(CX(L5,J))));var Sw=(X)=>F4(X,{differ:Dw,fork:A1});var BV=VO(LH),zQ=Sw(v4);var a5=B(2,(X,J)=>i0((Y)=>S8(Y(X),{onFailure:(G)=>S8(J,{onFailure:(Z)=>k0(V8(G,Z)),onSuccess:()=>k0(G)}),onSuccess:(G)=>n0(J,G)}))),vw=(X,J,Y)=>L4((G)=>T(T(x4(k6(X)),(Z)=>W5(($)=>{let Q=J.map((V)=>V.listeners.count),K=()=>{if(Q.every((V)=>V===0)){if(J.every((V)=>{if(V.result.state.current._tag==="Pending")return!0;else if(V.result.state.current._tag==="Done"&&cJ(V.result.state.current.effect)&&V.result.state.current.effect._tag==="Failure"&&pZ(V.result.state.current.effect.cause))return!0;else return!1}))H.forEach((V)=>V()),Y?.(),$(D5(Z))}};Z.addObserver((V)=>{H.forEach((W)=>W()),$(V)});let H=J.map((V,W)=>{let U=(L)=>{Q[W]=L,K()};return V.listeners.addObserver(U),()=>V.listeners.removeObserver(U)});return K(),I(()=>{H.forEach((V)=>V())})})),()=>n(()=>{let Z=J.flatMap(($)=>{if(!$.state.completed)return[$];return[]});return i8(Z,($)=>HQ($.request,uJ(G)))})));var q1=P7,h9=j8,DY=z6;var wV=P9;var Dv="effect/ScheduleInterval",FV=Symbol.for(Dv),zv={[FV]:FV,startMillis:0,endMillis:0};var L1=x7;var MV=iX;var wQ=Symbol.for("effect/DateTime"),FQ=Symbol.for("effect/DateTime/TimeZone"),yw={[wQ]:wQ,pipe(){return D(this,arguments)},[v](){return this.toString()},toJSON(){return MQ(this).toJSON()}},kt={...yw,_tag:"Utc",[M](){return S(this,Q9(this.epochMillis))},[P](X){return CV(X)&&X._tag==="Utc"&&this.epochMillis===X.epochMillis},toString(){return`DateTime.Utc(${MQ(this).toJSON()})`}},yt={...yw,_tag:"Zoned",[M](){return N(Q9(this.epochMillis),C(O(this.zone)),S(this))},[P](X){return CV(X)&&X._tag==="Zoned"&&this.epochMillis===X.epochMillis&&w(this.zone,X.zone)},toString(){return`DateTime.Zoned(${cw(this)})`}},gw={[FQ]:FQ,[v](){return this.toString()}},gt={...gw,_tag:"Named",[M](){return S(this,D0(`Named:${this.id}`))},[P](X){return PQ(X)&&X._tag==="Named"&&this.id===X.id},toString(){return`TimeZone.Named(${this.id})`},toJSON(){return{_id:"TimeZone",_tag:"Named",id:this.id}}},bt={...gw,_tag:"Offset",[M](){return S(this,D0(`Offset:${this.offset}`))},[P](X){return PQ(X)&&X._tag==="Offset"&&this.offset===X.offset},toString(){return`TimeZone.Offset(${hw(this.offset)})`},toJSON(){return{_id:"TimeZone",_tag:"Offset",offset:this.offset}}};var CV=(X)=>A(X,wQ);var PQ=(X)=>A(X,FQ);var MQ=(X)=>new Date(X.epochMillis),RQ=(X)=>{if(X._tag==="Utc")return new Date(X.epochMillis);else if(X.zone._tag==="Offset")return new Date(X.epochMillis+X.zone.offset);else if(X.adjustedEpochMillis!==void 0)return new Date(X.adjustedEpochMillis);let J=X.zone.format.formatToParts(X.epochMillis).filter((G)=>G.type!=="literal"),Y=new Date(0);return Y.setUTCFullYear(Number(J[2].value),Number(J[0].value)-1,Number(J[1].value)),Y.setUTCHours(Number(J[3].value),Number(J[4].value),Number(J[5].value),Number(J[6].value)),X.adjustedEpochMillis=Y.getTime(),Y},bw=(X)=>{return RQ(X).getTime()-dw(X)},hw=(X)=>{let J=Math.abs(X),Y=Math.floor(J/3600000),G=Math.round(J%3600000/60000);return`${X<0?"-":"+"}${String(Y).padStart(2,"0")}:${String(G).padStart(2,"0")}`},mw=(X)=>hw(bw(X)),dw=(X)=>X.epochMillis;var RV=(X)=>{let J=RQ(X);return X._tag==="Utc"?J.toISOString():`${J.toISOString().slice(0,-1)}${mw(X)}`},cw=(X)=>X.zone._tag==="Offset"?RV(X):`${RV(X)}[${X.zone.id}]`;var EV=Symbol.for("effect/Cron"),it={[EV]:EV,[P](X){return ow(X)&&Sv(this,X)},[M](){return N(O(this.tz),C(J8(p(this.seconds))),C(J8(p(this.minutes))),C(J8(p(this.hours))),C(J8(p(this.days))),C(J8(p(this.months))),C(J8(p(this.weekdays))),S(this))},toString(){return d(this.toJSON())},toJSON(){return{_id:"Cron",tz:this.tz,seconds:p(this.seconds),minutes:p(this.minutes),hours:p(this.hours),days:p(this.days),months:p(this.months),weekdays:p(this.weekdays)}},[v](){return this.toJSON()},pipe(){return D(this,arguments)}},ow=(X)=>A(X,EV);var fw=Symbol.for("effect/Cron/errors/ParseError"),at={_tag:"ParseError",[fw]:fw};var Iv=B6((X,J)=>w1(X.seconds,J.seconds)&&w1(X.minutes,J.minutes)&&w1(X.hours,J.hours)&&w1(X.days,J.days)&&w1(X.months,J.months)&&w1(X.weekdays,J.weekdays)),jv=NG(VG),w1=(X,J)=>jv(p(X),p(J)),Sv=B(2,(X,J)=>Iv(X,J));class sw{permits;waiters=new Set;taken=0;constructor(X){this.permits=X}get free(){return this.permits-this.taken}take=(X)=>pX((J)=>{if(this.free<X){let Y=()=>{if(this.free<X)return;this.waiters.delete(Y),this.taken+=X,J(g(X))};return this.waiters.add(Y),I(()=>{this.waiters.delete(Y)})}return this.taken+=X,J(g(X))});updateTaken=(X)=>A0((J)=>{if(this.taken=X(this.taken),this.waiters.size>0)J.getFiberRef(x9).scheduleTask(()=>{let Y=this.waiters.values(),G=Y.next();while(G.done===!1&&this.free>0)G.value(),G=Y.next()},J.getFiberRef(z5));return g(this.free)});release=(X)=>this.updateTaken((J)=>J-X);releaseAll=this.updateTaken((X)=>0);withPermits=(X)=>(J)=>i0((Y)=>T(Y(this.take(X)),(G)=>a5(Y(J),this.release(G))));withPermitsIfAvailable=(X)=>(J)=>i0((Y)=>n(()=>{if(this.free<X)return eJ;return this.taken+=X,a5(Y(I$(J)),this.release(X))}))}var f7=(X)=>new sw(X);class tw extends $6{isOpen;waiters=[];scheduled=!1;constructor(X){super();this.isOpen=X}commit(){return this.await}unsafeSchedule(X){if(this.scheduled||this.waiters.length===0)return l;return this.scheduled=!0,X.currentScheduler.scheduleTask(this.flushWaiters,X.getFiberRef(z5)),l}flushWaiters=()=>{this.scheduled=!1;let X=this.waiters;this.waiters=[];for(let J=0;J<X.length;J++)X[J](a0)};open=A0((X)=>{if(this.isOpen)return l;return this.isOpen=!0,this.unsafeSchedule(X)});release=A0((X)=>{if(this.isOpen)return l;return this.unsafeSchedule(X)});await=pX((X)=>{if(this.isOpen)return X(l);return this.waiters.push(X),I(()=>{let J=this.waiters.indexOf(X);if(J!==-1)this.waiters.splice(J,1)})});unsafeClose(){this.isOpen=!1}close=I(()=>{this.isOpen=!1});whenOpen=(X)=>{return w0(this.await,X)}}var vV=(X)=>new tw(X??!1);var u7=B(2,(X,J)=>i0((Y)=>T(J.fork(n5),(G)=>N(Y(X),u5((Z)=>G.close(Z)),x4,U8((Z)=>G.addFinalizer(()=>L4(($)=>w($,Z.id())?l:W8(D5(Z)))))))));var zY=Symbol.for("effect/ManagedRuntime");var gV=(X)=>(J,Y)=>{let G=PZ(),Z=[[A6,[[G,X.context]]]];if(Y?.scheduler)Z.push([x9,[[G,Y.scheduler]]]);let $=uO(X.fiberRefs,{entries:Z,forkAs:G});if(Y?.updateRefs)$=Y.updateRefs($,G);let Q=new DQ(G,$,X.runtimeFlags),K=J;if(Y?.scope)K=T(MV(Y.scope,n5),(V)=>w0(N$(V,L4((W)=>w(W,Q.id())?l:j7(Q,W))),u5(J,(W)=>L1(V,W))));let H=Q.currentSupervisor;if(H!==v4)H.onStart(X.context,K,q(),Q),Q.addObserver((V)=>H.onEnd(V,Q));if(c7.add(X.runtimeFlags,Q),Y?.immediate===!1)Q.resume(K);else Q.start(K);return Q};var bV=(X)=>(J)=>{let Y=hV(X)(J);if(Y._tag==="Failure")throw JF(Y.effect_instruction_i0);else return Y.effect_instruction_i0};class ew extends Error{fiber;_tag="AsyncFiberException";constructor(X){super(`Fiber #${X.id().id} cannot be resolved synchronously. This is caused by using runSync on an effect that performs async work`);this.fiber=X,this.name=this._tag,this.stack=this.message}}var uv=(X)=>{let J=Error.stackTraceLimit;Error.stackTraceLimit=0;let Y=new ew(X);return Error.stackTraceLimit=J,Y};var kV=Symbol.for("effect/Runtime/FiberFailure"),CQ=Symbol.for("effect/Runtime/FiberFailure/Cause");class XF extends Error{[kV];[CQ];constructor(X){super();this[kV]=kV,this[CQ]=X;let J=rZ(X);if(J.length>0){let Y=J[0];this.name=Y.name,this.message=Y.message,this.stack=Y.stack}if(this.name=`(FiberFailure) ${this.name}`,this.message===void 0||this.message.length===0)this.message="An error has occurred"}toJSON(){return{_id:"FiberFailure",cause:this[CQ].toJSON()}}toString(){return"(FiberFailure) "+(this.stack??this.message)}[v](){return this.toString()}}var JF=(X)=>{let J=Error.stackTraceLimit;Error.stackTraceLimit=0;let Y=new XF(X);return Error.stackTraceLimit=J,Y};var ov=(X)=>{let J=X;switch(J._op){case"Failure":case"Success":return J;case"Left":return M9(J.left);case"Right":return C0(J.right);case"Some":return C0(J.value);case"None":return M9(P9())}},hV=(X)=>(J)=>{let Y=ov(J);if(Y)return Y;let G=new WB,Z=gV(X)(J,{scheduler:G});G.flush();let $=Z.unsafePoll();if($)return $;return fJ(J$(uv(Z),U$(Z)))};class YF{context;runtimeFlags;fiberRefs;constructor(X,J,Y){this.context=X,this.runtimeFlags=J,this.fiberRefs=Y}pipe(){return D(this,arguments)}}var GF=(X)=>new YF(X.context,X.runtimeFlags,X.fiberRefs);var ZF=gZ(B5,TJ,CJ),TQ=GF({context:y5(),runtimeFlags:ZF,fiberRefs:oO()});var mV=bV(TQ);var av="effect/Layer",BF=Symbol.for(av),sv={_RIn:(X)=>X,_E:(X)=>X,_ROut:(X)=>X},y00={[BF]:sv,pipe(){return D(this,arguments)}};var oV=w9,d9=N5;var w6=Ew;var zF=W5;var c9=k0;var $8=g;var Q6=n;var d0=l;var qY=O4,LY=fX;var w5=i0;var j0=o;var wY=C7;var y4=R7;var P0=T;var nV=F9;var lV=nH;var rV=mV;var AF=A6,OF=z5;var iV=x9;var t5=Symbol.for("effect/PubSub/AbsentValue");class cx{replayBuffer;publisherHead={value:t5,subscribers:0,next:null};publisherTail=this.publisherHead;publisherIndex=0;subscribersIndex=0;capacity=Number.MAX_SAFE_INTEGER;constructor(X){this.replayBuffer=X}replayWindow(){return this.replayBuffer?new LF(this.replayBuffer):fx}isEmpty(){return this.publisherHead===this.publisherTail}isFull(){return!1}size(){return this.publisherIndex-this.subscribersIndex}publish(X){let J=this.publisherTail.subscribers;if(J!==0)this.publisherTail.next={value:X,subscribers:J,next:null},this.publisherTail=this.publisherTail.next,this.publisherIndex+=1;if(this.replayBuffer)this.replayBuffer.offer(X);return!0}publishAll(X){if(this.publisherTail.subscribers!==0)for(let J of X)this.publish(J);else if(this.replayBuffer)this.replayBuffer.offerAll(X);return L0()}slide(){if(this.publisherHead!==this.publisherTail)this.publisherHead=this.publisherHead.next,this.publisherHead.value=t5,this.subscribersIndex+=1;if(this.replayBuffer)this.replayBuffer.slide()}subscribe(){return this.publisherTail.subscribers+=1,new qF(this,this.publisherTail,this.publisherIndex,!1)}}class qF{self;subscriberHead;subscriberIndex;unsubscribed;constructor(X,J,Y,G){this.self=X,this.subscriberHead=J,this.subscriberIndex=Y,this.unsubscribed=G}isEmpty(){if(this.unsubscribed)return!0;let X=!0,J=!0;while(J)if(this.subscriberHead===this.self.publisherTail)J=!1;else if(this.subscriberHead.next.value!==t5)X=!1,J=!1;else this.subscriberHead=this.subscriberHead.next,this.subscriberIndex+=1;return X}size(){if(this.unsubscribed)return 0;return this.self.publisherIndex-Math.max(this.subscriberIndex,this.self.subscribersIndex)}poll(X){if(this.unsubscribed)return X;let J=!0,Y=X;while(J)if(this.subscriberHead===this.self.publisherTail)J=!1;else{let G=this.subscriberHead.next.value;if(G!==t5){if(Y=G,this.subscriberHead.subscribers-=1,this.subscriberHead.subscribers===0)this.self.publisherHead=this.self.publisherHead.next,this.self.publisherHead.value=t5,this.self.subscribersIndex+=1;J=!1}this.subscriberHead=this.subscriberHead.next,this.subscriberIndex+=1}return Y}pollUpTo(X){let J=[],Y=t5,G=0;while(G!==X){let Z=this.poll(Y);if(Z===Y)G=X;else J.push(Z),G+=1}return K8(J)}unsubscribe(){if(!this.unsubscribed){this.unsubscribed=!0,this.self.publisherTail.subscribers-=1;while(this.subscriberHead!==this.self.publisherTail){if(this.subscriberHead.next.value!==t5){if(this.subscriberHead.subscribers-=1,this.subscriberHead.subscribers===0)this.self.publisherHead=this.self.publisherHead.next,this.self.publisherHead.value=t5,this.self.subscribersIndex+=1}this.subscriberHead=this.subscriberHead.next}}}}class px{capacity;constructor(X){this.capacity=X}head={value:t5,next:null};tail=this.head;size=0;index=0;slide(){this.index++}offer(X){if(this.tail.value=X,this.tail.next={value:t5,next:null},this.tail=this.tail.next,this.size===this.capacity)this.head=this.head.next;else this.size+=1}offerAll(X){for(let J of X)this.offer(J)}}class LF{buffer;head;index;remaining;constructor(X){this.buffer=X,this.index=X.index,this.remaining=X.size,this.head=X.head}fastForward(){while(this.index<this.buffer.index)this.head=this.head.next,this.index++}take(){if(this.remaining===0)return;else if(this.index<this.buffer.index)this.fastForward();this.remaining--;let X=this.head.value;return this.head=this.head.next,X}takeN(X){if(this.remaining===0)return L0();else if(this.index<this.buffer.index)this.fastForward();let J=Math.min(X,this.remaining),Y=new Array(J);for(let G=0;G<J;G++){let Z=this.head.value;this.head=this.head.next,Y[G]=Z}return this.remaining-=J,B8(Y)}takeAll(){return this.takeN(this.remaining)}}var fx={remaining:0,take:()=>{return},takeN:()=>L0(),takeAll:()=>L0()};var ix="effect/ChannelChildExecutorDecision",tV=Symbol.for(ix),l70={[tV]:tV};var Xk="effect/ChannelUpstreamPullStrategy",MF=Symbol.for(Xk),Jk={_A:(X)=>X},s70={[MF]:Jk};var qk="effect/Channel",MY=Symbol.for(qk),Lk={_Env:(X)=>X,_InErr:(X)=>X,_InElem:(X)=>X,_InDone:(X)=>X,_OutErr:(X)=>X,_OutElem:(X)=>X,_OutDone:(X)=>X},GX0={[MY]:Lk,pipe(){return D(this,arguments)}};var wk=Symbol.for("effect/ChannelState"),Fk={_E:(X)=>X,_R:(X)=>X},QX0={[wk]:Fk};var Ck="effect/ChannelUpstreamPullRequest",vF=Symbol.for(Ck),Tk={_A:(X)=>X},WX0={[vF]:Tk};var gk="effect/ChannelMergeDecision",cF=Symbol.for(gk),gX0={[cF]:{_R:(X)=>X,_E0:(X)=>X,_Z0:(X)=>X,_E:(X)=>X,_Z:(X)=>X}};var dk="effect/ChannelMergeState",QN=Symbol.for(dk),mX0={[QN]:QN};var pk="effect/ChannelMergeStrategy",HN=Symbol.for(pk),uX0={[HN]:HN};var fQ=Symbol.for("effect/Sink");var xN="WithSTMRuntime",uQ="OnFailure",kN="OnRetry",oQ="OnSuccess",__="Provide",yN="Sync",gN="Succeed",bN="Retry",hN="Fail",mN="Die",dN="Interrupt";var p9="Fail",f9="Die",u9="Interrupt",e5="Succeed",o9="Retry";var yY="Done",gY="Suspend";class bY{value;constructor(X){this.value=X}}var R_=(X,J)=>({ref:X,isNew:J,isChanged:!1,expected:X.versioned,newValue:X.versioned.value}),pN=(X)=>{return X.newValue},fN=(X,J)=>{X.isChanged=!0,X.newValue=J},C_=(X)=>{X.ref.versioned=new bY(X.newValue)};var T_=(X)=>{return X.ref.versioned!==X.expected},E_=(X)=>{return X.isChanged};var hY="Invalid",nQ="ReadWrite",cy="ReadOnly",uN=(X)=>{for(let J of X)C_(J[1])},oN=(X)=>{let J=cy;for(let[,Y]of X)if(J=T_(Y)?hY:E_(Y)?nQ:J,J===hY)return J;return J};var j_=(X)=>{let J=new Map;for(let[,Y]of X){for(let G of Y.ref.todos)J.set(G[0],G[1]);Y.ref.todos=new Map}return J},S_=(X)=>{let J=Array.from(X.entries()).sort((Y,G)=>Y[0]-G[0]);for(let[Y,G]of J)G()},v_=(X,J,Y)=>{let G=!1;for(let[,Z]of J)if(!Z.ref.todos.has(X))Z.ref.todos.set(X,Y),G=!0;return G};var mY="Done",lQ="Interrupted",dY="Running";var rQ="effect/STM/State",i7=Symbol.for(rQ),nN=(X)=>A(X,i7),lN=(X)=>{return X._tag===dY},rN=(X)=>{return X._tag===mY};var cY=(X)=>{return{[i7]:i7,_tag:mY,exit:X,[M](){return N(O(rQ),C(O(mY)),C(O(X)),S(this))},[P](J){return nN(J)&&J._tag===mY&&w(X,J.exit)}}},fy=N(O(rQ),C(O(lQ)),C(O("interrupted"))),iN={[i7]:i7,_tag:lQ,[M](){return fy},[P](X){return nN(X)&&X._tag===lQ}},uy=N(O(rQ),C(O(dY)),C(O("running"))),aN={[i7]:i7,_tag:dY,[M](){return uy},[P](X){return nN(X)&&X._tag===dY}},pY=(X)=>{switch(X._tag){case p9:return cY(g7(X.error));case f9:return cY(oJ(X.defect));case u9:return cY(JK(X.fiberId));case e5:return cY(t8(X.value));case o9:throw new Error("BUG: STM.STMState.fromTExit - please report an issue at https://github.com/Effect-TS/effect/issues")}};var M1="effect/TExit",R1=Symbol.for(M1),fY={_A:(X)=>X,_E:(X)=>X},uY=(X)=>A(X,R1);var y_=(X)=>{return X._tag===e5},oy=(X)=>{return X._tag===o9},g_=(X)=>({[R1]:fY,_tag:p9,error:X,[M](){return N(O(M1),C(O(p9)),C(O(X)),S(this))},[P](J){return uY(J)&&J._tag===p9&&w(X,J.error)}}),b_=(X)=>({[R1]:fY,_tag:f9,defect:X,[M](){return N(O(M1),C(O(f9)),C(O(X)),S(this))},[P](J){return uY(J)&&J._tag===f9&&w(X,J.defect)}}),h_=(X)=>({[R1]:fY,_tag:u9,fiberId:X,[M](){return N(O(M1),C(O(u9)),C(O(X)),S(this))},[P](J){return uY(J)&&J._tag===u9&&w(X,J.fiberId)}}),sN=(X)=>({[R1]:fY,_tag:e5,value:X,[M](){return N(O(M1),C(O(e5)),C(O(X)),S(this))},[P](J){return uY(J)&&J._tag===e5&&w(X,J.value)}}),ny=N(O(M1),C(O(o9)),C(O("retry"))),m_={[R1]:fY,_tag:o9,[M](){return ny},[P](X){return uY(X)&&oy(X)}};var d_=(X)=>{return{_tag:yY,exit:X}},tN=(X)=>{return{_tag:gY,journal:X}};var c_={ref:0},p_=()=>{let X=c_.ref+1;return c_.ref=X,X};var ay="effect/STM",f_=Symbol.for(ay),iQ={_R:(X)=>X,_E:(X)=>X,_A:(X)=>X};class X9{effect_instruction_i0;_op=K9;effect_instruction_i1=void 0;effect_instruction_i2=void 0;[oV];[l1];[fQ];[MY];get[f_](){return iQ}constructor(X){this.effect_instruction_i0=X,this[oV]=T5,this[l1]=iQ,this[fQ]=iQ,this[MY]=iQ}[P](X){return this===X}[M](){return S(this,n4(this))}[Symbol.iterator](){return new A4(new r6(this))}commit(){return u_(this,u8,u8)}pipe(){return D(this,arguments)}}var u_=(X,J,Y)=>A0((G)=>{let Z=G.id(),$=G.getFiberRef(AF),Q=G.getFiberRef(iV),K=G.getFiberRef(OF),H=ty(Z,X,$,Q,K);switch(H._tag){case yY:return J(H.exit),H.exit;case gY:{let V=p_(),W={value:aN},U=zF((L)=>o_(Z,X,V,W,$,Q,K,L));return w5((L)=>N(L(U),LY((_)=>{let z=W.value;if(lN(z))W.value=iN;if(z=W.value,rN(z))return J(z.exit),z.exit;return Y(),c9(_)})))}}}),sy=(X,J,Y,G,Z,$)=>{let Q=new Map,K=new eN(J,Q,X,G).run(),H=oN(Q);if(H===nQ)uN(Q);else if(H===hY)throw new Error("BUG: STM.TryCommit.tryCommit - please report an issue at https://github.com/Effect-TS/effect/issues");switch(K._tag){case e5:return Y.value=pY(K),h4(t8(K.value),Q,Z,$);case p9:{Y.value=pY(K);let V=q1(K.error);return h4(s8(V),Q,Z,$)}case f9:{Y.value=pY(K);let V=h9(K.defect);return h4(s8(V),Q,Z,$)}case u9:{Y.value=pY(K);let V=DY(X);return h4(s8(V),Q,Z,$)}case o9:return tN(Q)}},ty=(X,J,Y,G,Z)=>{let $=new Map,Q=new eN(J,$,X,Y).run(),K=oN($);if(K===nQ&&y_(Q))uN($);else if(K===hY)throw new Error("BUG: STM.TryCommit.tryCommitSync - please report an issue at https://github.com/Effect-TS/effect/issues");switch(Q._tag){case e5:return h4(t8(Q.value),$,G,Z);case p9:{let H=q1(Q.error);return h4(s8(H),$,G,Z)}case f9:{let H=h9(Q.defect);return h4(s8(H),$,G,Z)}case u9:{let H=DY(X);return h4(s8(H),$,G,Z)}case o9:return tN($)}},o_=(X,J,Y,G,Z,$,Q,K)=>{if(lN(G.value)){let H=sy(X,J,G,Z,$,Q);switch(H._tag){case yY:{ey(H.exit,K);break}case gY:{v_(Y,H.journal,()=>o_(X,J,Y,G,Z,$,Q,K));break}}}},h4=(X,J,Y,G)=>{let Z=j_(J);if(Z.size>0)Y.scheduleTask(()=>S_(Z),G);return d_(X)},ey=(X,J)=>{J(X)};class eN{self;journal;fiberId;contStack=[];env;constructor(X,J,Y,G){this.self=X,this.journal=J,this.fiberId=Y,this.env=G}getEnv(){return this.env}pushStack(X){this.contStack.push(X)}popStack(){return this.contStack.pop()}nextSuccess(){let X=this.popStack();while(X!==void 0&&X.effect_instruction_i0!==oQ)X=this.popStack();return X}nextFailure(){let X=this.popStack();while(X!==void 0&&X.effect_instruction_i0!==uQ)X=this.popStack();return X}nextRetry(){let X=this.popStack();while(X!==void 0&&X.effect_instruction_i0!==kN)X=this.popStack();return X}run(){let X=this.self,J=void 0;while(J===void 0&&X!==void 0)try{let Y=X;if(Y)switch(Y._op){case"Tag":{X=e8((G,Z,$)=>J5($,Y));break}case"Left":{X=C1(Y.left);break}case"None":{X=C1(new wV);break}case"Right":{X=Q0(Y.right);break}case"Some":{X=Q0(Y.value);break}case"Commit":{switch(Y.effect_instruction_i0){case mN:{J=b_(M0(()=>Y.effect_instruction_i1()));break}case hN:{let G=this.nextFailure();if(G===void 0)J=g_(M0(()=>Y.effect_instruction_i1()));else X=M0(()=>G.effect_instruction_i2(M0(()=>Y.effect_instruction_i1())));break}case bN:{let G=this.nextRetry();if(G===void 0)J=m_;else X=M0(()=>G.effect_instruction_i2());break}case dN:{J=h_(this.fiberId);break}case xN:{X=M0(()=>Y.effect_instruction_i1(this));break}case oQ:case uQ:case kN:{this.pushStack(Y),X=Y.effect_instruction_i1;break}case __:{let G=this.env;this.env=M0(()=>Y.effect_instruction_i2(G)),X=N(Y.effect_instruction_i1,n_(E1(()=>this.env=G)));break}case gN:{let G=Y.effect_instruction_i1,Z=this.nextSuccess();if(Z===void 0)J=sN(G);else X=M0(()=>Z.effect_instruction_i2(G));break}case yN:{let G=M0(()=>Y.effect_instruction_i1()),Z=this.nextSuccess();if(Z===void 0)J=sN(G);else X=M0(()=>Z.effect_instruction_i2(G));break}}break}}}catch(Y){X=JW(Y)}return J}}var XW=B(2,(X,J)=>{let Y=new X9(uQ);return Y.effect_instruction_i1=X,Y.effect_instruction_i2=J,Y});var JW=(X)=>YW(()=>X);var YW=(X)=>{let J=new X9(mN);return J.effect_instruction_i1=X,J},e8=(X)=>c0((J)=>Q0(X(J.journal,J.fiberId,J.getEnv()))),n_=B(2,(X,J)=>aQ(X,{onFailure:(Y)=>T1(J,C1(Y)),onSuccess:(Y)=>T1(J,Q0(Y))})),C1=(X)=>GW(()=>X),GW=(X)=>{let J=new X9(hN);return J.effect_instruction_i1=X,J},A8=B(2,(X,J)=>{let Y=new X9(oQ);return Y.effect_instruction_i1=X,Y.effect_instruction_i2=J,Y}),aQ=B(2,(X,{onFailure:J,onSuccess:Y})=>N(X,t0(u),XW((G)=>N(J(G),t0(k))),A8((G)=>{switch(G._tag){case"Left":return Q0(G.left);case"Right":return Y(G.right)}}))),c0=(X)=>{let J=new X9(xN);return J.effect_instruction_i1=X,J};var R8=(X)=>{let J=new X9(dN);return J.effect_instruction_i1=X,J},t0=B(2,(X,J)=>N(X,A8((Y)=>E1(()=>J(Y)))));var v8=new X9(bN),Q0=(X)=>{let J=new X9(gN);return J.effect_instruction_i1=X,J},E1=(X)=>{let J=new X9(yN);return J.effect_instruction_i1=X,J};var T1=B(2,(X,J)=>N(X,A8(()=>J))),sQ=B(3,(X,J,Y)=>N(X,A8((G)=>N(J,t0((Z)=>Y(G,Z))))));var oY="BackPressure",nY="Dropping",lY="Sliding";var ZW=(X)=>A8(X,x);var I1=B((X)=>$X(X[0]),(X,J,Y)=>{if(Y?.discard)return N(E1(()=>X[Symbol.iterator]()),A8((G)=>{let Z=rY(()=>{let $=G.next();if($.done)return n9;return N(J($.value),A8(()=>Z))});return Z}));return rY(()=>p(X).reduce((G,Z)=>sQ(G,J(Z),($,Q)=>{return $.push(Q),$}),Q0([])))});var rY=(X)=>ZW(E1(X));var n9=Q0(void 0);var $g="effect/TRef",i_=Symbol.for($g),a_={_A:(X)=>X};class j1{[i_]=a_;todos;versioned;constructor(X){this.versioned=new bY(X),this.todos=new Map}modify(X){return e8((J)=>{let Y=$W(this,J),[G,Z]=X(pN(Y));return fN(Y,Z),G})}pipe(){return D(this,arguments)}}var $W=(X,J)=>{if(J.has(X))return J.get(X);let Y=R_(X,!1);return J.set(X,Y),Y},a=B(2,(X,J)=>pN($W(X,J))),J0=B(3,(X,J,Y)=>{let G=$W(X,Y);fN(G,J);return});var Qg="effect/TQueue/TEnqueue",eQ=Symbol.for(Qg),Hg="effect/TQueue/TDequeue",X2=Symbol.for(Hg);var J2={_Out:(X)=>X},QW={_In:(X)=>X};class Kg{ref;requestedCapacity;strategy;[X2]=J2;[eQ]=QW;constructor(X,J,Y){this.ref=X,this.requestedCapacity=J,this.strategy=Y}capacity(){return this.requestedCapacity}size=c0((X)=>{let J=a(this.ref,X.journal);if(J===void 0)return R8(X.fiberId);return Q0(J.length)});isFull=t0(this.size,(X)=>X===this.requestedCapacity);isEmpty=t0(this.size,(X)=>X===0);shutdown=c0((X)=>{return J0(this.ref,void 0,X.journal),n9});isShutdown=e8((X)=>{return a(this.ref,X)===void 0});awaitShutdown=A8(this.isShutdown,(X)=>X?n9:v8);offer(X){return c0((J)=>{let Y=N(this.ref,a(J.journal));if(Y===void 0)return R8(J.fiberId);if(Y.length<this.requestedCapacity)return Y.push(X),J0(this.ref,Y,J.journal),Q0(!0);switch(this.strategy._tag){case oY:return v8;case nY:return Q0(!1);case lY:{if(Y.length===0)return Q0(!0);return Y.shift(),Y.push(X),J0(this.ref,Y,J.journal),Q0(!0)}}})}offerAll(X){return c0((J)=>{let Y=Array.from(X),G=a(this.ref,J.journal);if(G===void 0)return R8(J.fiberId);if(G.length+Y.length<=this.requestedCapacity)return J0(this.ref,[...G,...Y],J.journal),Q0(!0);switch(this.strategy._tag){case oY:return v8;case nY:{let Z=Y.slice(0,this.requestedCapacity-G.length);return J0(this.ref,[...G,...Z],J.journal),Q0(!1)}case lY:{let Z=Y.slice(0,this.requestedCapacity-G.length),$=G.length+Z.length-this.requestedCapacity,Q=G.slice($);return J0(this.ref,[...Q,...Z],J.journal),Q0(!0)}}})}peek=c0((X)=>{let J=a(this.ref,X.journal);if(J===void 0)return R8(X.fiberId);if(J.length===0)return v8;return Q0(J[0])});peekOption=c0((X)=>{let J=a(this.ref,X.journal);if(J===void 0)return R8(X.fiberId);return Q0(H8(J[0]))});take=c0((X)=>{let J=a(this.ref,X.journal);if(J===void 0)return R8(X.fiberId);if(J.length===0)return v8;let Y=J.shift();return J0(this.ref,J,X.journal),Q0(Y)});takeAll=c0((X)=>{let J=a(this.ref,X.journal);if(J===void 0)return R8(X.fiberId);return J0(this.ref,[],X.journal),Q0(J)});takeUpTo(X){return c0((J)=>{let Y=a(this.ref,J.journal);if(Y===void 0)return R8(J.fiberId);let[G,Z]=JZ(B8(Y),X);return J0(this.ref,Array.from(Z),J.journal),Q0(Array.from(G))})}}var Wg="effect/TPubSub",Y2=Symbol.for(Wg),_6=Symbol.for("effect/TPubSub/AbsentValue"),r9=(X,J,Y)=>({head:X,subscribers:J,tail:Y});class Ug{pubsubSize;publisherHead;publisherTail;requestedCapacity;strategy;subscriberCount;subscribers;[Y2]={_A:(X)=>X};[eQ]=QW;constructor(X,J,Y,G,Z,$,Q){this.pubsubSize=X,this.publisherHead=J,this.publisherTail=Y,this.requestedCapacity=G,this.strategy=Z,this.subscriberCount=$,this.subscribers=Q}isShutdown=e8((X)=>{return a(this.publisherTail,X)===void 0});awaitShutdown=A8(this.isShutdown,(X)=>X?n9:v8);capacity(){return this.requestedCapacity}size=c0((X)=>{if(a(this.publisherTail,X.journal)===void 0)return R8(X.fiberId);return Q0(a(this.pubsubSize,X.journal))});isEmpty=t0(this.size,(X)=>X===0);isFull=t0(this.size,(X)=>X===this.capacity());offer(X){return c0((J)=>{let Y=a(this.publisherTail,J.journal);if(Y===void 0)return R8(J.fiberId);let G=a(this.subscriberCount,J.journal);if(G===0)return Q0(!0);let Z=a(this.pubsubSize,J.journal);if(Z<this.requestedCapacity){let $=new j1(void 0),Q=r9(X,G,$);return J0(Y,Q,J.journal),J0(this.publisherTail,$,J.journal),J0(this.pubsubSize,Z+1,J.journal),Q0(!0)}switch(this.strategy._tag){case oY:return v8;case nY:return Q0(!1);case lY:{if(this.requestedCapacity>0){let K=a(this.publisherHead,J.journal),H=!0;while(H){let V=a(K,J.journal);if(V===void 0)return v8;let{head:W,tail:U}=V;if(W!==_6){let L=r9(_6,V.subscribers,V.tail);J0(K,L,J.journal),J0(this.publisherHead,U,J.journal),H=!1}else K=U}}let $=new j1(void 0),Q=r9(X,G,$);return J0(Y,Q,J.journal),J0(this.publisherTail,$,J.journal),Q0(!0)}}})}offerAll(X){return t0(I1(X,(J)=>this.offer(J)),hU(x))}shutdown=e8((X)=>{if(a(this.publisherTail,X)!==void 0){J0(this.publisherTail,void 0,X);let Y=a(this.subscribers,X);nz(Y,(G)=>{J0(G,void 0,X)}),J0(this.subscribers,r8(),X)}})}class Dg{pubsubSize;publisherHead;requestedCapacity;subscriberHead;subscriberCount;subscribers;[Y2]=Y2;[X2]=J2;constructor(X,J,Y,G,Z,$){this.pubsubSize=X,this.publisherHead=J,this.requestedCapacity=Y,this.subscriberHead=G,this.subscriberCount=Z,this.subscribers=$}isShutdown=e8((X)=>{return a(this.subscriberHead,X)===void 0});awaitShutdown=A8(this.isShutdown,(X)=>X?n9:v8);capacity(){return this.requestedCapacity}size=c0((X)=>{let J=a(this.subscriberHead,X.journal);if(J===void 0)return R8(X.fiberId);let Y=!0,G=0;while(Y){let Z=a(J,X.journal);if(Z===void 0)Y=!1;else{let{head:$,tail:Q}=Z;if($!==_6){if(G=G+1,G>=Number.MAX_SAFE_INTEGER)Y=!1}J=Q}}return Q0(G)});isEmpty=t0(this.size,(X)=>X===0);isFull=t0(this.size,(X)=>X===this.capacity());peek=c0((X)=>{let J=a(this.subscriberHead,X.journal);if(J===void 0)return R8(X.fiberId);let Y=_6,G=!0;while(G){let Z=a(J,X.journal);if(Z===void 0)return v8;let{head:$,tail:Q}=Z;if($!==_6)Y=$,G=!1;else J=Q}return Q0(Y)});peekOption=c0((X)=>{let J=a(this.subscriberHead,X.journal);if(J===void 0)return R8(X.fiberId);let Y=q(),G=!0;while(G){let Z=a(J,X.journal);if(Z===void 0)Y=q(),G=!1;else{let{head:$,tail:Q}=Z;if($!==_6)Y=F($),G=!1;else J=Q}}return Q0(Y)});shutdown=e8((X)=>{let J=a(this.subscriberHead,X);if(J!==void 0){J0(this.subscriberHead,void 0,X);let Y=!0;while(Y){let Z=a(J,X);if(Z===void 0)Y=!1;else{let{head:$,tail:Q}=Z;if($!==_6){let K=Z.subscribers;if(K===1){let H=a(this.pubsubSize,X),V=r9(_6,0,Q);J0(J,V,X),J0(this.publisherHead,Q,X),J0(this.pubsubSize,H-1,X)}else{let H=r9($,K-1,Q);J0(J,H,X)}}J=Q}}let G=a(this.subscriberCount,X);J0(this.subscriberCount,G-1,X),J0(this.subscribers,xX(a(this.subscribers,X),this.subscriberHead),X)}});take=c0((X)=>{let J=a(this.subscriberHead,X.journal);if(J===void 0)return R8(X.fiberId);let Y=_6,G=!0;while(G){let Z=a(J,X.journal);if(Z===void 0)return v8;let{head:$,tail:Q}=Z;if($!==_6){let K=Z.subscribers;if(K===1){let H=a(this.pubsubSize,X.journal),V=r9(_6,0,Q);J0(J,V,X.journal),J0(this.publisherHead,Q,X.journal),J0(this.pubsubSize,H-1,X.journal)}else{let H=r9($,K-1,Q);J0(J,H,X.journal)}J0(this.subscriberHead,Q,X.journal),Y=$,G=!1}else J=Q}return Q0(Y)});takeAll=this.takeUpTo(Number.POSITIVE_INFINITY);takeUpTo(X){return c0((J)=>{let Y=a(this.subscriberHead,J.journal);if(Y===void 0)return R8(J.fiberId);let G=[],Z=0;while(Z!==X){let $=a(Y,J.journal);if($===void 0)Z=X;else{let{head:Q,tail:K}=$;if(Q!==_6){let H=$.subscribers;if(H===1){let V=a(this.pubsubSize,J.journal),W=r9(_6,0,K);J0(Y,W,J.journal),J0(this.publisherHead,K,J.journal),J0(this.pubsubSize,V-1,J.journal)}else{let V=r9(Q,H-1,K);J0(Y,V,J.journal)}G.push(Q),Z=Z+1}Y=K}}return J0(this.subscriberHead,Y,J.journal),Q0(G)})}}var ZP="effect/Redacted",Z2=h("effect/Redacted/redactedRegistry",()=>new WeakMap),UW=Symbol.for(ZP),Tb={[UW]:{_A:(X)=>X},pipe(){return D(this,arguments)},toString(){return"<redacted>"},toJSON(){return"<redacted>"},[v](){return"<redacted>"},[M](){return N(O(ZP),C(O(Z2.get(this))),S(this))},[P](X){return $P(X)&&w(Z2.get(this),Z2.get(X))}},$P=(X)=>A(X,UW);var jb="effect/Config",KP=Symbol.for(jb),Sb={_A:(X)=>X},G20={...o8,[KP]:Sb,commit(){return dO(this)}};var VP=function(){let X=Symbol.for("effect/Data/Error/plainArgs");return class J extends dJ{constructor(Y){super(Y?.message,Y?.cause?{cause:Y.cause}:void 0);if(Y)Object.assign(this,Y),Object.defineProperty(this,X,{value:Y,enumerable:!1})}toJSON(){return{...this[X],...this}}}}(),NP=(X)=>{class J extends VP{_tag=X}return J.prototype.name=X,J};var zP=Symbol.for("effect/FiberHandle");var tH0={[zP]:zP,toString(){return d(this.toJSON())},toJSON(){return{_id:"FiberHandle",state:this.state}},[v](){return this.toJSON()},pipe(){return D(this,arguments)}};var qP=Symbol.for("effect/FiberMap");var JK0={[qP]:qP,[Symbol.iterator](){if(this.state._tag==="Closed")return jG();return this.state.backing[Symbol.iterator]()},toString(){return d(this.toJSON())},toJSON(){return{_id:"FiberMap",state:this.state}},[v](){return this.toJSON()},pipe(){return D(this,arguments)}};var LP=Symbol.for("effect/FiberSet");var ZK0={[LP]:LP,[Symbol.iterator](){if(this.state._tag==="Closed")return jG();return this.state.backing[Symbol.iterator]()},toString(){return d(this.toJSON())},toJSON(){return{_id:"FiberMap",state:this.state}},[v](){return this.toJSON()},pipe(){return D(this,arguments)}};var qW=Symbol.for("effect/Pool"),Kh={_E:(X)=>X,_A:(X)=>X};class Bh extends $6{scope;acquire;concurrency;minSize;maxSize;strategy;targetUtilization;[qW];isShuttingDown=!1;semaphore;items=new Set;available=new Set;availableLatch=vV(!1);invalidated=new Set;waiters=0;constructor(X,J,Y,G,Z,$,Q){super();this.scope=X,this.acquire=J,this.concurrency=Y,this.minSize=G,this.maxSize=Z,this.strategy=$,this.targetUtilization=Q,this[qW]=Kh,this.semaphore=f7(Y*Z)}allocate=cX(i5(),(X)=>this.acquire.pipe(b9(X),P8,T((J)=>{let Y={exit:J,finalizer:fX(X.close(J),Vh),refCount:0,disableReclaim:!1};return this.items.add(Y),this.available.add(Y),n0(J._tag==="Success"?this.strategy.onAcquire(Y):w0(Y.finalizer,this.strategy.onAcquire(Y)),Y)})),(X,J)=>J._tag==="Failure"?X.close(J):l);get currentUsage(){let X=this.waiters;for(let J of this.items)X+=J.refCount;return X}get targetSize(){if(this.isShuttingDown)return 0;let X=this.currentUsage/this.targetUtilization,J=Math.ceil(X/this.concurrency);return Math.min(Math.max(this.minSize,J),this.maxSize)}get activeSize(){return this.items.size-this.invalidated.size}resizeLoop=n(()=>{if(this.activeSize>=this.targetSize)return l;return this.strategy.reclaim(this).pipe(T($0({onNone:()=>this.allocate,onSome:g})),I7(this.availableLatch.open),T((X)=>X.exit._tag==="Success"?this.resizeLoop:l))});resizeSemaphore=f7(1);resize=this.resizeSemaphore.withPermits(1)(this.resizeLoop);getPoolItem=i0((X)=>X(this.semaphore.take(1)).pipe(w0(L5),T((J)=>n(()=>{if(this.waiters++,this.isShuttingDown)return f5;else if(this.targetSize>this.activeSize){let Y=this;return T(this.resizeSemaphore.withPermitsIfAvailable(1)(u7(k6(this.resize),this.scope)),function G(){if(Y.isShuttingDown)return f5;else if(Y.available.size>0)return g(IG(Y.available));return Y.availableLatch.unsafeClose(),T(Y.availableLatch.await,G)})}return g(IG(this.available))}).pipe(a5(I(()=>this.waiters--)),U8((Y)=>{if(Y.exit._tag==="Failure")return this.items.delete(Y),this.invalidated.delete(Y),this.available.delete(Y),this.semaphore.release(1);if(Y.refCount++,this.available.delete(Y),Y.refCount<this.concurrency)this.available.add(Y);return J.addFinalizer(()=>w0(n(()=>{if(Y.refCount--,this.invalidated.has(Y))return this.invalidatePoolItem(Y);return this.available.add(Y),a0}),this.semaphore.release(1)))}),U5(()=>this.semaphore.release(1))))));commit(){return this.get}get=T(n(()=>this.isShuttingDown?f5:this.getPoolItem),(X)=>X.exit);invalidate(X){return n(()=>{if(this.isShuttingDown)return l;for(let J of this.items)if(J.exit._tag==="Success"&&J.exit.value===X)return J.disableReclaim=!0,_9(this.invalidatePoolItem(J));return l})}invalidatePoolItem(X){return n(()=>{if(!this.items.has(X))return l;else if(X.refCount===0)return this.items.delete(X),this.available.delete(X),this.invalidated.delete(X),w0(X.finalizer,u7(k6(this.resize),this.scope));return this.invalidated.add(X),this.available.delete(X),l})}get shutdown(){return n(()=>{if(this.isShuttingDown)return l;this.isShuttingDown=!0;let X=this.items.size,J=f7(X);return i8(this.items,(Y)=>{if(Y.refCount>0)return Y.finalizer=I7(Y.finalizer,J.release(1)),this.invalidated.add(Y),J.take(1);return this.items.delete(Y),this.available.delete(Y),this.invalidated.delete(Y),Y.finalizer}).pipe(w0(this.semaphore.releaseAll),w0(this.availableLatch.open),w0(J.take(X)))})}pipe(){return D(this,arguments)}}var Vh=(X)=>A0((J)=>{let Y=J.getFiberRef(rX);if(Y._tag==="Some")J.log("Unhandled error in pool finalizer",X,Y);return l});var oB0={...R$,[zY]:zY,pipe(){return D(this,arguments)},commit(){return this.runtimeEffect}};var LW=Symbol.for("@effect/matcher/Matcher"),Rh={[LW]:{_input:x,_filters:x,_remaining:x,_result:x,_return:x},_tag:"TypeMatcher",add(X){return Ch([...this.cases,X])},pipe(){return D(this,arguments)}};function Ch(X){let J=Object.create(Rh);return J.cases=X,J}var Th={[LW]:{_input:x,_filters:x,_result:x,_return:x},_tag:"ValueMatcher",add(X){if(this.value._tag==="Right")return this;if(X._tag==="When"&&X.guard(this.provided)===!0)return MP(this.provided,u(X.evaluate(this.provided)));else if(X._tag==="Not"&&X.guard(this.provided)===!1)return MP(this.provided,u(X.evaluate(this.provided)));return this},pipe(){return D(this,arguments)}};function MP(X,J){let Y=Object.create(Th);return Y.provided=X,Y.value=J,Y}var RP=Symbol.for("effect/MutableHashSet"),IN0={[RP]:RP,[Symbol.iterator](){return Array.from(this.keyMap).map(([X])=>X)[Symbol.iterator]()},toString(){return d(this.toJSON())},toJSON(){return{_id:"MutableHashSet",values:Array.from(this).map(r)}},[v](){return this.toJSON()},pipe(){return D(this,arguments)}};class O8{path;actual;issue;_tag="Pointer";constructor(X,J,Y){this.path=X,this.actual=J,this.issue=Y}}class PW{actual;message;_tag="Unexpected";constructor(X,J){this.actual=X,this.message=J}}class v1{ast;message;_tag="Missing";actual=void 0;constructor(X,J){this.ast=X,this.message=J}}class p0{ast;actual;issues;output;_tag="Composite";constructor(X,J,Y,G){this.ast=X,this.actual=J,this.issues=Y,this.output=G}}class Q2{ast;actual;kind;issue;_tag="Refinement";constructor(X,J,Y,G){this.ast=X,this.actual=J,this.kind=Y,this.issue=G}}class H2{ast;actual;kind;issue;_tag="Transformation";constructor(X,J,Y,G){this.ast=X,this.actual=J,this.kind=Y,this.issue=G}}class p6{ast;actual;message;_tag="Type";constructor(X,J,Y){this.ast=X,this.actual=J,this.message=Y}}class IP{ast;actual;message;_tag="Forbidden";constructor(X,J,Y){this.ast=X,this.actual=J,this.message=Y}}var CP=Symbol.for("effect/Schema/ParseErrorTypeId");class jP extends NP("ParseError"){[CP]=CP;get message(){return this.toString()}toString(){return tY.formatIssueSync(this.issue)}toJSON(){return{_id:"ParseError",message:this.toString()}}[v](){return this.toJSON()}}var SP=(X)=>new jP({issue:X}),vP=u,xP=k;var iY=B(2,(X,J)=>{let Y=X;if(Y._tag==="Left")return Y;if(Y._tag==="Right")return J(Y.right);return P0(X,J)}),kP=B(2,(X,J)=>{let Y=X;if(Y._tag==="Left")return Y;if(Y._tag==="Right")return u(J(Y.right));return j0(X,J)}),K2=B(2,(X,J)=>{let Y=X;if(Y._tag==="Left")return k(J(Y.left));if(Y._tag==="Right")return Y;return wY(X,J)}),i9=(X)=>{let J=X;if(J._tag==="Left"||J._tag==="Right")return J};var yP=B(2,(X,J)=>{let Y=X;if(Y._tag==="Left")return J(Y.left);if(Y._tag==="Right")return Y;return qY(X,J)}),gP=(X,J)=>{if(J===void 0||k8(J))return X;if(X===void 0)return J;return{...X,...J}},sh=(X,J,Y)=>{let G=c8(X,J);return(Z,$)=>G(Z,gP(Y,$))},th=(X,J,Y)=>{let G=sh(X,J,Y);return(Z,$)=>h2(G(Z,$),SP)};var MW=(X,J)=>th(n8(X.ast),!0,J);var eh=h(Symbol.for("effect/Schema/Parser/decodeMemoMap"),()=>new WeakMap),Xm=h(Symbol.for("effect/Schema/Parser/encodeMemoMap"),()=>new WeakMap),c8=(X,J)=>{let Y=J?eh:Xm,G=Y.get(X);if(G)return G;let Z=Jm(X,J),$=HD(X),Q=c($)?(V,W)=>Z(V,gP(W,$.value)):Z,K=KD(X),H=J&&c(K)?(V,W)=>sY(yP(Q(V,W),K.value),X,V,W):Q;return Y.set(X,H),H},wW=(X)=>T8(ZD(X)),FW=(X)=>T8($D(X)),Jm=(X,J)=>{switch(X._tag){case"Refinement":if(J){let Y=c8(X.from,!0);return(G,Z)=>{Z=Z??VJ;let $=Z?.errors==="all",Q=iY(yP(Y(G,Z),(K)=>{let H=new Q2(X,G,"From",K);if($&&z3(X)&&cP(K))return $0(X.filter(G,Z,X),{onNone:()=>k(H),onSome:(V)=>k(new p0(X,G,[H,new Q2(X,G,"Predicate",V)]))});return k(H)}),(K)=>$0(X.filter(K,Z,X),{onNone:()=>u(K),onSome:(H)=>k(new Q2(X,G,"Predicate",H))}));return sY(Q,X,G,Z)}}else{let Y=c8(n8(X),!0),G=c8(hP(X.from),!1);return(Z,$)=>sY(iY(Y(Z,$),(Q)=>G(Q,$)),X,Z,$)}case"Transformation":{let Y=Gm(X.transformation,J),G=J?c8(X.from,!0):c8(X.to,!1),Z=J?c8(X.to,!0):c8(X.from,!1);return($,Q)=>sY(iY(K2(G($,Q),(K)=>new H2(X,$,J?"Encoded":"Type",K)),(K)=>iY(K2(Y(K,Q??VJ,X,$),(H)=>new H2(X,$,"Transformation",H)),(H)=>K2(Z(H,Q),(V)=>new H2(X,$,J?"Type":"Encoded",V)))),X,$,Q)}case"Declaration":{let Y=J?X.decodeUnknown(...X.typeParameters):X.encodeUnknown(...X.typeParameters);return(G,Z)=>sY(Y(G,Z??VJ,X),X,G,Z)}case"Literal":return P6(X,(Y)=>Y===X.literal);case"UniqueSymbol":return P6(X,(Y)=>Y===X.symbol);case"UndefinedKeyword":return P6(X,M2);case"NeverKeyword":return P6(X,NU);case"UnknownKeyword":case"AnyKeyword":case"VoidKeyword":return u;case"StringKeyword":return P6(X,X8);case"NumberKeyword":return P6(X,k8);case"BooleanKeyword":return P6(X,V6);case"BigIntKeyword":return P6(X,l6);case"SymbolKeyword":return P6(X,G9);case"ObjectKeyword":return P6(X,R5);case"Enums":return P6(X,(Y)=>X.enums.some(([G,Z])=>Z===Y));case"TemplateLiteral":{let Y=L3(X);return P6(X,(G)=>X8(G)&&Y.test(G))}case"TupleType":{let Y=X.elements.map((V)=>c8(V.type,J)),G=X.rest.map((V)=>c8(V.type,J)),Z=X.elements.filter((V)=>!V.isOptional);if(X.rest.length>0)Z=Z.concat(X.rest.slice(1));let $=Z.length,Q=X.elements.length>0?X.elements.map((V,W)=>W).join(" | "):"never",K=wW(X),H=FW(X);return(V,W)=>{if(!qX(V))return k(new p6(X,V));let U=W?.errors==="all",L=[],_=0,z=[],R=V.length;for(let f=R;f<=$-1;f++){let Y0=new O8(f,V,new v1(Z[f-R]));if(U){L.push([_++,Y0]);continue}else return k(new p0(X,V,Y0,z))}if(X.rest.length===0)for(let f=X.elements.length;f<=R-1;f++){let Y0=new O8(f,V,new PW(V[f],`is unexpected, expected: ${Q}`));if(U){L.push([_++,Y0]);continue}else return k(new p0(X,V,Y0,z))}let j=0,m=void 0;for(;j<Y.length;j++)if(R<j+1){if(X.elements[j].isOptional)continue}else{let f=Y[j],Y0=f(V[j],W),N0=i9(Y0);if(N0){if(v0(N0)){let G0=new O8(j,V,N0.left);if(U){L.push([_++,G0]);continue}else return k(new p0(X,V,G0,_5(z)))}z.push([_++,N0.right])}else{let G0=_++,t=j;if(!m)m=[];m.push(({es:i,output:O0})=>P0(y4(Y0),(q0)=>{if(v0(q0)){let W0=new O8(t,V,q0.left);if(U)return i.push([G0,W0]),d0;else return k(new p0(X,V,W0,_5(O0)))}return O0.push([G0,q0.right]),d0}))}}if(T0(G)){let[f,...Y0]=G;for(;j<R-Y0.length;j++){let N0=f(V[j],W),G0=i9(N0);if(G0)if(v0(G0)){let t=new O8(j,V,G0.left);if(U){L.push([_++,t]);continue}else return k(new p0(X,V,t,_5(z)))}else z.push([_++,G0.right]);else{let t=_++,i=j;if(!m)m=[];m.push(({es:O0,output:q0})=>P0(y4(N0),(W0)=>{if(v0(W0)){let S0=new O8(i,V,W0.left);if(U)return O0.push([t,S0]),d0;else return k(new p0(X,V,S0,_5(q0)))}else return q0.push([t,W0.right]),d0}))}}for(let N0=0;N0<Y0.length;N0++)if(j+=N0,R<j+1)continue;else{let G0=Y0[N0](V[j],W),t=i9(G0);if(t){if(v0(t)){let i=new O8(j,V,t.left);if(U){L.push([_++,i]);continue}else return k(new p0(X,V,i,_5(z)))}z.push([_++,t.right])}else{let i=_++,O0=j;if(!m)m=[];m.push(({es:q0,output:W0})=>P0(y4(G0),(S0)=>{if(v0(S0)){let q8=new O8(O0,V,S0.left);if(U)return q0.push([i,q8]),d0;else return k(new p0(X,V,q8,_5(W0)))}return W0.push([i,S0.right]),d0}))}}}let B0=({es:f,output:Y0})=>a6(f)?k(new p0(X,V,_5(f),_5(Y0))):u(_5(Y0));if(m&&m.length>0){let f=m;return Q6(()=>{let Y0={es:LX(L),output:LX(z)};return P0(w6(f,(N0)=>N0(Y0),{concurrency:K,batching:H,discard:!0}),()=>B0(Y0))})}return B0({output:z,es:L})}}case"TypeLiteral":{if(X.propertySignatures.length===0&&X.indexSignatures.length===0)return P6(X,R2);let Y=[],G={},Z=[];for(let W of X.propertySignatures)Y.push([c8(W.type,J),W]),G[W.name]=null,Z.push(W.name);let $=X.indexSignatures.map((W)=>[c8(W.parameter,J),c8(W.type,J),W.parameter]),Q=k5.make(X.indexSignatures.map((W)=>W.parameter).concat(Z.map((W)=>G9(W)?new rG(W):new nG(W)))),K=c8(Q,J),H=wW(X),V=FW(X);return(W,U)=>{if(!C2(W))return k(new p6(X,W));let L=U?.errors==="all",_=[],z=0,R=U?.onExcessProperty==="error",j=U?.onExcessProperty==="preserve",m={},B0;if(R||j){B0=Y7(W);for(let G0 of B0){let t=i9(K(G0,U));if(v0(t))if(R){let i=new O8(G0,W,new PW(W[G0],`is unexpected, expected: ${String(Q)}`));if(L){_.push([z++,i]);continue}else return k(new p0(X,W,i,m))}else m[G0]=W[G0]}}let f=void 0,Y0=U?.exact===!0;for(let G0=0;G0<Y.length;G0++){let t=Y[G0][1],i=t.name,O0=Object.prototype.hasOwnProperty.call(W,i);if(!O0){if(t.isOptional)continue;else if(Y0){let q8=new O8(i,W,new v1(t));if(L){_.push([z++,q8]);continue}else return k(new p0(X,W,q8,m))}}let q0=Y[G0][0],W0=q0(W[i],U),S0=i9(W0);if(S0){if(v0(S0)){let q8=new O8(i,W,O0?S0.left:new v1(t));if(L){_.push([z++,q8]);continue}else return k(new p0(X,W,q8,m))}m[i]=S0.right}else{let q8=z++,p8=i;if(!f)f=[];f.push(({es:u6,output:f8})=>P0(y4(W0),(Q8)=>{if(v0(Q8)){let o6=new O8(p8,W,O0?Q8.left:new v1(t));if(L)return u6.push([q8,o6]),d0;else return k(new p0(X,W,o6,f8))}return f8[p8]=Q8.right,d0}))}}for(let G0=0;G0<$.length;G0++){let t=$[G0],i=t[0],O0=t[1],q0=xG(W,t[2]);for(let W0 of q0){let S0=i9(i(W0,U));if(S0&&J6(S0)){let q8=O0(W[W0],U),p8=i9(q8);if(p8){if(v0(p8)){let u6=new O8(W0,W,p8.left);if(L){_.push([z++,u6]);continue}else return k(new p0(X,W,u6,m))}else if(!Object.prototype.hasOwnProperty.call(G,W0))m[W0]=p8.right}else{let u6=z++,f8=W0;if(!f)f=[];f.push(({es:Q8,output:o6})=>P0(y4(q8),(u4)=>{if(v0(u4)){let e9=new O8(f8,W,u4.left);if(L)return Q8.push([u6,e9]),d0;else return k(new p0(X,W,e9,o6))}else{if(!Object.prototype.hasOwnProperty.call(G,W0))o6[W0]=u4.right;return d0}}))}}}}let N0=({es:G0,output:t})=>{if(a6(G0))return k(new p0(X,W,_5(G0),t));if(U?.propertyOrder==="original"){let i=B0||Y7(W);for(let q0 of Z)if(i.indexOf(q0)===-1)i.push(q0);let O0={};for(let q0 of i)if(Object.prototype.hasOwnProperty.call(t,q0))O0[q0]=t[q0];return u(O0)}return u(t)};if(f&&f.length>0){let G0=f;return Q6(()=>{let t={es:LX(_),output:Object.assign({},m)};return P0(w6(G0,(i)=>i(t),{concurrency:H,batching:V,discard:!0}),()=>N0(t))})}return N0({es:_,output:m})}}case"Union":{let Y=bP(X.types,J),G=Y7(Y.keys),Z=G.length,$=new Map;for(let H=0;H<X.types.length;H++)$.set(X.types[H],c8(X.types[H],J));let Q=wW(X)??1,K=FW(X);return(H,V)=>{let W=[],U=0,L=[];if(Z>0)if(f1(H))for(let R=0;R<Z;R++){let j=G[R],m=Y.keys[j].buckets;if(Object.prototype.hasOwnProperty.call(H,j)){let B0=String(H[j]);if(Object.prototype.hasOwnProperty.call(m,B0))L=L.concat(m[B0]);else{let f=k5.make(Y.keys[j].literals);W.push([U++,new p0(new Q7([new $7(j,f,!1,!0)],[]),H,new O8(j,H,new p6(f,H[j])))])}}else{let B0=k5.make(Y.keys[j].literals),f=new $7(j,B0,!1,!0);W.push([U++,new p0(new Q7([f],[]),H,new O8(j,H,new v1(f)))])}}else W.push([U++,new p6(X,H)]);if(Y.otherwise.length>0)L=L.concat(Y.otherwise);let _=void 0;for(let R=0;R<L.length;R++){let j=L[R],m=$.get(j)(H,V),B0=!_||_.length===0?i9(m):void 0;if(B0)if(J6(B0))return B0;else W.push([U++,B0.left]);else{let f=U++;if(!_)_=[];_.push((Y0)=>Q6(()=>{if("finalResult"in Y0)return d0;else return P0(y4(m),(N0)=>{if(J6(N0))Y0.finalResult=N0;else Y0.es.push([f,N0.left]);return d0})}))}}let z=(R)=>a6(R)?R.length===1&&R[0][1]._tag==="Type"?k(R[0][1]):k(new p0(X,H,_5(R))):k(new p6(X,H));if(_&&_.length>0){let R=_;return Q6(()=>{let j={es:LX(W)};return P0(w6(R,(m)=>m(j),{concurrency:Q,batching:K,discard:!0}),()=>{if("finalResult"in j)return j.finalResult;return z(j.es)})})}return z(W)}}case"Suspend":{let Y=G7(()=>c8(G4(X.f(),X.annotations),J));return(G,Z)=>Y()(G,Z)}}},P6=(X,J)=>(Y)=>J(Y)?u(Y):k(new p6(X,Y)),aY=(X,J)=>{switch(X._tag){case"Declaration":{let Y=oG(X);if(c(Y))return aY(Y.value,J);break}case"TypeLiteral":{let Y=[];for(let G=0;G<X.propertySignatures.length;G++){let Z=X.propertySignatures[G],$=J?tG(Z.type):n8(Z.type);if(lG($)&&!Z.isOptional)Y.push([Z.name,$])}return Y}case"TupleType":{let Y=[];for(let G=0;G<X.elements.length;G++){let Z=X.elements[G],$=J?tG(Z.type):n8(Z.type);if(lG($)&&!Z.isOptional)Y.push([G,$])}return Y}case"Refinement":return aY(X.from,J);case"Suspend":return aY(X.f(),J);case"Transformation":return aY(J?X.from:X.to,J)}return[]},bP=(X,J)=>{let Y={},G=[];for(let Z=0;Z<X.length;Z++){let $=X[Z],Q=aY($,J);if(Q.length>0)for(let K=0;K<Q.length;K++){let[H,V]=Q[K],W=String(V.literal);Y[H]=Y[H]||{buckets:{},literals:[]};let U=Y[H].buckets;if(Object.prototype.hasOwnProperty.call(U,W)){if(K<Q.length-1)continue;U[W].push($),Y[H].literals.push(V)}else{U[W]=[$],Y[H].literals.push(V);break}}else G.push($)}return{keys:Y,otherwise:G}},hP=(X)=>MX(X)?hP(X.from):X,sY=(X,J,Y,G)=>{let Z=i9(X);if(Z)return Z;if(G?.isEffectAllowed===!0)return X;try{return rV(y4(X))}catch($){return k(new IP(J,Y,"cannot be be resolved synchronously, this is caused by using runSync on an effect that performs async work"))}},Ym=([X],[J])=>X>J?1:X<J?-1:0;function _5(X){return X.sort(Ym).map((J)=>J[1])}var Gm=(X,J)=>{switch(X._tag){case"FinalTransformation":return J?X.decode:X.encode;case"ComposeTransformation":return u;case"TypeLiteralTransformation":return(Y)=>{let G=u(Y);for(let Z of X.propertySignatureTransformations){let[$,Q]=J?[Z.from,Z.to]:[Z.to,Z.from],K=J?Z.decode:Z.encode;G=kP(G,(V)=>{let W=K(Object.prototype.hasOwnProperty.call(V,$)?F(V[$]):q());if(delete V[$],c(W))V[Q]=W.value;return V})}return G}}},M6=(X,J=[])=>({value:X,forest:J}),tY={formatIssue:(X)=>j0(x1(X),Zm),formatIssueSync:(X)=>rV(tY.formatIssue(X)),formatError:(X)=>tY.formatIssue(X.issue),formatErrorSync:(X)=>tY.formatIssueSync(X.issue)},Zm=(X)=>X.value+mP(`
`,X.forest),mP=(X,J)=>{let Y="",G=J.length,Z;for(let $=0;$<G;$++){Z=J[$];let Q=$===G-1;Y+=X+(Q?"":"")+" "+Z.value,Y+=mP(X+(G>1&&!Q?"  ":"   "),Z.forest)}return Y},$m=(X)=>{switch(X){case"Encoded":return"Encoded side transformation failure";case"Transformation":return"Transformation process failure";case"Type":return"Type side transformation failure"}},Qm=(X)=>{switch(X){case"From":return"From side refinement failure";case"Predicate":return"Predicate refinement failure"}},dP=(X)=>("ast"in X)?F(X.ast):q(),Hm=(X)=>dP(X).pipe(i6(YD),P0((J)=>{let Y=J(X);return X8(Y)?$8({message:Y,override:!1}):d9(Y)?j0(Y,(G)=>({message:G,override:!1})):X8(Y.message)?$8({message:Y.message,override:Y.override}):j0(Y.message,(G)=>({message:G,override:Y.override}))})),RW=(X)=>(J)=>J._tag===X,cP=RW("Composite"),TP=RW("Refinement"),EP=RW("Transformation"),CW=(X)=>Hm(X).pipe(P0((J)=>{return!J.override&&(cP(X)||TP(X)&&X.kind==="From"||EP(X)&&X.kind!=="Transformation")?EP(X)||TP(X)?CW(X.issue):q():$8(J.message)})),pP=(X)=>dP(X).pipe(i6(QD),IU((J)=>H8(J(X))));function Km(X){return uG(X).pipe(Y6(()=>fG(X)),Y6(()=>D3(X)),Y6(()=>Z7(X)),K0(()=>`{ ${X.from} | filter }`))}function Bm(X){if(X.message!==void 0)return X.message;return`Expected ${MX(X.ast)?Km(X.ast):String(X.ast)}, actual ${T6(X.actual)}`}var Vm=(X)=>CW(X).pipe(lV(()=>pP(X)),qY(()=>$8(Bm(X)))),$2=(X)=>K0(pP(X),()=>String(X.ast)),Nm=(X)=>X.message??"is forbidden",Wm=(X)=>X.message??"is unexpected",Um=(X)=>GD(X.ast).pipe(P0((J)=>{let Y=J();return X8(Y)?$8(Y):Y}),qY(()=>$8(X.message??"is missing"))),_W=(X,J)=>nV(CW(X),{onFailure:J,onSuccess:(Y)=>$8(M6(Y))}),x1=(X)=>{switch(X._tag){case"Type":return j0(Vm(X),M6);case"Forbidden":return $8(M6($2(X),[M6(Nm(X))]));case"Unexpected":return $8(M6(Wm(X)));case"Missing":return j0(Um(X),M6);case"Transformation":return _W(X,()=>j0(x1(X.issue),(J)=>M6($2(X),[M6($m(X.kind),[J])])));case"Refinement":return _W(X,()=>j0(x1(X.issue),(J)=>M6($2(X),[M6(Qm(X.kind),[J])])));case"Pointer":return j0(x1(X.issue),(J)=>M6(yG(X.path),[J]));case"Composite":{let J=$2(X);return _W(X,()=>t2(X.issues)?j0(w6(X.issues,x1),(Y)=>M6(J,Y)):j0(x1(X.issues),(Y)=>M6(J,[Y])))}}};var Fm="effect/ScopedRef",oP=Symbol.for(Fm),_m={_A:(X)=>X},GW0={...o8,commit(){return eY(this)},[oP]:_m};var eY=(X)=>o(E4(X.ref),(J)=>J[1]);var Em="effect/Resource",rP=Symbol.for(Em),Im={_E:(X)=>X,_A:(X)=>X},mW0={...o8,commit(){return iP(this)},[rP]:Im};var iP=(X)=>T(eY(X.scopedRef),x);var JM=Symbol.for("effect/Schema"),t7=(X)=>class J{[JM]=YM;static ast=X;static annotations(Y){return t7(KM(this.ast,Y))}static pipe(){return D(this,arguments)}static toString(){return String(X)}static Type;static Encoded;static Context;static[JM]=YM},YM={_A:(X)=>X,_I:(X)=>X,_R:(X)=>X},GM={schemaId:pG,message:Z3,missingMessage:$3,identifier:$J,title:b8,description:e6,examples:iU,default:aU,documentation:eU,jsonSchema:sU,arbitrary:Q3,pretty:H3,equivalence:tU,concurrency:K3,batching:B3,parseIssueTitle:V3,parseOptions:N3,decodingFallback:W3},B2=(X)=>{if(!X)return{};let J={...X};for(let Y in GM)if(Y in X){let G=GM[Y];J[G]=X[Y],delete J[Y]}return J},KM=(X,J)=>G4(X,B2(J));var mm=(X,J,Y)=>t7(new PX(X.map((G)=>G.ast),(...G)=>J.decode(...G.map(t7)),(...G)=>J.encode(...G.map(t7)),B2(Y))),dm=(X,J)=>{let Y=()=>(Z,$,Q)=>X(Z)?vP(Z):xP(new p6(Q,Z));return t7(new PX([],Y,Y,B2(J)))},cm=function(){if(Array.isArray(arguments[0])){let Y=arguments[0],G=arguments[1],Z=arguments[2];return mm(Y,G,Z)}let X=arguments[0],J=arguments[1];return dm(X,J)};class IW extends t7(O3){}var pm=Symbol.for("effect/SchemaId/Refine"),BM=(X,J,Y)=>class G extends t7(Y){static annotations(Z){return BM(this.from,this.filter,KM(this.ast,Z))}static[pm]=X;static from=X;static filter=J;static make=(Z,$)=>{return im($)?Z:MW(this)(Z)}},ZM=(X,J,Y)=>{if(V6(X))return X?q():F(new p6(J,Y));if(X8(X))return F(new p6(J,Y,X));if(X!==void 0){if("_tag"in X)return F(X);let G=new p6(J,Y,X.message);return F(T0(X.path)?new O8(X.path,Y,G):G)}return q()},fm=(X,J,Y)=>{if(pU(X))return ZM(X,J,Y);if(T0(X)){let G=YJ(X,(Z)=>ZM(Z,J,Y));if(T0(G))return F(G.length===1?G[0]:new p0(J,Y,G))}return q()};function um(X,J){return(Y)=>{function G($,Q,K){return fm(X($,Q,K),K,$)}let Z=new BJ(Y.ast,G,B2(J));return BM(Y,G,Z)}}var $M=Symbol.for("effect/SchemaId/Pattern"),om=(X,J)=>(Y)=>{let G=X.source;return Y.pipe(um((Z)=>{return X.lastIndex=0,X.test(Z)},{schemaId:$M,[$M]:{regex:X},description:`a string matching the pattern ${G}`,jsonSchema:{pattern:G},...J}))};var mO0=IW.annotations({[$J]:"JsonString",[b8]:"JsonString",[e6]:"a string that will be parsed as JSON"});var nm=Symbol.for("effect/SchemaId/UUID"),QM=/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/i;class lm extends IW.pipe(om(QM,{schemaId:nm,identifier:"UUID",jsonSchema:{format:"uuid",pattern:QM.source},description:"a Universally Unique Identifier",arbitrary:()=>(X)=>X.uuid()})){}var HM=J3;class rm extends cm(ZX,{identifier:"DateFromSelf",schemaId:HM,[HM]:{noInvalidDate:!1},description:"a potentially invalid Date instance",pretty:()=>(X)=>`new Date(${JSON.stringify(X)})`,arbitrary:()=>(X)=>X.date({noInvalidDate:!1}),equivalence:()=>BU}){}var im=(X)=>V6(X)?X:X?.disableValidation??!1;var VM=Symbol.for("effect/SortedMap"),uL0={[VM]:{_K:(X)=>X,_V:(X)=>X},[M](){return N(O(this.tree),C(O("effect/SortedMap")),S(this))},[P](X){return Gd(X)&&w(this.tree,X.tree)},[Symbol.iterator](){return this.tree[Symbol.iterator]()},toString(){return d(this.toJSON())},toJSON(){return{_id:"SortedMap",values:Array.from(this).map(r)}},[v](){return this.toJSON()},pipe(){return D(this,arguments)}};var Gd=(X)=>A(X,VM);var SW=Symbol.for("effect/Subscribable");var wR0={[S9]:S9,[SW]:SW,pipe(){return D(this,arguments)}};var MM="effect/Trie",bW=Symbol.for(MM),Qc={_Value:(X)=>X},VS0={[bW]:Qc,[Symbol.iterator](){return new hW(this,(X,J)=>[X,J],()=>!0)},[M](){let X=O(MM);for(let J of this)X^=N(O(J[0]),C(O(J[1])));return S(this,X)},[P](X){if(Hc(X)){let J=Array.from(X);return Array.from(this).every((Y,G)=>{let Z=J[G];return w(Y[0],Z[0])&&w(Y[1],Z[1])})}return!1},toString(){return d(this.toJSON())},toJSON(){return{_id:"Trie",values:Array.from(this).map(r)}},[v](){return this.toJSON()},pipe(){return D(this,arguments)}};class hW{trie;f;filter;stack=[];constructor(X,J,Y){this.trie=X,this.f=J,this.filter=Y;let G=X._root!==void 0?X._root:void 0;if(G!==void 0)this.stack.push([G,"",!1])}next(){while(this.stack.length>0){let[X,J,Y]=this.stack.pop();if(Y){let G=X.value;if(G!==void 0){let Z=J+X.key;if(this.filter(Z,G))return{done:!1,value:this.f(Z,G)}}}else this.addToStack(X,J)}return{done:!0,value:void 0}}addToStack(X,J){if(X.right!==void 0)this.stack.push([X.right,J,!1]);if(X.mid!==void 0)this.stack.push([X.mid,J+X.key,!1]);if(this.stack.push([X,J,!0]),X.left!==void 0)this.stack.push([X.left,J,!1])}[Symbol.iterator](){return new hW(this.trie,this.f,this.filter)}}var Hc=(X)=>A(X,bW);var jp=m1(EM(),1),Sp=m1(uW(),1),vp=m1(nW(),1),xp=m1(eW(),1),XU=m1(CR(),1);function yp(){let X=Math.random().toString(36).substring(2,15),J=(Y)=>{return"$-_.+!*'(),/&?=:%"[Y%17]};return(Y)=>{return N(Y,(G)=>`${X}${G.toString(16)}`,(G)=>Buffer.from(G).toString("base64"),(G)=>{let Z=J(Y),$=J(Y+1);return G.replaceAll("==",`${Z}${$}`).replaceAll("=",Z)},(G)=>{let Z=J(Y+G.length),$=Math.floor(Math.random()*G.length),Q=G.substring(0,$),K=G.substring($);return`${Q}${Z}${K}`})}}var gp=(X)=>`item-${X}`,bp=yp();function*TR(X){let J=0;while(!0)if(X)yield N(J++,gp);else yield N(J++,bp)}function ER(){function X(){let Y=process.argv.find(($)=>$.startsWith("--port="));if(Y==null)return null;let G=Y.split("=")[1],Z=Number.parseInt(G);if(Number.isNaN(Z))return null;return Z}function J(){let Y=process.argv.findIndex(($)=>$.startsWith("--port"));if(Y===-1)return null;let G=process.argv[Y+1],Z=Number.parseInt(G);if(Number.isNaN(Z))return null;return Z}return X()??J()??null}function IR(){return process.argv.includes("--production")||process.argv.includes("--prod")}function JU(X,J){return`
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <style>
    :root {
      color-scheme: light dark;
    }

    @media (prefers-color-scheme: dark) {
      body {
        color-scheme: dark;
      }
    }

    body {
      margin: 0;
      padding: 16px;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
      font-size: 18px;
      line-height: 1.8;
    }

    body[data-color="red"] {
      background-color: #720000;
      color: #fff;
    }

    body[data-color="blue"] {
      background-color: #1a237e;
      color: #fff;
    }
  </style>
</head>

<body data-color="${J?.color??"default"}">
${X}
</body>

</html>
\t`}function YU(X,J){return Math.floor(Math.random()*(J-X+1))+X}var jR=[["Svkov na smetan","Traditional Czech dish of beef in creamy vegetable sauce with dumplings.","food","CZE",200,8.5,0,0,0],["Pilsner Urquell","Famous Czech lager with a crisp and refreshing taste.","drink","CZE",50,2.1,1,1,1],["Pad Thai","Stir-fried rice noodle dish with eggs, tofu, peanuts, and tamarind sauce.","food","THA",180,7.7,1,1,0],["Espresso","Strong and concentrated Italian coffee served in small portions.","drink","ITA",60,2.5,1,1,0],["Ratatouille","French vegetable stew made with zucchini, eggplant, and tomatoes.","food","FRA",150,6.4,1,1,0],["Miso Soup","Traditional Japanese soup made with miso paste, tofu, and seaweed.","food","JPN",120,5.1,1,1,0],["Gin Tonic","Refreshing cocktail made with gin and tonic water.","drink","GBR",150,6.4,1,1,1],["Tom Yum Soup","Spicy and sour Thai soup with shrimp and lemongrass.","food","THA",160,6.8,0,0,0],["Churros","Deep-fried dough sticks sprinkled with sugar, often served with chocolate.","food","ESP",100,4.3,1,1,0],["Margarita","Classic Mexican cocktail made with tequila, lime juice, and Cointreau.","drink","MEX",180,7.7,1,1,1],["Pavlova","Meringue-based dessert topped with whipped cream and fresh fruits.","food","AUS",140,6,1,1,0],["Irish Coffee","Coffee with Irish whiskey, sugar, and topped with cream.","drink","IRL",120,5.1,1,1,1],["Caesar Salad","Salad with romaine lettuce, croutons, Parmesan cheese, and Caesar dressing.","food","USA",170,7.3,0,0,0],["Falafel","Deep-fried chickpea balls served with pita bread and tahini sauce.","food","ISR",130,5.6,1,1,0],["Pia Colada","Sweet cocktail made with rum, coconut cream, and pineapple juice.","drink","PRI",160,6.8,1,1,1],["Pho","Vietnamese noodle soup with beef, herbs, and spices.","food","VNM",150,6.4,0,0,0],["Bruschetta","Grilled bread topped with garlic, olive oil, and fresh tomatoes.","food","ITA",90,3.8,1,1,0],["Sangria","Spanish drink made with red wine, fruit, and a touch of brandy.","drink","ESP",130,5.6,1,1,1],["Kimchi","Traditional Korean fermented cabbage with a spicy kick.","food","KOR",110,4.7,1,1,0],["Chai Latte","Spiced tea with milk and a creamy texture.","drink","IND",70,3,1,1,0],["Beef Stroganoff","Russian dish of sauted beef in a creamy mushroom sauce.","food","RUS",220,9.4,0,0,0],["Matcha Latte","Creamy green tea latte made with powdered matcha.","drink","JPN",90,3.8,1,1,0],["Baklava","Sweet pastry made of layers of filo dough filled with nuts and honey.","food","TUR",80,3.4,1,1,0],["Bloody Mary","Tomato juice cocktail with vodka and spices.","drink","USA",150,6.4,1,1,1],["Hummus","Middle Eastern dip made from blended chickpeas, tahini, and lemon juice.","food","ISR",110,4.7,1,1,0],["Mojito","Cuban cocktail with rum, mint, lime, sugar, and soda water.","drink","CUB",140,6,1,1,1],["Carbonara","Pasta dish with eggs, Parmesan cheese, and pancetta.","food","ITA",190,8.1,0,0,0],["Pumpkin Spice Latte","Sweet coffee drink flavored with pumpkin and warm spices.","drink","USA",100,4.3,1,1,0],["Tacos","Mexican dish with a folded tortilla filled with meat, cheese, and vegetables.","food","MEX",140,6,0,0,0],["Prosecco","Italian sparkling wine with a light and fruity taste.","drink","ITA",200,8.5,1,1,1],["Rogan Josh","Indian curry made with tender lamb cooked in aromatic spices.","food","IND",210,8.9,0,0,0],["Guacamole","Mexican avocado dip with lime, onions, and cilantro.","food","MEX",120,5.1,1,1,0],["Sake","Japanese rice wine served warm or cold.","drink","JPN",170,7.3,1,1,1],["Peking Duck","Crispy-skinned duck served with pancakes, scallions, and hoisin sauce.","food","CHN",250,10.6,0,0,0],["Turkish Tea","Strong and flavorful tea served in a small tulip-shaped glass.","drink","TUR",50,2.1,1,1,0],["Cheesecake","Creamy dessert made with a cheese-based filling on a cookie crust.","food","USA",120,5.1,1,1,0],["Caipirinha","Brazilian cocktail made with cachaa, lime, and sugar.","drink","BRA",150,6.4,1,1,1],["Shakshuka","Poached eggs in a spiced tomato and pepper sauce.","food","ISR",160,6.8,1,1,0],["Crme Brle","French dessert with a creamy custard base and caramelized sugar crust.","food","FRA",140,6,1,1,0],["Tequila Sunrise","Vibrant cocktail made with tequila, orange juice, and grenadine.","drink","MEX",150,6.4,1,1,1],["Bouillabaisse","Traditional French fish stew with a rich saffron broth.","food","FRA",250,10.6,0,0,0],["Amaretto Sour","Sweet and sour cocktail made with amaretto liqueur and lemon juice.","drink","ITA",140,6,1,1,1],["Pierogi","Polish dumplings filled with potatoes, cheese, or meat.","food","POL",120,5.1,1,1,0],["Ouzo","Greek anise-flavored aperitif often served with water.","drink","GRC",90,3.8,1,1,1],["Tom Kha Gai","Thai coconut soup with chicken, galangal, and lemongrass.","food","THA",160,6.8,0,0,0],["Negroni","Classic cocktail made with gin, vermouth, and Campari.","drink","ITA",150,6.4,1,1,1],["Khachapuri","Georgian cheese-filled bread with a runny egg on top.","food","GEO",170,7.3,1,1,0],["Sazerac","Classic New Orleans cocktail made with rye whiskey and absinthe.","drink","USA",160,6.8,1,1,1],["Tiramisu","Italian coffee-flavored dessert with mascarpone and cocoa.","food","ITA",150,6.4,1,1,0],["Baijiu","Traditional Chinese distilled spirit made from grains.","drink","CHN",220,9.4,1,1,1],["Borscht","Ukrainian beet soup often served with sour cream.","food","UKR",130,5.6,1,1,0],["Mai Tai","Rum-based cocktail with lime, orange liqueur, and almond syrup.","drink","USA",180,7.7,1,1,1],["Chow Mein","Stir-fried Chinese noodles with vegetables and meat or tofu.","food","CHN",150,6.4,0,0,0],["Pisco Sour","Peruvian cocktail made with pisco, lime, and egg whites.","drink","PER",160,6.8,1,1,1],["Arancini","Italian rice balls stuffed with cheese and meat, then deep-fried.","food","ITA",130,5.6,1,1,0],["Absinthe","Strong herbal spirit with a distinct anise flavor.","drink","CHE",200,8.5,1,1,1],["Croque Monsieur","French grilled ham and cheese sandwich topped with bchamel sauce.","food","FRA",140,6,0,0,0],["Kombucha","Fermented tea with a tangy, fizzy flavor.","drink","CHN",70,3,1,1,0],["Empanadas","Savory pastry pockets filled with meat, cheese, or vegetables.","food","ARG",120,5.1,0,0,0],["Limoncello","Italian lemon liqueur often served as a digestif.","drink","ITA",90,3.8,1,1,1],["Ceviche","Fresh fish marinated in citrus juices with onions and cilantro.","food","PER",200,8.5,0,0,0],["Espresso Martini","Cocktail combining vodka, coffee liqueur, and espresso.","drink","GBR",160,6.8,1,1,1],["Raki","Turkish anise-flavored alcoholic drink, often diluted with water.","drink","TUR",180,7.7,1,1,1],["Goulash","Hearty Hungarian stew made with beef and paprika.","food","HUN",140,6,0,0,0],["Bellini","Italian cocktail made with Prosecco and peach puree.","drink","ITA",140,6,1,1,1],["Biryani","Spiced rice dish with meat, vegetables, and fragrant spices.","food","IND",190,8.1,0,0,0],["Old Fashioned","Classic cocktail made with bourbon, sugar, and bitters.","drink","USA",170,7.3,1,1,1],["Piernik","Polish gingerbread cake flavored with honey and spices.","food","POL",100,4.3,1,1,0],["Calvados","Apple brandy from the Normandy region of France.","drink","FRA",190,8.1,1,1,1],["Bnh M","Vietnamese sandwich with pickled vegetables and various fillings.","food","VNM",110,4.7,0,0,0],["Sushi","Vinegared rice paired with raw fish, vegetables, or eggs, served in bite-sized pieces.","food","JPN",200,8.5,0,0,0],["Ramen","Japanese noodle soup with broth, meat, and various toppings like eggs and seaweed.","food","JPN",180,7.7,0,0,0],["Tempura","Deep-fried seafood or vegetables coated in a light batter.","food","JPN",150,6.4,0,0,0],["Okonomiyaki","Savory Japanese pancake filled with vegetables, meat, or seafood and topped with sauces.","food","JPN",160,6.8,1,1,0],["Takoyaki","Ball-shaped snack made of batter filled with octopus and cooked in special molds.","food","JPN",130,5.6,0,0,0],["Yakitori","Grilled skewers of chicken seasoned with salt or a sweet soy-based sauce.","food","JPN",120,5.1,0,0,0],["Udon Noodles","Thick wheat noodles served in a hot broth or stir-fried with vegetables.","food","JPN",140,6,1,1,0],["Onigiri","Rice balls often filled with pickled plum, fish, or seaweed.","food","JPN",100,4.3,1,1,0],["Matcha Ice Cream","Creamy dessert flavored with Japanese green tea powder.","food","JPN",90,3.8,1,1,0],["Gi Cun","Fresh spring rolls with shrimp, pork, herbs, and vermicelli, served with dipping sauce.","food","VNM",100,4.3,1,1,0],["Bn Ch","Grilled pork served with vermicelli noodles, fresh herbs, and dipping sauce.","food","VNM",150,6.4,0,0,0],["Cao Lu","Hoi An specialty with thick noodles, pork, and crispy toppings.","food","VNM",140,6,0,0,0],["Ch Gi","Deep-fried spring rolls filled with minced pork, mushrooms, and glass noodles.","food","VNM",120,5.1,0,0,0],["Bnh Xo","Crispy rice flour pancake stuffed with shrimp, pork, and bean sprouts.","food","VNM",130,5.6,0,0,0],["Bnh Cun","Steamed rice rolls filled with minced pork and mushrooms, served with dipping sauce.","food","VNM",110,4.7,0,0,0],["Cm Tm","Broken rice dish with grilled pork, fried egg, and pickled vegetables.","food","VNM",140,6,0,0,0],["Bnh Pa","Vietnamese pastry filled with mung bean paste, salted egg yolk, and durian.","food","VNM",90,3.8,1,1,0],["Tom Yum Goong","Spicy and sour shrimp soup with lemongrass, kaffir lime leaves, and chili.","food","THA",190,8.1,0,0,0],["Green Curry","Rich coconut milk curry with green curry paste, chicken, and eggplants.","food","THA",200,8.5,0,0,0],["Som Tum","Spicy green papaya salad with peanuts, lime, and chili.","food","THA",130,5.6,1,1,0],["Massaman Curry","A mild curry with tender beef, potatoes, peanuts, and spices.","food","THA",210,8.9,0,0,0],["Khao Pad","Thai fried rice with egg, vegetables, and a choice of meat or seafood.","food","THA",140,6,0,0,0],["Pad Kra Pao","Stir-fried minced meat with holy basil, chili, and a fried egg on top.","food","THA",160,6.8,0,0,0],["Panang Curry","Creamy and slightly sweet curry with beef or chicken, peanuts, and coconut milk.","food","THA",200,8.5,0,0,0],["Mango Sticky Rice","A dessert of sweet sticky rice served with fresh mango and coconut sauce.","food","THA",120,5.1,1,1,0],["Spaghetti Carbonara","Classic pasta with eggs, Pecorino Romano, guanciale, and black pepper.","food","ITA",180,7.7,0,0,0],["Penne Arrabbiata","Spicy tomato-based pasta with garlic, chili, and olive oil.","food","ITA",150,6.4,1,1,0],["Lasagna Bolognese","Layered pasta with meat rag, bchamel sauce, and Parmigiano-Reggiano.","food","ITA",220,9.4,0,0,0],["Fettuccine Alfredo","Rich and creamy pasta with butter and Parmesan cheese.","food","ITA",170,7.3,1,1,0],["Tagliatelle al Rag","Wide pasta ribbons served with traditional Bolognese sauce.","food","ITA",200,8.5,0,0,0],["Spaghetti Aglio e Olio","Simple pasta with garlic, olive oil, chili flakes, and parsley.","food","ITA",140,6,1,1,0],["Pasta Primavera","Pasta with a mix of fresh, sauted vegetables and light sauce.","food","ITA",160,6.8,1,1,0],["Orecchiette with Broccoli Rabe","Small ear-shaped pasta tossed with garlic, broccoli rabe, and olive oil.","food","ITA",170,7.3,1,1,0],["Rigatoni alla Norma","Pasta with eggplant, tomato sauce, ricotta salata, and basil.","food","ITA",160,6.8,1,1,0],["Linguine alle Vongole","Linguine with fresh clams, white wine, garlic, and parsley.","food","ITA",200,8.5,0,0,0],["Margherita","Classic pizza with tomato sauce, fresh mozzarella, and basil.","food","ITA",180,7.7,1,1,0],["Pepperoni","Pizza topped with tomato sauce, mozzarella, and spicy pepperoni slices.","food","ITA",200,8.5,0,0,0],["Quattro Formaggi","Pizza with a blend of four cheeses: mozzarella, gorgonzola, parmesan, and fontina.","food","ITA",220,9.4,1,1,0],["Prosciutto e Funghi","Pizza with tomato sauce, mozzarella, ham, and mushrooms.","food","ITA",210,8.9,0,0,0],["Diavola","Spicy pizza with tomato sauce, mozzarella, spicy salami, and chili.","food","ITA",200,8.5,0,0,0],["Capricciosa","Pizza with tomato sauce, mozzarella, ham, mushrooms, artichokes, and olives.","food","ITA",210,8.9,0,0,0],["Napoli","Pizza with tomato sauce, mozzarella, anchovies, capers, and oregano.","food","ITA",190,8.1,0,0,0],["Vegetariana","Pizza with tomato sauce, mozzarella, and a variety of fresh vegetables.","food","ITA",200,8.5,1,1,0],["Marinara","Simple pizza with tomato sauce, garlic, oregano, and olive oil.","food","ITA",170,7.3,1,1,0],["Quattro Stagioni","Pizza divided into four sections, each representing a season with different toppings.","food","ITA",220,9.4,0,0,0],["Cosmopolitan","A stylish cocktail with vodka, triple sec, cranberry juice, and lime.","drink","USA",200,8.5,1,1,1],["Martini","A classic drink made with gin and dry vermouth, garnished with an olive or lemon twist.","drink","USA",250,10.6,1,1,1],["Whiskey Sour","A balanced cocktail made with whiskey, lemon juice, sugar, and egg white.","drink","USA",180,7.7,1,1,1],["Kung Pao Chicken","Spicy stir-fried chicken with peanuts, chili peppers, and vegetables in a savory sauce.","food","CHN",180,7.7,0,0,0],["Sweet and Sour Pork","Tender pork pieces in a tangy and sweet sauce with bell peppers and pineapple.","food","CHN",190,8.1,0,0,0],["Mapo Tofu","Soft tofu in a spicy, flavorful sauce made with chili bean paste, ground pork, and Sichuan peppercorns.","food","CHN",150,6.4,1,1,0],["Dim Sum","A variety of bite-sized dumplings, buns, and rolls, typically served with tea.","food","CHN",180,7.7,0,0,0],["Spring Rolls","Crispy fried rolls filled with a mixture of vegetables, sometimes with shrimp or pork.","food","CHN",120,5.1,1,1,0],["Wonton Soup","Clear broth soup with stuffed dumplings, often filled with pork, shrimp, or vegetables.","food","CHN",150,6.4,0,0,0],["Hot Pot","A communal dish where raw ingredients such as meats, seafood, and vegetables are cooked in a simmering pot of broth.","food","CHN",250,10.6,0,0,0],["Fried Rice","Stir-fried rice with vegetables, eggs, and your choice of meat or tofu.","food","CHN",130,5.6,1,1,0],["Asado","A traditional Argentine barbecue featuring various cuts of beef, sausages, and sometimes chicken, grilled on a wood or charcoal fire.","food","ARG",350,14.9,0,0,0],["Milanesa","Breaded and fried meat cutlets, typically made from beef or chicken, served with mashed potatoes or a salad.","food","ARG",180,7.7,0,0,0],["Provoleta","Grilled provolone cheese, often served with a sprinkle of oregano and a drizzle of olive oil.","food","ARG",140,6,1,1,0],["Choripn","A sandwich made with grilled chorizo sausage, often served with chimichurri sauce.","food","ARG",130,5.6,0,0,0],["Humita","Steamed corn dough filled with cheese and onions, wrapped in corn husks.","food","ARG",110,4.7,1,1,0],["Locro","A hearty stew made with corn, potatoes, beans, meat (usually pork or beef), and vegetables.","food","ARG",220,9.4,0,0,0],["Matambre a la Pizza","Grilled flank steak topped with tomato sauce, mozzarella, and herbs, similar to a pizza.","food","ARG",250,10.6,0,0,0],["Dulce de Leche","A sweet caramel-like spread made from condensed milk, often used in desserts like alfajores and cakes.","food","ARG",100,4.3,1,1,0],["Tarta de Ricotta","A savory pie filled with ricotta cheese, eggs, and herbs, often served as a snack or light meal.","food","ARG",160,6.8,1,1,0],["Green Tea","A popular tea made from unoxidized leaves, known for its light and refreshing flavor with a slightly grassy taste.","drink","CHN",60,2.5,1,1,0],["Black Tea","A fully oxidized tea with a stronger flavor and higher caffeine content, often enjoyed with milk and sugar.","drink","IND",50,2.1,1,1,0],["Chai","A spiced tea made from black tea, milk, sugar, and a variety of aromatic spices like cinnamon, cardamom, and ginger.","drink","IND",80,3.4,1,1,0],["Chamomile Tea","A herbal tea made from dried chamomile flowers, known for its calming and soothing properties.","drink","EGY",70,3,1,1,0],["Earl Grey","A black tea flavored with oil of bergamot, giving it a distinctive citrus aroma and slightly floral taste.","drink","ENG",90,3.8,1,1,0],["Cappuccino","A coffee drink made with espresso and steamed milk, topped with a layer of foamed milk.","drink","ITA",80,3.4,1,1,0],["Latte","A creamy coffee drink made with espresso and a larger amount of steamed milk, with a thin layer of foam.","drink","ITA",90,3.8,1,1,0],["Americano","A diluted espresso made by adding hot water to espresso, resulting in a lighter flavor and larger volume.","drink","USA",70,3,1,1,0],["Mocha","A sweet coffee drink made with espresso, steamed milk, and chocolate syrup, often topped with whipped cream.","drink","USA",100,4.3,1,1,0]];function SR(X){let J=[...X];for(let Y=J.length-1;Y>0;Y--){let G=Math.floor(Math.random()*(Y+1));[J[Y],J[G]]=[J[G],J[Y]]}return J}function hp(X,J){let[Y,G,Z,$,Q,K,H,V,W]=J,U=Math.random()>0.5,L=Math.random()*0.2+1,_=31536000000;return{id:X,name:Y,description:G,type:Z,cuisineCountry:$,priceBaseAmount:(U?K:Q)*L,priceCurrency:U?"EUR":"CZK",createdAt:new Date(Date.now()-Math.random()*31536000000*2),isVegetarian:H===1?!0:void 0,isVegan:V===1?!0:void 0,isAlcoholic:W===1?!0:void 0}}function mp(X,J){let[Y,G,Z,$,Q,K,H,V,W]=J;return{id:X,name:Y,description:G,type:Z,cuisineCountry:$,priceBaseAmount:Q,priceCurrency:"CZK",createdAt:new Date,isVegetarian:H===1,isVegan:V===1,isAlcoholic:W===1}}function vR(X,J,Y){return X?mp(J,Y):hp(J,Y)}function GU(X,J){if(X)return JSON.stringify(J,null,2);let Y=JSON.stringify(J);if(!(Math.random()>0.5))return Y;let Z="\uD83E\uDEB2\uD83D\uDC1B\uD83D\uDC1C\uD83D\uDC1D"[Math.floor(Math.random()*8)];return`${Y.slice(0,Math.floor(Y.length/2+Y.length/2*Math.random()))}${Z}`}function xR(X){return Array.from(new Set(X))}var ZU=ER()??3000,f4=!IR(),kR={Index:"/",GetItems:"/items"},dp=TR(f4),{menuItems:$U,menuItemIds:yR}=N(jR.map((X)=>vR(f4,dp.next().value,X)),(X)=>{let J=X.map((Y)=>[Y.id,Y]);return{menuItems:new Map(J),menuItemIds:SR(X.map((Y)=>Y.id))}}),QU=new Set,HU=gR.createServer((X,J)=>{J.setHeader("Access-Control-Allow-Origin","*"),J.setHeader("Access-Control-Allow-Methods","GET, POST, PUT, DELETE, OPTIONS"),J.setHeader("Access-Control-Allow-Headers","Content-Type");let Y=(W)=>{J.writeHead(W.status,{"Content-Type":"text/html; charset=utf-8"}),J.end(JU(W.htmlContent,{color:W.status>=500?"blue":"red"}))},G=(W)=>{J.writeHead(200,{"Content-Type":"text/html; charset=utf-8"}),J.end(JU(W.htmlContent))},Z=(W)=>{J.writeHead(200,{"Content-Type":"application/json"}),J.end(GU(f4,W))},[$,Q]=X.url?.split("?",2)??[null,""],K=new URLSearchParams(Q);if(!f4&&Math.random()>0.8)return Y({status:502,htmlContent:"\uD83D\uDCA5 Simulated Server Error"});if(X.method!=="GET")return Y({status:405,htmlContent:"\uD83D\uDEAB Method Not Allowed"});if($===kR.GetItems){let W=xR(K.getAll("id"));if(!(W.length>0))return Y({status:404,htmlContent:"\uD83E\uDEB9 The URL does not contain the query parameter id."});if(!W.every((z)=>$U.has(z)))return Y({status:400,htmlContent:"\uD83E\uDEE5 The URL contains an invalid id."});let _=W.map((z)=>$U.get(z)??null).filter((z)=>z!=null).map((z)=>({id:z.id,name:z.name,description:z.description,type:z.type,cuisineCountry:z.cuisineCountry,createdAt:z.createdAt,isVegetarian:z.isVegetarian,isVegan:z.isVegan,isAlcoholic:z.isAlcoholic})).sort((z,R)=>z.id.localeCompare(R.id));return Z(_)}if($===kR.Index)return G({htmlContent:"\uD83D\uDC4B Hello Developer!"});return Y({status:404,htmlContent:"\uD83D\uDE31 Page Not Found"})});HU.listen(ZU);var bR=new XU.default({server:HU});bR.on("connection",(X)=>{QU.add(X),console.log(" Client connected"),X.on("close",()=>{QU.delete(X),console.log(" Client disconnected")})});if(!f4)console.log(`

 Production Mode 
`);console.log(`
\uD83D\uDCE1 Data server started
  - http://localhost:${ZU}
  - ws://localhost:${ZU}
`);var cp=f4?600:200,pp=setInterval(()=>{let X=f4?0.5:0.7;if(Math.random()>X)return;let Y=Math.floor(Math.random()*yR.length),G=yR.slice(Y,Y+YU(0,5));if(G.length===0)return;let Z=G.map(($)=>{let Q=$U.get($)??null;if(Q==null)return null;let K=YU(-100,100)/100,H=Q.priceBaseAmount+K;return[$,H,Q.priceCurrency]});for(let $ of QU)$.send(GU(f4,Z)),console.log(` Sent ${Z.length} updates ${new Date().toLocaleTimeString("cs-CZ",{hour:"2-digit",minute:"2-digit",second:"2-digit"})}`)},cp);process.on("SIGINT",()=>{clearInterval(pp),HU.close(),bR.close(),console.log(`
Server stopped
`),process.exit(0)});
